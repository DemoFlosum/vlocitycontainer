const a27_0x331679=a27_0x165b;(function(_0xd3163,_0x5414e2){const _0x4c00d4=a27_0x165b,_0x5ee909=_0xd3163();while(!![]){try{const _0x559410=-parseInt(_0x4c00d4(0xf0))/0x1*(parseInt(_0x4c00d4(0xe8))/0x2)+parseInt(_0x4c00d4(0x104))/0x3+-parseInt(_0x4c00d4(0x109))/0x4*(-parseInt(_0x4c00d4(0x10c))/0x5)+-parseInt(_0x4c00d4(0xf8))/0x6+-parseInt(_0x4c00d4(0xee))/0x7+parseInt(_0x4c00d4(0x101))/0x8*(-parseInt(_0x4c00d4(0xef))/0x9)+-parseInt(_0x4c00d4(0xdd))/0xa*(-parseInt(_0x4c00d4(0xf4))/0xb);if(_0x559410===_0x5414e2)break;else _0x5ee909['push'](_0x5ee909['shift']());}catch(_0x46c18a){_0x5ee909['push'](_0x5ee909['shift']());}}}(a27_0x1b57,0xae349));const fs=require('fs'),AdmZip=require(a27_0x331679(0xd8)),path=require(a27_0x331679(0xec)),childProcess=require(a27_0x331679(0xff)),constants=require(a27_0x331679(0x107));function a27_0x165b(_0xda67ca,_0x3f2f82){const _0x1b5748=a27_0x1b57();return a27_0x165b=function(_0x165bfa,_0x505b80){_0x165bfa=_0x165bfa-0xd7;let _0x330b89=_0x1b5748[_0x165bfa];return _0x330b89;},a27_0x165b(_0xda67ca,_0x3f2f82);}function retrieveSourceComponents(_0x1e92c1,_0x24d3be,_0x7fe14d,_0x597762){return new Promise((_0x2d9d09,_0x5e7159)=>{const _0xed6fa9=a27_0x165b;try{_0x597762[_0xed6fa9(0x10b)]('Start\x20Retrieve\x20Components\x20Ids');const _0x5ef086=[];_0x1e92c1[_0xed6fa9(0x10d)](_0xed6fa9(0xe7)+_0x24d3be+_0xed6fa9(0x108)+_0x24d3be+_0xed6fa9(0xfb)+_0x7fe14d+'\x27',(_0x1b08a7,_0x284ae7)=>{const _0x13871c=_0xed6fa9;_0x1b08a7&&_0x5e7159(_0x1b08a7),_0x284ae7[_0x13871c(0x105)][_0x13871c(0xe9)](_0x4a9aa9=>_0x5ef086[_0x13871c(0xf6)](_0x4a9aa9['Id'])),!_0x284ae7[_0x13871c(0xed)]?retrieveSourceComponentsMore(_0x1e92c1,_0x284ae7[_0x13871c(0xea)],_0x5ef086)[_0x13871c(0xfe)](_0xbac604=>{const _0x37081b=_0x13871c;_0x597762[_0x37081b(0x10b)]('Component\x20Id\x20List\x20Length,\x20'+_0xbac604[_0x37081b(0xe5)]),_0x597762[_0x37081b(0x10b)](_0x37081b(0x111)),_0x2d9d09(_0xbac604);})[_0x13871c(0xeb)](_0x21f136=>{const _0x7f54a4=_0x13871c;_0x597762[_0x7f54a4(0x10b)](_0x7f54a4(0xfa)),_0x5e7159(_0x21f136);}):(_0x597762[_0x13871c(0x10b)](_0x13871c(0xda)+_0x5ef086['length']),_0x597762[_0x13871c(0x10b)](_0x13871c(0x111)),_0x2d9d09(_0x5ef086));});}catch(_0x534dd8){_0x597762[_0xed6fa9(0x10b)](_0xed6fa9(0xfa)),_0x5e7159(_0x534dd8);}});}function retrieveSourceComponentsMore(_0x371492,_0x8b5d6a,_0x285505){return new Promise((_0x339fd2,_0x5e43f6)=>{const _0x53cf3c=a27_0x165b;try{_0x371492[_0x53cf3c(0x106)](_0x8b5d6a)[_0x53cf3c(0xfe)](_0x54cf70=>{const _0x1d6393=_0x53cf3c;!_0x54cf70[_0x1d6393(0xed)]?retrieveSourceComponentsMore(_0x371492,_0x8b5d6a,_0x285505)[_0x1d6393(0xfe)](_0x3d4592=>_0x339fd2(_0x3d4592))[_0x1d6393(0xeb)](_0x1413b8=>_0x5e43f6(_0x1413b8)):_0x339fd2(_0x285505);});}catch(_0x3568df){_0x5e43f6(_0x3568df);}});}function retrieveVlocityAttachments(_0x18f753,_0xc48d47,_0xfa46fd,_0x175940,_0x51823f=[]){return new Promise((_0x1c5898,_0x1b9335)=>{const _0x3b41b3=a27_0x165b;try{_0x175940[_0x3b41b3(0x10b)](_0x3b41b3(0x10e)),callRetrieveVlocityAttachments(_0x18f753,_0xc48d47,_0xfa46fd,_0xfa46fd[_0x3b41b3(0xe5)],_0x175940,_0x51823f=[])[_0x3b41b3(0xfe)](_0x520073=>{const _0x3eab8a=_0x3b41b3;_0x175940[_0x3eab8a(0x10b)](_0x3eab8a(0xfd)),_0x1c5898(_0x520073);})[_0x3b41b3(0xeb)](_0xe5ff32=>{const _0x47cdf9=_0x3b41b3;_0x175940[_0x47cdf9(0x10b)](_0x47cdf9(0x10f)),_0x1b9335(_0xe5ff32);});}catch(_0x2a8e9a){_0x175940['log'](_0x3b41b3(0x10f)),_0x1b9335(_0x2a8e9a);}});}function a27_0x1b57(){const _0x103b10=['UNZIP_CATALOG_NAME','Component\x20Id\x20List\x20Length,\x20','join','Retrieved:\x20','90WXfGVY','ids','-sf.accessToken','-sf.instanceUrl','0$1','getHours','base64','Start\x20Unzip\x20Component\x20List','length','packDeploy','SELECT\x20Id\x20FROM\x20','41346DFWiFF','forEach','nextRecordsUrl','catch','path','done','3011106gAGJuS','846126utxiZc','62oLKdsT','getMinutes','-apex','vlocity','1916178VPQYAw','getFullYear','push','slice','2156526fQOriE','runApex','Error\x20Retrieve\x20Components\x20Ids','Patch__c\x20=\x20\x27','toString','End\x20Retrieve\x20Vlocity\x20Attachments','then','../../../services/child-process','apex','104kPcIrY','Error\x20Unzip\x20Component\x20List\x20','getSeconds','3837486bAVKGZ','records','queryMore','../../../constants','Patch_Manifest__c\x20WHERE\x20','1160088rGQHBE','-autoRetryErrors','log','20rtMQax','query','Start\x20Retrieve\x20Vlocity\x20Attachments','Error\x20Retrieve\x20Vlocity\x20Attachments','-separateMatrixVersions','End\x20Retrieve\x20Components\x20Ids','End\x20Unzip\x20Component\x20List','adm-zip'];a27_0x1b57=function(){return _0x103b10;};return a27_0x1b57();}function callRetrieveVlocityAttachments(_0x498f5e,_0x26b57b,_0x56d1e2,_0x3e7c6a,_0x3c5135,_0x362945=[]){return new Promise((_0x4ae190,_0x73fab2)=>{const _0x1ca467=a27_0x165b;try{const _0x1fda1d={'parentIds':_0x56d1e2};_0x498f5e[_0x1ca467(0x100)]['post'](_0x26b57b,_0x1fda1d)[_0x1ca467(0xfe)](_0x5b2b6b=>{const _0x5b8c07=_0x1ca467;_0x362945[_0x5b8c07(0xf6)](..._0x5b2b6b[_0x5b8c07(0x105)]),_0x3c5135[_0x5b8c07(0x10b)](_0x5b8c07(0xdc)+Number['parseFloat'](_0x362945['length']/_0x3e7c6a*0x64)['toFixed'](0x2)+'%'),_0x5b2b6b[_0x5b8c07(0xde)][_0x5b8c07(0xe5)]&&_0x56d1e2['length']!==_0x362945[_0x5b8c07(0xe5)]?callRetrieveVlocityAttachments(_0x498f5e,_0x26b57b,_0x5b2b6b[_0x5b8c07(0xde)],_0x3e7c6a,_0x3c5135,_0x362945)[_0x5b8c07(0xfe)](()=>_0x4ae190(_0x362945))['catch'](_0x1b3fd7=>{_0x73fab2(_0x1b3fd7);}):_0x4ae190(_0x362945);})[_0x1ca467(0xeb)](_0x2ac2b6=>{_0x73fab2(_0x2ac2b6);});}catch(_0x32bea0){_0x73fab2(_0x32bea0);}});}function unzipComponentList(_0x27e87b,_0x2ff23d,_0x36064b){return new Promise((_0x35056d,_0x3afdb3)=>{const _0x3aee5e=a27_0x165b;try{_0x36064b[_0x3aee5e(0x10b)](_0x3aee5e(0xe4));let _0xf5c8a6=Promise['resolve']();_0x27e87b[_0x3aee5e(0xe9)](_0xbf43b7=>{const _0x41ceea=_0x3aee5e;_0xf5c8a6=_0xf5c8a6[_0x41ceea(0xfe)](()=>unzipBuffer(_0xbf43b7,_0x2ff23d));}),_0xf5c8a6['then'](()=>{const _0x285329=_0x3aee5e;_0x36064b['log'](_0x285329(0xd7)),_0x35056d();})[_0x3aee5e(0xeb)](_0x104511=>{const _0x2a4122=_0x3aee5e;_0x36064b[_0x2a4122(0x10b)](_0x2a4122(0x102)+_0x104511),_0x3afdb3(_0x104511);});}catch(_0x14d573){_0x36064b[_0x3aee5e(0x10b)](_0x3aee5e(0x102)+_0x14d573),_0x3afdb3(_0x14d573);}});}function unzipBuffer(_0x53029c,_0x5a1246){return new Promise((_0xfcb821,_0x3c5969)=>{const _0x54d9b3=a27_0x165b;try{const _0x196329=new AdmZip(Buffer['from'](_0x53029c,_0x54d9b3(0xe3))),_0xdf668c=_0x5a1246+'/'+constants[_0x54d9b3(0xd9)];_0x196329['extractAllTo'](_0xdf668c,![]),_0xfcb821();}catch(_0x1c10f2){_0x3c5969(_0x1c10f2);}});}function deployData(_0x4d6b3d,_0xf3a1df,_0x50462c,_0x27e2b5,_0x4e29db,_0xa71f4d,_0x6d1863,_0x3d839b){return new Promise((_0xcfc004,_0x29f04b)=>{const _0x4bd331=a27_0x165b;try{_0x3d839b[_0x4bd331(0x10b)]('Start\x20Deploy\x20Data');const _0x4847a4=_0x4bd331(0xf3),_0x16483b=[_0x4bd331(0xdf),''+_0x50462c,_0x4bd331(0xe0),''+_0xf3a1df,'-job',''+constants['JOB_FILE_NAME'],_0x4bd331(0x10a)];!!_0x27e2b5&&_0x16483b[_0x4bd331(0xf6)](_0x4bd331(0x110));!!_0x4e29db&&_0x16483b['push']('-separateCalculationProcedureVersions');_0x16483b[_0x4bd331(0xf6)](_0x4bd331(0xe6));_0xa71f4d&&(_0x16483b[_0x4bd331(0xf6)](_0x4bd331(0xf9)),_0x16483b['push'](_0x4bd331(0xf2)),_0x16483b[_0x4bd331(0xf6)](_0x6d1863));_0x3d839b[_0x4bd331(0x10b)](_0x16483b[_0x4bd331(0xf7)](0x2)[_0x4bd331(0xdb)]('\x20'));const _0x55b798={'cwd':_0x4d6b3d,'maxBuffer':0x400*0x1f4};childProcess['callChildProcess'](_0x4847a4,_0x16483b,_0x3d839b,_0x55b798)[_0x4bd331(0xfe)](_0x2f5838=>{const _0x3beb55=_0x4bd331;_0x3d839b[_0x3beb55(0x10b)]('End\x20Deploy\x20Data'),_0xcfc004(_0x2f5838);})[_0x4bd331(0xeb)](_0x324f9a=>{const _0x3b12e6=_0x4bd331;_0x3d839b[_0x3b12e6(0x10b)]('Error\x20Deploy\x20Data\x20'+_0x324f9a),_0x29f04b(_0x324f9a);});}catch(_0x33f61c){_0x29f04b(_0x33f61c);}});}function getTime(){const _0x5700be=a27_0x331679,_0x5890d2=new Date(),_0x44e678=[_0x5890d2['getDate'](),_0x5890d2['getMonth']()+0x1,_0x5890d2[_0x5700be(0xf5)](),_0x5890d2[_0x5700be(0xe2)](),_0x5890d2[_0x5700be(0xf1)](),_0x5890d2[_0x5700be(0x103)]()];return _0x44e678[_0x5700be(0xe9)](_0x2d25d5=>_0x2d25d5=_0x2d25d5[_0x5700be(0xfc)]()['replace'](/^([0-9])$/,_0x5700be(0xe1))),_0x44e678[0x2]+'-'+_0x44e678[0x1]+'-'+_0x44e678[0x0]+'\x20'+_0x44e678[0x3]+':'+_0x44e678[0x4]+':'+_0x44e678[0x5];}module['exports']={'retrieveSourceComponents':retrieveSourceComponents,'retrieveVlocityAttachments':retrieveVlocityAttachments,'unzipComponentList':unzipComponentList,'deployData':deployData,'getTime':getTime};