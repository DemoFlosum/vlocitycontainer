const a33_0x3b390e=a33_0x4b7e;function a33_0x4b7e(_0x25964e,_0x5522ba){const _0x179489=a33_0x1794();return a33_0x4b7e=function(_0x4b7e27,_0x41544a){_0x4b7e27=_0x4b7e27-0x160;let _0x457a38=_0x179489[_0x4b7e27];return _0x457a38;},a33_0x4b7e(_0x25964e,_0x5522ba);}function a33_0x1794(){const _0x46d6bc=['attachLogId','authVlosityOrg','createJobYamlFile','5814417gcZbuv','getTime','15067261ZJglSY','completeDeployment','packRetry','log','checkExistComponents','logId','6UiYgnM','---\x20body','catch','2zRMiBb','isRunPackRetryAutomatically','PackRetry','accessToken','./helper','../pack-retry/controller','retrieveData','test','resolve','288989qoppeM','../../../services/http','4353365XmdFbA','valueOf','authFlosum','timestamp','tmpPath','135140oZqOIq','then','../../../constants','prepareDataForDeploy','rmdirSync','SOURCE_FOLDER','createProjectDirectory','1360LKyBKb','path','16nGAcOk','32229sqdCOb','372693imcQTX','instanceUrl'];a33_0x1794=function(){return _0x46d6bc;};return a33_0x1794();}(function(_0x571885,_0x58d45e){const _0xe6e3f4=a33_0x4b7e,_0x292681=_0x571885();while(!![]){try{const _0x2da5ee=parseInt(_0xe6e3f4(0x176))/0x1*(parseInt(_0xe6e3f4(0x16d))/0x2)+parseInt(_0xe6e3f4(0x188))/0x3*(-parseInt(_0xe6e3f4(0x186))/0x4)+parseInt(_0xe6e3f4(0x178))/0x5*(-parseInt(_0xe6e3f4(0x16a))/0x6)+parseInt(_0xe6e3f4(0x162))/0x7+parseInt(_0xe6e3f4(0x184))/0x8*(-parseInt(_0xe6e3f4(0x187))/0x9)+-parseInt(_0xe6e3f4(0x17d))/0xa+parseInt(_0xe6e3f4(0x164))/0xb;if(_0x2da5ee===_0x58d45e)break;else _0x292681['push'](_0x292681['shift']());}catch(_0x473579){_0x292681['push'](_0x292681['shift']());}}}(a33_0x1794,0x79f22));const fs=require('fs'),path=require(a33_0x3b390e(0x185)),{RetrieveHelper}=require(a33_0x3b390e(0x171)),http=require(a33_0x3b390e(0x177)),storage=require('../../../services/storage'),packRetry=require(a33_0x3b390e(0x172)),constants=require(a33_0x3b390e(0x17f)),{pathConfig}=require('../../../config/path');function retrieve(_0x4fe0ec,_0x1f445a){return new Promise((_0xe6c33a,_0x244db1)=>{const _0x23f1ca=a33_0x4b7e;try{console[_0x23f1ca(0x167)](_0x23f1ca(0x16b)),console[_0x23f1ca(0x167)](_0x4fe0ec),_0x1f445a['log']('Retrieval\x20(SFI)\x20started:\x20'+http[_0x23f1ca(0x163)]());const _0x2089de=new Date()[_0x23f1ca(0x179)](),_0x5e310b=_0x23f1ca(0x174),_0xa326f3=path['join'](pathConfig[_0x23f1ca(0x17c)],_0x5e310b),_0x23a2ef=new RetrieveHelper(_0xa326f3,_0x4fe0ec,_0x1f445a);Promise[_0x23f1ca(0x175)]()['then'](()=>storage[_0x23f1ca(0x183)](_0xa326f3))[_0x23f1ca(0x17e)](()=>_0x23a2ef[_0x23f1ca(0x161)]())['then'](()=>_0x23a2ef[_0x23f1ca(0x173)]())[_0x23f1ca(0x17e)](()=>storage[_0x23f1ca(0x168)](_0xa326f3,_0x1f445a))['then'](_0xd53617=>{const _0x1b3e22=_0x23f1ca;if(_0xd53617)return _0x23a2ef[_0x1b3e22(0x180)]()['then'](_0x278e1b=>_0x23a2ef['deployComponents'](_0x278e1b));return Promise[_0x1b3e22(0x175)]();})[_0x23f1ca(0x17e)](()=>{const _0x1ca752=_0x23f1ca;if(_0x4fe0ec[_0x1ca752(0x16e)])return _0x23a2ef['checkErrors'](_0xa326f3,_0x1f445a);return Promise[_0x1ca752(0x175)](![]);})[_0x23f1ca(0x17e)](_0x3f6734=>{const _0x42ff0e=_0x23f1ca;if(_0x4fe0ec[_0x42ff0e(0x16e)]&&_0x3f6734){_0x1f445a[_0x42ff0e(0x167)]('Snapshot\x20has\x20errors,\x20Start\x20PackRetry\x20command:');const _0x5f56ce={'flosumUrl':_0x4fe0ec[_0x42ff0e(0x17a)][_0x42ff0e(0x189)],'flosumToken':_0x4fe0ec[_0x42ff0e(0x17a)][_0x42ff0e(0x170)],'vlocityUrl':_0x4fe0ec[_0x42ff0e(0x160)]['instanceUrl'],'vlocityToken':_0x4fe0ec[_0x42ff0e(0x160)][_0x42ff0e(0x170)],'logId':_0x4fe0ec[_0x42ff0e(0x169)],'attachLogId':_0x4fe0ec[_0x42ff0e(0x18a)],'timestamp':_0x4fe0ec[_0x42ff0e(0x17b)],'nameSpacePrefix':_0x4fe0ec['nameSpacePrefix'],'snapshotType':_0x42ff0e(0x16f),'snapshotId':_0x4fe0ec['snapshotId'],'projectName':_0x5e310b};return fs['existsSync'](_0xa326f3+'/'+constants[_0x42ff0e(0x182)])&&fs[_0x42ff0e(0x181)](_0xa326f3+'/'+constants['SOURCE_FOLDER'],{'recursive':!![]}),packRetry[_0x42ff0e(0x166)](_0x5f56ce,_0x1f445a);}return Promise[_0x42ff0e(0x175)]();})[_0x23f1ca(0x17e)](()=>_0x23a2ef[_0x23f1ca(0x165)](!![]))[_0x23f1ca(0x16c)](_0xef2f12=>{const _0x37c3e7=_0x23f1ca;_0x23a2ef[_0x37c3e7(0x165)](!![],!![])[_0x37c3e7(0x17e)](()=>_0x244db1(_0xef2f12))['catch'](_0x84a5d6=>_0x244db1(_0xef2f12+'\x0a'+_0x84a5d6));});}catch(_0x5d3bea){_0x244db1(_0x5d3bea);}});}module['exports']={'retrieve':retrieve};