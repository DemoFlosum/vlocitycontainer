const a40_0x247bef=a40_0x5494;(function(_0x24951e,_0x322fc1){const _0x4e6ec5=a40_0x5494,_0x4c2dfb=_0x24951e();while(!![]){try{const _0x59781e=parseInt(_0x4e6ec5(0x179))/0x1*(parseInt(_0x4e6ec5(0x17a))/0x2)+-parseInt(_0x4e6ec5(0x1ac))/0x3*(parseInt(_0x4e6ec5(0x17c))/0x4)+-parseInt(_0x4e6ec5(0x163))/0x5+-parseInt(_0x4e6ec5(0x1f0))/0x6+-parseInt(_0x4e6ec5(0x1db))/0x7+parseInt(_0x4e6ec5(0x1f3))/0x8*(parseInt(_0x4e6ec5(0x173))/0x9)+parseInt(_0x4e6ec5(0x1f5))/0xa;if(_0x59781e===_0x322fc1)break;else _0x4c2dfb['push'](_0x4c2dfb['shift']());}catch(_0x471608){_0x4c2dfb['push'](_0x4c2dfb['shift']());}}}(a40_0x318e,0x80fd0));const fs=require('fs'),crc32=require(a40_0x247bef(0x1c6)),AdmZip=require(a40_0x247bef(0x1fb)),yaml=require(a40_0x247bef(0x169)),{resolve}=require(a40_0x247bef(0x1bd)),constants=require(a40_0x247bef(0x1a1)),childProcess=require(a40_0x247bef(0x1d8)),http=require(a40_0x247bef(0x1b9)),{VlocityHelper}=require('../../../services/vlocity'),{JsForceHelper}=require(a40_0x247bef(0x184));class RetrieveHelper{constructor(_0x842653,_0x50b62b,_0x4cfe42){const _0x37a03a=a40_0x247bef;this[_0x37a03a(0x197)]=_0x50b62b['authVlosityOrg'][_0x37a03a(0x1ad)],this['vlocityToken']=_0x50b62b[_0x37a03a(0x1f9)][_0x37a03a(0x1bf)],this[_0x37a03a(0x18a)]=_0x50b62b['logId'],this[_0x37a03a(0x174)]=_0x50b62b['attachLogId'],this['projectPath']=_0x842653,this[_0x37a03a(0x1af)]=_0x50b62b[_0x37a03a(0x1a4)],this['nameSpacePrefix']=_0x50b62b[_0x37a03a(0x1c5)],this[_0x37a03a(0x168)]=_0x50b62b['vlocityNameSpacePrefix'],this[_0x37a03a(0x166)]=_0x50b62b['nameOfComponents'],this[_0x37a03a(0x1ff)]=_0x50b62b['searchBy'],this[_0x37a03a(0x19d)]=_0x50b62b[_0x37a03a(0x19d)],this['snapshotId']=_0x50b62b['snapshotId'],this[_0x37a03a(0x1a6)]=JSON[_0x37a03a(0x18b)](_0x50b62b[_0x37a03a(0x1a6)]),this[_0x37a03a(0x1a8)]=_0x50b62b[_0x37a03a(0x1a8)],this[_0x37a03a(0x18f)]=_0x50b62b[_0x37a03a(0x18f)],this[_0x37a03a(0x1d5)]=_0x50b62b[_0x37a03a(0x1d5)],this[_0x37a03a(0x1bc)]=_0x50b62b[_0x37a03a(0x1bc)],this[_0x37a03a(0x178)]=!!_0x50b62b[_0x37a03a(0x178)],this[_0x37a03a(0x1da)]=_0x50b62b[_0x37a03a(0x1da)],this[_0x37a03a(0x171)]=_0x50b62b[_0x37a03a(0x171)],this[_0x37a03a(0x1e8)]=_0x4cfe42,this[_0x37a03a(0x1b3)]=new JsForceHelper(this[_0x37a03a(0x1af)],_0x4cfe42);}async[a40_0x247bef(0x1a3)](){const _0x4f4bf4=a40_0x247bef,_0x354d7c=await new VlocityHelper(this[_0x4f4bf4(0x1eb)],this[_0x4f4bf4(0x197)],this['logger'])['getAvailableToExport']();if(!_0x354d7c?.[_0x4f4bf4(0x165)]?.['length'])throw new Error(_0x4f4bf4(0x1b1));const _0x5ab94c=this[_0x4f4bf4(0x166)][_0x4f4bf4(0x1c1)](';')[_0x4f4bf4(0x1ec)](_0x5e8166=>_0x5e8166['toLowerCase']()),_0x116b7c=new Set(this['selectedDataPackTypes']),_0x2ce165=[];for(const {VlocityDataPackType:_0x48ec6e,Name:_0x88322f,VlocityDataPackDisplayLabel:_0x2ead5f,VlocityDataPackKey:_0x183f24}of _0x354d7c[_0x4f4bf4(0x165)]){if(!_0x116b7c[_0x4f4bf4(0x1a5)](_0x48ec6e))continue;const _0x2a75b7=_0x88322f?.[_0x4f4bf4(0x192)]()||'',_0x38b020=_0x2ead5f?.[_0x4f4bf4(0x192)]()||'',_0x9d1aae=_0x183f24?.[_0x4f4bf4(0x192)]()||'';(_0x5ab94c[_0x4f4bf4(0x196)](_0x307f59=>_0x2a75b7[_0x4f4bf4(0x1c2)](_0x307f59))||_0x5ab94c['some'](_0x3029e1=>_0x38b020[_0x4f4bf4(0x1c2)](_0x3029e1))||_0x5ab94c[_0x4f4bf4(0x196)](_0x4683cb=>_0x9d1aae[_0x4f4bf4(0x1c2)](_0x4683cb)))&&_0x2ce165['push']('\x27'+_0x183f24[_0x4f4bf4(0x176)]('\x27','\x5c\x27\x27')+'\x27');}const _0x594a55=_0x4f4bf4(0x1c3)+constants[_0x4f4bf4(0x1d7)]+_0x4f4bf4(0x1c4)+_0x2ce165['join'](_0x4f4bf4(0x195));fs[_0x4f4bf4(0x1f6)](this[_0x4f4bf4(0x18c)]+'/'+constants[_0x4f4bf4(0x1dc)],_0x594a55),this[_0x4f4bf4(0x1e8)][_0x4f4bf4(0x19b)]('End\x20Create\x20Job\x20File');}[a40_0x247bef(0x1d9)](){return new Promise((_0x972a05,_0x1fabbf)=>{const _0x2b4d8e=a40_0x5494;try{this[_0x2b4d8e(0x1e8)]['log'](_0x2b4d8e(0x162));let _0x4aa2b6;if(this[_0x2b4d8e(0x1da)]==='selective'&&this[_0x2b4d8e(0x171)]?.['length']){const _0xefce5f=this[_0x2b4d8e(0x171)][_0x2b4d8e(0x1ec)](_0x55eee0=>'\x27'+_0x55eee0[_0x2b4d8e(0x176)]('\x27',_0x2b4d8e(0x204))+'\x27');_0x4aa2b6=_0x2b4d8e(0x1c3)+constants[_0x2b4d8e(0x1d7)]+_0x2b4d8e(0x1c4)+_0xefce5f[_0x2b4d8e(0x19e)](_0x2b4d8e(0x195)),fs[_0x2b4d8e(0x1f6)](this[_0x2b4d8e(0x18c)]+'/'+constants[_0x2b4d8e(0x1dc)],_0x4aa2b6),this['logger']['log'](_0x2b4d8e(0x1c0)),_0x972a05();return;}if(this['type']==='types'){this[_0x2b4d8e(0x1a3)]()['then'](()=>_0x972a05())['catch'](_0x5a63d3=>{const _0x4626a7=_0x2b4d8e;this[_0x4626a7(0x1e8)][_0x4626a7(0x19b)](_0x4626a7(0x203)),_0x1fabbf(_0x5a63d3);});return;}_0x4aa2b6=_0x2b4d8e(0x1c3)+constants[_0x2b4d8e(0x1d7)]+'\x0a';if(this[_0x2b4d8e(0x1bc)]){if(this[_0x2b4d8e(0x166)]){if(this[_0x2b4d8e(0x1ff)]===_0x2b4d8e(0x1e2)){const _0x3db38a=this['nameOfComponents']['split']('\x0a')[_0x2b4d8e(0x207)](_0x58a8ca=>_0x58a8ca['trim']()[_0x2b4d8e(0x1c9)]('-'))['map'](_0x3b74a6=>_0x3b74a6[_0x2b4d8e(0x1b7)]('-','')['trim']());_0x3db38a['length']?(_0x4aa2b6+=_0x2b4d8e(0x1b8),_0x4aa2b6+=_0x3db38a[_0x2b4d8e(0x19e)](_0x2b4d8e(0x195)),fs['appendFileSync'](this[_0x2b4d8e(0x18c)]+'/'+constants[_0x2b4d8e(0x1dc)],_0x4aa2b6),this['logger'][_0x2b4d8e(0x19b)](_0x2b4d8e(0x1c0)),_0x972a05()):_0x1fabbf(_0x2b4d8e(0x16e));}if(this[_0x2b4d8e(0x1ff)]==='yaml')try{const _0x447f3a=yaml[_0x2b4d8e(0x20c)](this['nameOfComponents']);_0x447f3a[_0x2b4d8e(0x18c)]='./source_data',fs['appendFileSync'](this['projectPath']+'/'+constants[_0x2b4d8e(0x1dc)],yaml['dump'](_0x447f3a)),_0x972a05(),this[_0x2b4d8e(0x1e8)][_0x2b4d8e(0x19b)](_0x2b4d8e(0x1c0));}catch(_0x3ebee2){this[_0x2b4d8e(0x1e8)][_0x2b4d8e(0x19b)](_0x2b4d8e(0x170)+_0x3ebee2),_0x1fabbf(_0x3ebee2);}else _0x4aa2b6+=_0x2b4d8e(0x180)+this[_0x2b4d8e(0x1dd)](),fs[_0x2b4d8e(0x1f6)](this[_0x2b4d8e(0x18c)]+'/'+constants[_0x2b4d8e(0x1dc)],_0x4aa2b6),_0x972a05(),this[_0x2b4d8e(0x1e8)][_0x2b4d8e(0x19b)]('End\x20Create\x20Job\x20File');}else _0x4aa2b6+=_0x2b4d8e(0x180)+this['getVlocityQueries'](),fs[_0x2b4d8e(0x1f6)](this[_0x2b4d8e(0x18c)]+'/'+constants[_0x2b4d8e(0x1dc)],_0x4aa2b6),_0x972a05(),this[_0x2b4d8e(0x1e8)]['log'](_0x2b4d8e(0x1c0));}else _0x4aa2b6+=_0x2b4d8e(0x180)+this[_0x2b4d8e(0x1dd)](),fs[_0x2b4d8e(0x1f6)](this[_0x2b4d8e(0x18c)]+'/'+constants[_0x2b4d8e(0x1dc)],_0x4aa2b6),_0x972a05(),this[_0x2b4d8e(0x1e8)]['log'](_0x2b4d8e(0x1c0));}catch(_0xa578de){this['logger'][_0x2b4d8e(0x19b)](_0x2b4d8e(0x203)),_0x1fabbf(_0xa578de);}});}['getVlocityQueries'](){const _0x2ba0d2=a40_0x247bef,_0x137194=Array[_0x2ba0d2(0x1ce)](this[_0x2ba0d2(0x1a6)])?this[_0x2ba0d2(0x1a6)]:Object['keys'](this[_0x2ba0d2(0x1a6)]),_0x366e0=[];/^ *$/[_0x2ba0d2(0x1ed)](this[_0x2ba0d2(0x166)])?this[_0x2ba0d2(0x166)]=[]:this[_0x2ba0d2(0x166)]=this['nameOfComponents'][_0x2ba0d2(0x1c1)](';');if(this[_0x2ba0d2(0x166)]['length']){const _0x5c64e6=this[_0x2ba0d2(0x19d)]?this[_0x2ba0d2(0x166)][_0x2ba0d2(0x19e)]('%\x27\x20OR\x20Name\x20LIKE\x20\x27%'):this[_0x2ba0d2(0x166)]['join'](_0x2ba0d2(0x1e3));for(const _0x2a761b of _0x137194){_0x366e0[_0x2ba0d2(0x208)](this[_0x2ba0d2(0x1d3)](_0x2a761b,_0x5c64e6));}}else for(const _0x43c789 of _0x137194){const _0x1f2b62=constants['UNSUPPORTED_BY_DEFAULT_LIST']['includes'](_0x43c789)?this['createQuery'](_0x43c789):'-\x20'+_0x43c789;_0x366e0[_0x2ba0d2(0x208)](_0x1f2b62);}return _0x366e0[_0x2ba0d2(0x19e)]('\x0a');}['createQuery'](_0x3b6cad,_0x386269=null){const _0x510e5b=a40_0x247bef,_0x266cd3=constants[_0x510e5b(0x17e)][_0x3b6cad];let _0x891369='';if(_0x266cd3){const _0x15eb8a=_0x266cd3[_0x510e5b(0x190)]['endsWith'](_0x510e5b(0x1fc))&&!!this[_0x510e5b(0x168)]?''+this[_0x510e5b(0x168)]+_0x266cd3['objectName']:''+_0x266cd3['objectName'];_0x891369=_0x510e5b(0x1ae)+_0x3b6cad+'\x0a';const _0x9f076d=_0x266cd3[_0x510e5b(0x1cc)][_0x510e5b(0x1b7)](new RegExp(constants[_0x510e5b(0x16f)],'g'),this[_0x510e5b(0x168)]);this[_0x510e5b(0x19d)]?(_0x891369+='\x20\x20query:\x20SELECT\x20'+_0x9f076d+_0x510e5b(0x1b0)+_0x15eb8a,_0x386269&&(_0x891369+='\x20WHERE\x20(Name\x20LIKE\x20\x27%'+_0x386269+'%\x27)')):(_0x891369+=_0x510e5b(0x16a)+_0x9f076d+_0x510e5b(0x1b0)+_0x15eb8a,_0x386269&&(_0x891369+=_0x510e5b(0x1c8)+_0x386269+'\x27)'));if(_0x266cd3[_0x510e5b(0x167)]){const _0x4184c4=_0x386269?_0x510e5b(0x1d4):_0x510e5b(0x189),_0x1f053f=_0x266cd3[_0x510e5b(0x167)][_0x510e5b(0x1b7)](new RegExp(constants[_0x510e5b(0x16f)],'g'),this['vlocityNameSpacePrefix']);_0x891369+='\x20'+_0x4184c4+'\x20'+_0x1f053f+'\x0a';}else _0x891369+='\x0a';}return _0x891369;}[a40_0x247bef(0x1be)](){return new Promise((_0x3ebee6,_0x543d68)=>{const _0x3d1531=a40_0x5494;try{this[_0x3d1531(0x1e8)][_0x3d1531(0x19b)]('Start\x20Retrieve\x20Data');const _0x491710=_0x3d1531(0x1b5),_0x251ccb=this[_0x3d1531(0x1a8)]?'0':'-1',_0xed24d5=[_0x3d1531(0x1de),''+this[_0x3d1531(0x1eb)],_0x3d1531(0x186),''+this[_0x3d1531(0x197)],'-job',''+constants[_0x3d1531(0x1dc)],_0x3d1531(0x16d),_0x3d1531(0x198),_0x251ccb];this['isSeparateMatrixVersions']&&_0xed24d5[_0x3d1531(0x208)]('-separateMatrixVersions');this[_0x3d1531(0x1d5)]&&_0xed24d5[_0x3d1531(0x208)]('-separateCalculationProcedureVersions');_0xed24d5[_0x3d1531(0x208)](_0x3d1531(0x1ab));const _0x48147b=()=>{const _0x1ffb29=_0x3d1531;http[_0x1ffb29(0x16b)](this['projectPath'],this[_0x1ffb29(0x1b3)],this[_0x1ffb29(0x174)],this['logger'],![]);};this[_0x3d1531(0x1e8)]['log'](_0xed24d5[_0x3d1531(0x19e)]('\x20'));const _0x3b7ad3={'cwd':''+this[_0x3d1531(0x18c)],'maxBuffer':0x400*0x1f4};childProcess[_0x3d1531(0x17b)](_0x491710,_0xed24d5,this[_0x3d1531(0x1e8)],_0x3b7ad3,!![],_0x48147b)[_0x3d1531(0x183)](_0x34431e=>{const _0x4aeb28=_0x3d1531;this[_0x4aeb28(0x1e8)]['log']('End\x20Retrieve\x20Data'),_0x3ebee6(_0x34431e);})[_0x3d1531(0x1f4)](_0x1794d6=>{const _0x44a474=_0x3d1531;this['logger'][_0x44a474(0x19b)](_0x44a474(0x1aa)+_0x1794d6),_0x543d68(_0x1794d6);});}catch(_0x4711e2){_0x543d68(_0x4711e2);}});}[a40_0x247bef(0x200)](){return new Promise((_0xacbbb2,_0x5389b6)=>{const _0x1a3a8b=a40_0x5494;try{this[_0x1a3a8b(0x1e8)][_0x1a3a8b(0x19b)](_0x1a3a8b(0x1ee));let _0x4f3255=0x0,_0x228933=[],_0x361f1e=0x0;const _0x36b812=[],_0x4308cc=this[_0x1a3a8b(0x18c)]+'/'+constants[_0x1a3a8b(0x1d7)],_0x521193=fs[_0x1a3a8b(0x1d1)](_0x4308cc);for(let _0xb2d873=0x0;_0xb2d873<_0x521193[_0x1a3a8b(0x19f)];_0xb2d873++){const _0x5ec7fb=_0x521193[_0xb2d873]===_0x1a3a8b(0x199)?_0x1a3a8b(0x1cb):'Name',_0x201fbe=_0x4308cc+'/'+_0x521193[_0xb2d873],_0x5c85fb=fs['readdirSync'](_0x201fbe);for(let _0x5a9f05=0x0;_0x5a9f05<_0x5c85fb['length'];_0x5a9f05++){const _0x48cbe4=_0x521193[_0xb2d873]+'/'+_0x5c85fb[_0x5a9f05];let _0x115159=_0x5c85fb[_0x5a9f05];const _0x445bfb=[],_0x23f56c=_0x4308cc+'/'+_0x521193[_0xb2d873]+'/'+_0x5c85fb[_0x5a9f05],_0x39ffd4=fs[_0x1a3a8b(0x1d1)](_0x23f56c);_0x39ffd4['forEach'](_0x517d03=>{const _0x3d36cc=_0x1a3a8b;try{_0x517d03[_0x3d36cc(0x1cd)]()['endsWith'](_0x3d36cc(0x1e1))&&(_0x115159=JSON[_0x3d36cc(0x18b)](fs[_0x3d36cc(0x1c7)](_0x23f56c+'/'+_0x517d03)[_0x3d36cc(0x1cd)]())[_0x5ec7fb]);}catch(_0x5621c){this[_0x3d36cc(0x1e8)][_0x3d36cc(0x19b)](_0x3d36cc(0x1ba)+_0x517d03);}!_0x115159&&(_0x115159=undefined),fs['lstatSync'](_0x23f56c+'/'+_0x517d03[_0x3d36cc(0x1cd)]())['isDirectory']()&&_0x445bfb[_0x3d36cc(0x208)](...this[_0x3d36cc(0x1fa)](_0x23f56c,_0x517d03));});const _0x4b38b3=new AdmZip();_0x4b38b3[_0x1a3a8b(0x1ca)](_0x23f56c,_0x521193[_0xb2d873]+'/'+_0x5c85fb[_0x5a9f05]);const _0x41889f=_0x4b38b3[_0x1a3a8b(0x1f8)](),_0x2f78b6=crc32['buf'](_0x41889f),_0x16c5dd=_0x41889f[_0x1a3a8b(0x1cd)](_0x1a3a8b(0x202)),_0x15bf16={'fileName':_0x115159,'name':_0x5c85fb[_0x5a9f05],'type':_0x521193[_0xb2d873],'label':_0x48cbe4,'crc':_0x2f78b6,'base64':_0x16c5dd,'snapshotId':this[_0x1a3a8b(0x205)],'subItemList':JSON[_0x1a3a8b(0x185)](_0x445bfb)},_0x4f3335=_0x41889f['length']/0xf4240,_0x5b3f47=!!(_0x5c85fb[_0x1a3a8b(0x19f)]-0x1===_0x5a9f05&&_0x521193[_0x1a3a8b(0x19f)]-0x1===_0xb2d873);_0x4f3255+=_0x4f3335,_0x4f3255>0x2||_0x228933>0xfa0?(_0x36b812[_0x1a3a8b(0x208)](_0x228933),_0x4f3335<0x3?(_0x228933=[_0x15bf16],_0x361f1e++,_0x4f3255=_0x4f3335):(this[_0x1a3a8b(0x1e8)][_0x1a3a8b(0x19b)](_0x1a3a8b(0x188)+_0x48cbe4+_0x1a3a8b(0x182),!![]),_0x4f3255=0x0)):(_0x228933[_0x1a3a8b(0x208)](_0x15bf16),_0x361f1e++),_0x5b3f47&&_0x36b812[_0x1a3a8b(0x208)](_0x228933);}}this[_0x1a3a8b(0x1e8)][_0x1a3a8b(0x19b)](_0x1a3a8b(0x16c)),_0xacbbb2({'iteratorDeploy':_0x36b812[Symbol['iterator']](),'count':_0x361f1e});}catch(_0x1aaeee){this[_0x1a3a8b(0x1e8)][_0x1a3a8b(0x19b)]('Error\x20Prepare\x20Data\x20For\x20Deploy'),_0x5389b6(_0x1aaeee);}});}[a40_0x247bef(0x1fa)](_0x255fa6,_0x20668e,_0x5dd8af='',_0x14aa0a=[]){const _0x31b60d=a40_0x247bef;_0x5dd8af[_0x31b60d(0x19f)]&&(_0x5dd8af='/'+_0x5dd8af);const _0x2949e1=fs[_0x31b60d(0x1d1)](_0x255fa6+'/'+_0x20668e+_0x5dd8af);return _0x2949e1[_0x31b60d(0x175)](_0x5903dc=>{const _0x321e1b=_0x31b60d;!fs[_0x321e1b(0x209)](_0x255fa6+'/'+_0x20668e+_0x5dd8af+'/'+_0x5903dc[_0x321e1b(0x1cd)]())['isDirectory']()?_0x14aa0a[_0x321e1b(0x208)](''+_0x20668e+_0x5dd8af+'/'+_0x5903dc[_0x321e1b(0x1cd)]()):this[_0x321e1b(0x1fa)](_0x255fa6,_0x20668e,_0x5903dc,_0x14aa0a);}),_0x14aa0a;}[a40_0x247bef(0x1a7)](_0xbd4c4,_0x31d268='',_0x1024ef=[]){const _0x300ba8=a40_0x247bef,_0x4fb568=fs[_0x300ba8(0x1d1)](_0xbd4c4,{'withFileTypes':!![]});return _0x4fb568['forEach'](_0x362228=>{const _0x535208=_0x300ba8,_0x5bdd6d=resolve(_0xbd4c4,_0x362228[_0x535208(0x20b)]);if(_0x362228[_0x535208(0x1ea)]()){const _0x3294b9=_0x31d268['length']?_0x31d268+'/'+_0x362228[_0x535208(0x20b)]:_0x362228['name'];this[_0x535208(0x1a7)](_0x5bdd6d,_0x3294b9,_0x1024ef);}else{let _0x217d85;_0x31d268[_0x535208(0x19f)]?_0x217d85=_0x31d268+'/'+_0x362228[_0x535208(0x20b)]:_0x217d85=_0x362228[_0x535208(0x20b)],_0x1024ef[_0x535208(0x208)](_0x217d85);}}),_0x1024ef;}[a40_0x247bef(0x1e5)](_0x3bae0b){return new Promise((_0xbe9a48,_0x32bb68)=>{const _0x3804b1=a40_0x5494;try{this['logger'][_0x3804b1(0x19b)](_0x3804b1(0x1e9)),this[_0x3804b1(0x164)](_0x3bae0b)[_0x3804b1(0x183)](()=>{const _0x566a20=_0x3804b1;this[_0x566a20(0x1e8)][_0x566a20(0x19b)](_0x566a20(0x19c)),_0xbe9a48();})[_0x3804b1(0x1f4)](_0x1a29c6=>{const _0x521477=_0x3804b1;this[_0x521477(0x1e8)][_0x521477(0x19b)](_0x521477(0x18e)+_0x1a29c6),_0x32bb68(_0x1a29c6);});}catch(_0x696ddd){_0x32bb68(_0x696ddd);}});}['nextChunk'](_0x1b9ed4,_0x295d49=0x0){return new Promise((_0x42fbfe,_0x456bb3)=>{const _0x17a55e=a40_0x5494;try{const _0x5422e8=_0x1b9ed4['iteratorDeploy'][_0x17a55e(0x1f1)]();_0x5422e8[_0x17a55e(0x1a2)]?_0x42fbfe():this[_0x17a55e(0x1f7)](_0x1b9ed4,_0x5422e8,_0x295d49)['then'](()=>_0x42fbfe())['catch'](_0x535642=>_0x456bb3(_0x535642));}catch(_0x54dde3){_0x456bb3(_0x54dde3);}});}[a40_0x247bef(0x1f7)](_0x1ba739,_0x380a1e,_0x2bbf15=0x0){return new Promise((_0x5c080b,_0x33568b)=>{const _0x376d99=a40_0x5494;try{const _0x1514d0={'items':_0x380a1e[_0x376d99(0x1b2)]};http[_0x376d99(0x20d)](this[_0x376d99(0x1af)],this[_0x376d99(0x1c5)],_0x1514d0,_0x376d99(0x19a))[_0x376d99(0x183)](()=>{const _0x5cd7bc=_0x376d99;return _0x2bbf15+=_0x380a1e[_0x5cd7bc(0x1b2)][_0x5cd7bc(0x19f)],this[_0x5cd7bc(0x1e8)][_0x5cd7bc(0x19b)](_0x5cd7bc(0x1df)+_0x2bbf15+'\x20from\x20'+_0x1ba739['count']),Promise['resolve']();})[_0x376d99(0x1f4)](_0x153d0f=>{const _0x1ff8bd=_0x376d99;return this[_0x1ff8bd(0x1e8)][_0x1ff8bd(0x19b)](_0x1ff8bd(0x1cf)+_0x153d0f),Promise[_0x1ff8bd(0x1d2)]();})[_0x376d99(0x183)](()=>this['nextChunk'](_0x1ba739,_0x2bbf15))[_0x376d99(0x183)](_0x5c080b)[_0x376d99(0x1f4)](_0x33568b);}catch(_0x41d2e4){_0x33568b(_0x41d2e4);}});}[a40_0x247bef(0x194)](){return new Promise(_0x52e0b8=>{const _0x264731=a40_0x5494;try{this['logger']['log'](_0x264731(0x1e7));const _0xdc8f28=this[_0x264731(0x18c)]+'/'+constants['VLOCITY_TEMP_CATALOG'];if(fs[_0x264731(0x193)](_0xdc8f28)){const _0x1a70d0=_0xdc8f28+_0x264731(0x1b6);if(this[_0x264731(0x1e8)][_0x264731(0x1a9)][_0x264731(0x19f)]&&fs[_0x264731(0x193)](_0x1a70d0)){const _0x5f30ee=fs[_0x264731(0x1d1)](_0x1a70d0);if(_0x5f30ee&&_0x5f30ee[_0x264731(0x19f)]){const _0xec5e69=_0x5f30ee[0x0];if(_0xec5e69[_0x264731(0x1c2)](_0x264731(0x1bb))&&_0xec5e69['includes'](_0x264731(0x1e6))){const _0x4fcdc7=_0x264731(0x17d)+JSON['stringify'](this[_0x264731(0x1e8)][_0x264731(0x1a9)]);fs[_0x264731(0x1f6)]('./'+_0x1a70d0+'/'+_0xec5e69,_0x4fcdc7);}}}const _0x4f224b=new AdmZip();_0x4f224b[_0x264731(0x1ca)](_0xdc8f28,constants[_0x264731(0x17f)]),_0x52e0b8(_0x4f224b[_0x264731(0x1f8)]()[_0x264731(0x1cd)]('base64')),this['logger'][_0x264731(0x19b)](_0x264731(0x1ef));}else this[_0x264731(0x1e8)][_0x264731(0x19b)](_0x264731(0x1e4)),_0x52e0b8();}catch(_0x257d44){this[_0x264731(0x1e8)]['log']('Error\x20Create\x20Vlocity\x20Temp\x20Zip\x20'+_0x257d44),_0x52e0b8();}});}async['sendVlocityTemp'](_0x307a94){const _0x545e33=a40_0x247bef;this['logger'][_0x545e33(0x19b)]('Start\x20Send\x20Vlocity\x20Temp');const _0x4b2d7f={'Name':_0x545e33(0x201),'ContentType':'application/zip','Description':'Vlocity\x20Temp','ParentId':this['snapshotId'],'Body':_0x307a94};await this[_0x545e33(0x1b3)]['createAttachment'](_0x4b2d7f),this[_0x545e33(0x1e8)][_0x545e33(0x19b)](_0x545e33(0x172));}[a40_0x247bef(0x1b4)](){return new Promise(_0x4fc764=>{const _0x11037e=a40_0x5494;try{if(fs[_0x11037e(0x193)](this[_0x11037e(0x18c)]+'/'+constants[_0x11037e(0x1a0)])){const _0x25d34f=yaml[_0x11037e(0x20c)](fs['readFileSync'](this[_0x11037e(0x18c)]+'/'+constants[_0x11037e(0x1a0)],_0x11037e(0x206)));_0x25d34f['Errors']&&_0x25d34f['Errors']['length']?(this['logger'][_0x11037e(0x19b)](_0x11037e(0x20a)+_0x25d34f[_0x11037e(0x1e0)][_0x11037e(0x19e)]('\x0a')),_0x4fc764(!![])):_0x4fc764(![]);}else _0x4fc764(![]);}catch(_0x15df06){_0x4fc764(![]);}});}[a40_0x247bef(0x1fd)](_0x10cef9,_0x25dc82=![]){return new Promise((_0x381485,_0x52e7fd)=>{const _0x1fead7=a40_0x5494;try{Promise['resolve']()[_0x1fead7(0x183)](()=>this[_0x1fead7(0x194)]())[_0x1fead7(0x183)](_0x47f1f3=>{const _0x466ea4=_0x1fead7;if(_0x47f1f3)return this[_0x466ea4(0x191)](_0x47f1f3);return Promise[_0x466ea4(0x1d2)]();})[_0x1fead7(0x183)](()=>http[_0x1fead7(0x16b)](this['projectPath'],this[_0x1fead7(0x1b3)],this['attachLogId'],this[_0x1fead7(0x1e8)],_0x25dc82,!![]))[_0x1fead7(0x183)](_0x34b352=>{const _0x82c85b=_0x1fead7;return _0x25dc82=_0x34b352,http[_0x82c85b(0x1d6)](this[_0x82c85b(0x1b3)],this[_0x82c85b(0x18a)],this[_0x82c85b(0x1c5)],_0x10cef9,this['logger'],_0x34b352);})[_0x1fead7(0x183)](()=>this[_0x1fead7(0x161)](_0x25dc82));}catch(_0x2c28f9){_0x52e7fd(_0x2c28f9);}});}async[a40_0x247bef(0x161)](_0x22bfac){const _0x58207b=a40_0x247bef;this[_0x58207b(0x1e8)][_0x58207b(0x19b)](_0x58207b(0x1f2));const _0x569442={'Id':this[_0x58207b(0x205)],[this[_0x58207b(0x1c5)]+_0x58207b(0x1d0)]:!![],[this[_0x58207b(0x1c5)]+_0x58207b(0x1fe)]:_0x22bfac};return await this[_0x58207b(0x1b3)]['updateSnapshot'](this[_0x58207b(0x1c5)],_0x569442),this['logger']['log'](_0x58207b(0x181)),_0x569442[this['nameSpacePrefix']+_0x58207b(0x1fe)];}}function a40_0x5494(_0x4a32d5,_0x393c9e){const _0x318ee8=a40_0x318e();return a40_0x5494=function(_0x5494c1,_0x136fd2){_0x5494c1=_0x5494c1-0x161;let _0x46e9b3=_0x318ee8[_0x5494c1];return _0x46e9b3;},a40_0x5494(_0x4a32d5,_0x393c9e);}function a40_0x318e(){const _0x3e8fb1=['startsWith','addLocalFolder','Title','fields','toString','isArray','Error\x20deploy\x20chunk\x20','Is_Completed__c','readdirSync','resolve','createQuery','AND','isSeparateCalculationProcedureVersions','callUpdateLog','UNZIP_CATALOG_NAME','../../../services/child-process','createJobYamlFile','type','563605EPIJUg','JOB_FILE_NAME','getVlocityQueries','-sf.accessToken','Deployed\x20','Errors','_DataPack.json','key','\x27,\x27','Error\x20Create\x20Vlocity\x20Temp\x20Zip,\x20Vlocity\x20Temp\x20not\x20found','deployComponents','-Export.yaml','Start\x20Create\x20Vlocity\x20Temp\x20Zip','logger','Start\x20Deploy\x20Components','isDirectory','vlocityToken','map','test','Start\x20Prepare\x20Data\x20For\x20Deploy','End\x20Create\x20Vlocity\x20Temp\x20Zip','6221658tFxzwi','next','Start\x20Update\x20Snapshot','10024NZhjym','catch','8389790ndnMHV','appendFileSync','deploy','toBuffer','authVlosityOrg','findSubItems','adm-zip','__c','completeDeployment','Is_Error__c','searchBy','prepareDataForDeploy','Vlocity\x20Temp','base64','Error\x20Create\x20Job\x20File','\x5c\x27\x27','snapshotId','utf8','filter','push','lstatSync','Errors\x20found,\x20start\x20pack\x20retry\x20command\x20\x0a','name','load','post','callUpdateSnapshot','Start\x20Create\x20Job\x20File','1163260mGGupE','nextChunk','records','nameOfComponents','query','vlocityNameSpacePrefix','js-yaml','\x20\x20query:\x20SELECT\x20','updateAttachmentLog','End\x20Prepare\x20Data\x20For\x20Deploy','-autoRetryErrors','Error,\x20Components\x20not\x20found','VLOCITY_NAMESPACE_PREFIX_CODE','Error\x20Create\x20Job\x20File,\x20Not\x20Valid\x20Provided\x20Yaml\x20File:\x20','keys','End\x20Send\x20Vlocity\x20Temp','7218RRpRxI','attachLogId','forEach','replaceAll','addFile','isRunPackRetryAutomatically','20963VfRZfK','14RhjAOB','callChildProcess','44872qOyjEF','FlosumErrors:\x20','DATA_PACK_TYPES_QUERIES_MAP','VLOCITY_TEMP_CATALOG','queries:\x0a','End\x20Update\x20Snapshot',',\x20size\x20more\x20then\x203mb.','then','../../../services/js-force','stringify','-sf.instanceUrl','from','Cannot\x20retrieve\x20component\x20','WHERE','logId','parse','projectPath','exports','Error\x20Deploy\x20Components\x20','isSeparateMatrixVersions','objectName','sendVlocityTemp','toLowerCase','existsSync','createVlocityTempZip','\x0a\x20-\x20','some','vlocityUrl','-maxDepth','ContentVersion','SnapshotVlocity/','log','End\x20Deploy\x20Components','isLikeSearch','join','length','NAME_LOGS_FILE','../../../constants','done','createYamlByDataPackTypes','authFlosum','has','selectedDataPackTypes','readFiles','isNotIncludeDependencies','errors','Error\x20Retrieve\x20Data\x20','packExport','30TlLfAf','instanceUrl','-\x20VlocityDataPackType:\x20','flosumAuth','\x20FROM\x20','Records\x20to\x20export\x20not\x20a\x20found','value','jsForceHelper','checkErrors','vlocity','/logs','replace','manifest:\x0a\x20-\x20','../../../services/http','Error\x20parse\x20component\x20','job-yaml-','isAfterUpdateSearchByKey','path','retrieveData','accessToken','End\x20Create\x20Job\x20File','split','includes','projectPath:\x20./','\x0amanifest:\x0a\x20-\x20','nameSpacePrefix','crc-32','readFileSync','\x20WHERE\x20Name\x20IN\x20(\x27'];a40_0x318e=function(){return _0x3e8fb1;};return a40_0x318e();}function createZip(_0x52a423,_0x132709){const _0x46d071=a40_0x247bef,_0x178979=new AdmZip(),_0x420712=this['readFiles'](_0x52a423);return _0x420712[_0x46d071(0x175)](_0x13a17c=>{const _0x4203fa=_0x46d071;if(Array[_0x4203fa(0x1ce)](_0x13a17c))_0x13a17c[_0x4203fa(0x175)](_0x94616f=>{const _0x17d8e5=_0x4203fa,_0x1520e5=fs[_0x17d8e5(0x1c7)](_0x52a423+'/'+_0x94616f,_0x17d8e5(0x206));_0x178979[_0x17d8e5(0x177)](_0x132709+'/'+_0x94616f,Buffer[_0x17d8e5(0x187)](_0x1520e5));});else{const _0x2f7a47=fs[_0x4203fa(0x1c7)](_0x52a423+'/'+_0x13a17c,_0x4203fa(0x206));_0x178979['addFile'](_0x132709+'/'+_0x13a17c,Buffer['from'](_0x2f7a47));}}),_0x178979[_0x46d071(0x1f8)]();}module[a40_0x247bef(0x18d)]={'RetrieveHelper':RetrieveHelper};