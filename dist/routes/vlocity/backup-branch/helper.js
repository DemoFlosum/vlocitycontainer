const a10_0x4661fa=a10_0x3a0b;function a10_0x3a0b(_0x31c851,_0x213d69){const _0x15d456=a10_0x15d4();return a10_0x3a0b=function(_0x3a0b54,_0x1326d){_0x3a0b54=_0x3a0b54-0x1ac;let _0x7a62f8=_0x15d456[_0x3a0b54];return _0x7a62f8;},a10_0x3a0b(_0x31c851,_0x213d69);}(function(_0x54cea3,_0x561b23){const _0x50dc2f=a10_0x3a0b,_0x2172dd=_0x54cea3();while(!![]){try{const _0x4acf63=parseInt(_0x50dc2f(0x1ba))/0x1*(parseInt(_0x50dc2f(0x1d8))/0x2)+parseInt(_0x50dc2f(0x1ec))/0x3*(parseInt(_0x50dc2f(0x1d3))/0x4)+-parseInt(_0x50dc2f(0x1e9))/0x5+parseInt(_0x50dc2f(0x1ac))/0x6+-parseInt(_0x50dc2f(0x1c6))/0x7+parseInt(_0x50dc2f(0x1da))/0x8*(-parseInt(_0x50dc2f(0x1d9))/0x9)+parseInt(_0x50dc2f(0x1e6))/0xa;if(_0x4acf63===_0x561b23)break;else _0x2172dd['push'](_0x2172dd['shift']());}catch(_0x16dd67){_0x2172dd['push'](_0x2172dd['shift']());}}}(a10_0x15d4,0x97fea));const fs=require('fs'),AdmZip=require(a10_0x4661fa(0x1b8)),childProcess=require(a10_0x4661fa(0x1d4)),constants=require(a10_0x4661fa(0x1bf)),http=require('../../../services/http');function a10_0x15d4(){const _0x43df64=['12qsuCSc','../../../services/child-process','unlocked-packages','name','keys','1922908lldPxJ','711rYCsvL','59416oaAibI','SOURCE_FOLDER','join','callChildProcess','replace','catch','Start\x20Prepare\x20Data\x20For\x20Deploy','End\x20Create\x20Job\x20File','base64','UNZIP_CATALOG_NAME','End\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','Start\x20Retrieve\x20Data','4813270WePqSp','METHOD_BACKUP_LOG','vlocity','991840dpZLqg','Components\x20not\x20found!','Start\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','540507lySegT','METHOD_BACKUP_LOG_ERROR','End\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','Start\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','1958148wJzKbG','\x0aqueries:\x0a','resolve','then','projectPath:\x20./','toString','stringify','Error\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','-sf.accessToken','\x20\x20\x20\x20query:\x20Select\x20Id\x20from\x20','-sf.instanceUrl','Error\x20Prepare\x20Data\x20For\x20Deploy','adm-zip','length','1OSnFuw','isDirectory','/services/apexrest/','\x20\x20-\x20VlocityDataPackType:\x20','End\x20Prepare\x20Data\x20For\x20Deploy','../../../constants','Error\x20Deploy\x20Data','zipBuffer','toBuffer','-autoRetryErrors','addLocalFolder','push','6313825nGPzMA','Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','-job','log','isStartDeploy','post','Start\x20Create\x20Job\x20File','forEach','DATA_PACK_TYPES_QUERIES_MAP','METHOD_NEXT_VLOCITY_CONTINUE_DEPLOY_STEP','Start\x20Deploy\x20Data','Error\x20Retrieve\x20Data\x20','End\x20Retrieve\x20Data'];a10_0x15d4=function(){return _0x43df64;};return a10_0x15d4();}function createJobFileRollback(_0x29d60b,_0x3f6f18,_0x47c717,_0x101484){return new Promise((_0xe22064,_0x382df2)=>{const _0x220e1b=a10_0x3a0b;try{_0x101484[_0x220e1b(0x1c9)](_0x220e1b(0x1cc));let _0x2936b4=_0x220e1b(0x1b0)+constants[_0x220e1b(0x1e3)]+_0x220e1b(0x1ad);Object[_0x220e1b(0x1d7)](_0x3f6f18)[_0x220e1b(0x1cd)](_0x4688f5=>{_0x3f6f18[_0x4688f5]['forEach'](_0x22581d=>{const _0x22007d=a10_0x3a0b;constants[_0x22007d(0x1ce)][_0x4688f5]['forEach'](_0x22eace=>{const _0x5dbf23=_0x22007d;_0x2936b4+=_0x5dbf23(0x1bd)+_0x4688f5+'\x0a',_0x2936b4+=_0x5dbf23(0x1b5)+_0x22eace+'\x20where\x20Name\x20LIKE\x20\x27%'+_0x22581d+'%\x27\x0a';});});}),fs['appendFileSync'](_0x29d60b+'/'+constants['JOB_FILE_NAME'],_0x2936b4),_0x101484[_0x220e1b(0x1c9)](_0x220e1b(0x1e1)),_0xe22064();}catch(_0x22a1b0){_0x101484[_0x220e1b(0x1c9)]('Error\x20Create\x20Job\x20File'),_0x382df2(_0x22a1b0);}});}function retrieveData(_0x415dee,_0x37ca24,_0x3b6cd7,_0x417ddf){return new Promise((_0x41c112,_0x1b4cb1)=>{const _0x2aac4d=a10_0x3a0b;try{_0x417ddf[_0x2aac4d(0x1c9)](_0x2aac4d(0x1e5));const _0x1c4188=_0x2aac4d(0x1e8),_0x504c5c=[_0x2aac4d(0x1b4),''+_0x3b6cd7,_0x2aac4d(0x1b6),''+_0x37ca24,_0x2aac4d(0x1c8),''+constants['JOB_FILE_NAME'],_0x2aac4d(0x1c3),'-maxDepth','0','packExport'];_0x417ddf[_0x2aac4d(0x1c9)](_0x504c5c['slice'](0x2)[_0x2aac4d(0x1dc)]('\x20'));const _0x596e01={'cwd':''+_0x415dee,'maxBuffer':0x400*0x1f4};childProcess[_0x2aac4d(0x1dd)](_0x1c4188,_0x504c5c,_0x417ddf,_0x596e01)['then'](_0x992399=>{const _0x2fa77f=_0x2aac4d;_0x417ddf['log'](_0x2fa77f(0x1d2)),_0x41c112(_0x992399);})[_0x2aac4d(0x1df)](_0x51f5b6=>{const _0x5b38ef=_0x2aac4d;_0x417ddf[_0x5b38ef(0x1c9)](_0x5b38ef(0x1d1)+_0x51f5b6),_0x1b4cb1(_0x51f5b6);});}catch(_0x459c57){_0x1b4cb1(_0x459c57);}});}function prepareDataForDeploy(_0x346936,_0xba2430){return new Promise((_0xae156d,_0x1d6b5c)=>{const _0xff12bf=a10_0x3a0b;try{_0xba2430[_0xff12bf(0x1c9)](_0xff12bf(0x1e0));const _0x354160=_0x346936+'/'+constants[_0xff12bf(0x1db)];let _0x1920c7=new AdmZip();const _0x21bd9e=fs['readdirSync'](_0x354160,{'withFileTypes':!![]}),_0x42a599=[];_0x21bd9e['forEach'](_0xbd2274=>{const _0x338926=_0xff12bf;if(_0xbd2274[_0x338926(0x1bb)]()){const _0x182570=_0x1920c7[_0x338926(0x1c2)]()[_0x338926(0x1b1)](_0x338926(0x1e2));_0x182570[_0x338926(0x1b9)]>0x1e8480&&(_0x42a599[_0x338926(0x1c5)](_0x182570),_0x1920c7=new AdmZip()),_0x1920c7[_0x338926(0x1c4)](_0x354160+'/'+_0xbd2274[_0x338926(0x1d6)],_0xbd2274[_0x338926(0x1d6)]);}}),_0x42a599[_0xff12bf(0x1c5)](_0x1920c7['toBuffer']()[_0xff12bf(0x1b1)](_0xff12bf(0x1e2))),_0xba2430['log'](_0xff12bf(0x1be)),_0xae156d(_0x42a599);}catch(_0x4a7d19){_0xba2430[_0xff12bf(0x1c9)](_0xff12bf(0x1b7)),_0x1d6b5c(_0x4a7d19);}});}function deployData(_0x1c4a9d,_0x1b0d50,_0x37407e,_0x4a2e5c,_0x19ba07,_0x48b76f,_0x3374c8,_0x557531,_0x25a21d){return new Promise((_0x215f99,_0x1c10bc)=>{const _0x736300=a10_0x3a0b;try{_0x25a21d['log'](_0x736300(0x1d0)),_0x37407e=_0x37407e&&_0x37407e[_0x736300(0x1b9)]?_0x37407e[_0x736300(0x1de)]('__','')+'/':'';let _0x4ba171={'zipBuffer':'','pipelineId':_0x48b76f,'logId':_0x4a2e5c,'branchId':_0x557531,'pipelineNumber':_0x3374c8};const _0x413130=_0x1c4a9d+'/services/apexrest/'+_0x37407e+'unlocked-packages';let _0x18d62d=Promise[_0x736300(0x1ae)](),_0x153433=0x1;_0x19ba07[_0x736300(0x1cd)](_0x44b35d=>{const _0x2e58e4=_0x736300;_0x4ba171[_0x2e58e4(0x1c1)]=_0x44b35d,_0x4ba171[_0x2e58e4(0x1ca)]=_0x153433===_0x19ba07[_0x2e58e4(0x1b9)];const _0xa88d97={'methodType':constants[_0x2e58e4(0x1e7)],'body':JSON[_0x2e58e4(0x1b2)](_0x4ba171)};_0x18d62d=_0x18d62d[_0x2e58e4(0x1af)](()=>postDeploy(_0x413130,_0x1b0d50,_0x37407e,_0xa88d97)),_0x153433++;}),_0x18d62d[_0x736300(0x1af)](()=>{_0x25a21d['log']('End\x20Deploy\x20Data'),_0x215f99();})[_0x736300(0x1df)](_0x134659=>{const _0x27a74a=_0x736300;_0x25a21d['log'](_0x27a74a(0x1c0)),_0x1c10bc(_0x134659);});}catch(_0x4b03b2){_0x25a21d['log'](_0x736300(0x1c0)),_0x1c10bc(_0x4b03b2);}});}function handleNoComponents(_0x10cde7,_0x5e383e,_0x1e64e1,_0x1bd5f7,_0x6cc371,_0x5d0512,_0x49fa4a,_0x12cdfe){return new Promise((_0x29dc48,_0x42b85d)=>{const _0x53fc27=a10_0x3a0b;try{_0x12cdfe['log'](_0x53fc27(0x1ef)),_0x1e64e1=_0x1e64e1&&_0x1e64e1[_0x53fc27(0x1b9)]?_0x1e64e1[_0x53fc27(0x1de)]('__','')+'/':'';let _0xdd6a22={'message':_0x53fc27(0x1ea),'pipelineId':_0x6cc371,'logId':_0x1bd5f7,'branchId':_0x49fa4a,'pipelineNumber':_0x5d0512,'isStartDeploy':!![]};const _0x2d216a=_0x10cde7+_0x53fc27(0x1bc)+_0x1e64e1+_0x53fc27(0x1d5),_0x48d8cb={'methodType':constants[_0x53fc27(0x1ed)],'body':JSON['stringify'](_0xdd6a22)};postDeploy(_0x2d216a,_0x5e383e,_0x1e64e1,_0x48d8cb)[_0x53fc27(0x1af)](()=>{const _0x5ae22f=_0x53fc27;_0x12cdfe[_0x5ae22f(0x1c9)](_0x5ae22f(0x1ee)),_0x29dc48();})[_0x53fc27(0x1df)](_0x365539=>{const _0x41644e=_0x53fc27;_0x42b85d(_0x365539),_0x12cdfe[_0x41644e(0x1c9)]('Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.\x0a');});}catch(_0x5ee192){_0x12cdfe[_0x53fc27(0x1c9)](_0x53fc27(0x1c7)),_0x42b85d(_0x5ee192);}});}function postDeploy(_0x4ccf05,_0x204f83,_0x43adf5,_0x156f0e){return new Promise((_0x4290b8,_0x410424)=>{const _0x22f9fd=a10_0x3a0b;try{http[_0x22f9fd(0x1cb)](_0x4ccf05,_0x204f83,_0x43adf5,_0x156f0e)[_0x22f9fd(0x1af)](_0x2e6d61=>{_0x4290b8(_0x2e6d61);})[_0x22f9fd(0x1df)](_0x4ce1f3=>{const _0x4f9e50=_0x22f9fd;console[_0x4f9e50(0x1c9)](_0x4ce1f3),_0x410424(_0x4ce1f3);});}catch(_0x296214){_0x410424(_0x296214);}});}function callContinuePipelineVlocityDeploy(_0x30fa50,_0x17bd7e,_0x30be9b,_0x5c9b98,_0x247cf4,_0x192786,_0x3f2d5b,_0x3071cb,_0x46a010){return new Promise((_0x3bdf4b,_0x48eba6)=>{const _0x5d6beb=a10_0x3a0b;try{_0x30be9b=_0x30be9b&&_0x30be9b[_0x5d6beb(0x1b9)]?_0x30be9b[_0x5d6beb(0x1de)]('__','')+'/':'',_0x46a010['log'](_0x5d6beb(0x1eb));const _0x1bf07f={'pipelineId':_0x5c9b98,'pipelineNumber':_0x247cf4,'logId':_0x3071cb,'branchId':_0x3f2d5b,'pipelineKey':_0x192786},_0x1f7d48=_0x30fa50+'/services/apexrest/'+_0x30be9b+_0x5d6beb(0x1d5),_0x24332d={'methodType':constants[_0x5d6beb(0x1cf)],'body':JSON['stringify'](_0x1bf07f)};http[_0x5d6beb(0x1cb)](_0x1f7d48,_0x17bd7e,_0x30be9b,_0x24332d)['then'](_0x275385=>{const _0x4b81ab=_0x5d6beb;_0x46a010[_0x4b81ab(0x1c9)](_0x4b81ab(0x1e4)),_0x3bdf4b(_0x275385);})[_0x5d6beb(0x1df)](_0x1acbed=>{const _0x324850=_0x5d6beb;_0x46a010[_0x324850(0x1c9)](_0x324850(0x1b3)),_0x48eba6(_0x1acbed);});}catch(_0x4335ed){_0x48eba6(_0x4335ed);}});}module['exports']={'createJobFileRollback':createJobFileRollback,'retrieveData':retrieveData,'prepareDataForDeploy':prepareDataForDeploy,'deployData':deployData,'handleNoComponents':handleNoComponents,'callContinuePipelineVlocityDeploy':callContinuePipelineVlocityDeploy};