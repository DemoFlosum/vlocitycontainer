const a14_0x31348f=a14_0x1ecf;(function(_0x4c6aee,_0x26ca9c){const _0x44deac=a14_0x1ecf,_0x341152=_0x4c6aee();while(!![]){try{const _0x4f8cff=parseInt(_0x44deac(0xef))/0x1+parseInt(_0x44deac(0xdd))/0x2+parseInt(_0x44deac(0xc0))/0x3*(-parseInt(_0x44deac(0xf1))/0x4)+parseInt(_0x44deac(0xe0))/0x5*(parseInt(_0x44deac(0xc1))/0x6)+parseInt(_0x44deac(0xf7))/0x7+parseInt(_0x44deac(0xd6))/0x8+parseInt(_0x44deac(0xf6))/0x9*(parseInt(_0x44deac(0xd7))/0xa);if(_0x4f8cff===_0x26ca9c)break;else _0x341152['push'](_0x341152['shift']());}catch(_0x5779cd){_0x341152['push'](_0x341152['shift']());}}}(a14_0x1ca1,0xd7477));const fs=require('fs'),AdmZip=require('adm-zip'),childProcess=require(a14_0x31348f(0xe8)),constants=require(a14_0x31348f(0xe4)),http=require(a14_0x31348f(0xc5));function a14_0x1ca1(){const _0x3cf961=['JOB_FILE_NAME','-job','METHOD_BACKUP_LOG','167832XUKNHM','resolve','replace','193555fQXRxp','End\x20Prepare\x20Data\x20For\x20Deploy','unlocked-packages','toBuffer','../../../constants','log','/services/apexrest/','vlocity','../../../services/child-process','SOURCE_FOLDER','appendFileSync','Start\x20Prepare\x20Data\x20For\x20Deploy','Error\x20Prepare\x20Data\x20For\x20Deploy','length','slice','64418gvlUeA','join','8pFfpUV','Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','isDirectory','Start\x20Deploy\x20Data','readdirSync','4599ddmwpB','2776144NzRjXx','catch','Error\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','name','DATA_PACK_TYPES_QUERIES_MAP','Start\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','771105xjyicf','42WdReUG','Error\x20Retrieve\x20Data\x20','keys','push','../../../services/http','projectPath:\x20./','Start\x20Create\x20Job\x20File','then','Error\x20Deploy\x20Data','stringify','zipBuffer','addLocalFolder','METHOD_BACKUP_LOG_ERROR','post','End\x20Create\x20Job\x20File','base64','End\x20Retrieve\x20Data','exports','\x0aqueries:\x0a','Error\x20Create\x20Job\x20File','Start\x20Retrieve\x20Data','3212888gKgqyQ','3490wOLJck','forEach','Components\x20not\x20found!'];a14_0x1ca1=function(){return _0x3cf961;};return a14_0x1ca1();}function createJobFileRollback(_0x53704c,_0x9c307c,_0x4f4c8b,_0x1b87c0){return new Promise((_0xb0821e,_0x134c24)=>{const _0x39bd11=a14_0x1ecf;try{_0x1b87c0[_0x39bd11(0xe5)](_0x39bd11(0xc7));let _0x27c5d8=_0x39bd11(0xc6)+constants['UNZIP_CATALOG_NAME']+_0x39bd11(0xd3);Object[_0x39bd11(0xc3)](_0x9c307c)['forEach'](_0x44b174=>{_0x9c307c[_0x44b174]['forEach'](_0x51c08c=>{const _0x2ed267=a14_0x1ecf;constants[_0x2ed267(0xfb)][_0x44b174]['forEach'](_0x247f1c=>{_0x27c5d8+='\x20\x20-\x20VlocityDataPackType:\x20'+_0x44b174+'\x0a',_0x27c5d8+='\x20\x20\x20\x20query:\x20Select\x20Id\x20from\x20'+_0x247f1c+'\x20where\x20Name\x20LIKE\x20\x27%'+_0x51c08c+'%\x27\x0a';});});}),fs[_0x39bd11(0xea)](_0x53704c+'/'+constants[_0x39bd11(0xda)],_0x27c5d8),_0x1b87c0['log'](_0x39bd11(0xcf)),_0xb0821e();}catch(_0x5921d0){_0x1b87c0[_0x39bd11(0xe5)](_0x39bd11(0xd4)),_0x134c24(_0x5921d0);}});}function retrieveData(_0x5d70f1,_0x3bcf86,_0x220371,_0x5eb5e1){return new Promise((_0x10af45,_0x33f0dd)=>{const _0x57ea5a=a14_0x1ecf;try{_0x5eb5e1['log'](_0x57ea5a(0xd5));const _0x55543b=_0x57ea5a(0xe7),_0x3fcd1f=['-sf.accessToken',''+_0x220371,'-sf.instanceUrl',''+_0x3bcf86,_0x57ea5a(0xdb),''+constants['JOB_FILE_NAME'],'-autoRetryErrors','-maxDepth','0','packExport'];_0x5eb5e1[_0x57ea5a(0xe5)](_0x3fcd1f[_0x57ea5a(0xee)](0x2)[_0x57ea5a(0xf0)]('\x20'));const _0x4a261c={'cwd':''+_0x5d70f1,'maxBuffer':0x400*0x1f4};childProcess['callChildProcess'](_0x55543b,_0x3fcd1f,_0x5eb5e1,_0x4a261c)[_0x57ea5a(0xc8)](_0x3c616c=>{const _0x2c7333=_0x57ea5a;_0x5eb5e1[_0x2c7333(0xe5)](_0x2c7333(0xd1)),_0x10af45(_0x3c616c);})[_0x57ea5a(0xf8)](_0xee9083=>{const _0x547b17=_0x57ea5a;_0x5eb5e1['log'](_0x547b17(0xc2)+_0xee9083),_0x33f0dd(_0xee9083);});}catch(_0x4e6ca5){_0x33f0dd(_0x4e6ca5);}});}function prepareDataForDeploy(_0x4098ca,_0x1f253a){return new Promise((_0x123054,_0x45bc0e)=>{const _0x289c9b=a14_0x1ecf;try{_0x1f253a[_0x289c9b(0xe5)](_0x289c9b(0xeb));const _0x46f2be=_0x4098ca+'/'+constants[_0x289c9b(0xe9)];let _0x405665=new AdmZip();const _0x241f83=fs[_0x289c9b(0xf5)](_0x46f2be,{'withFileTypes':!![]}),_0x3e1ba7=[];_0x241f83[_0x289c9b(0xd8)](_0x10d7c2=>{const _0x340a6b=_0x289c9b;if(_0x10d7c2[_0x340a6b(0xf3)]()){const _0x1e8bfb=_0x405665[_0x340a6b(0xe3)]()['toString'](_0x340a6b(0xd0));_0x1e8bfb[_0x340a6b(0xed)]>0x1e8480&&(_0x3e1ba7[_0x340a6b(0xc4)](_0x1e8bfb),_0x405665=new AdmZip()),_0x405665[_0x340a6b(0xcc)](_0x46f2be+'/'+_0x10d7c2[_0x340a6b(0xfa)],_0x10d7c2[_0x340a6b(0xfa)]);}}),_0x3e1ba7[_0x289c9b(0xc4)](_0x405665[_0x289c9b(0xe3)]()['toString'](_0x289c9b(0xd0))),_0x1f253a[_0x289c9b(0xe5)](_0x289c9b(0xe1)),_0x123054(_0x3e1ba7);}catch(_0x3fad22){_0x1f253a[_0x289c9b(0xe5)](_0x289c9b(0xec)),_0x45bc0e(_0x3fad22);}});}function deployData(_0x26f6c0,_0xa80904,_0x515702,_0x135b52,_0x2040a7,_0x4f430c,_0x2f2489,_0x4a613d){return new Promise((_0x4d9d57,_0x2a1c35)=>{const _0x1f3f38=a14_0x1ecf;try{_0x4a613d[_0x1f3f38(0xe5)](_0x1f3f38(0xf4));const _0x121dcb={'zipBuffer':'','pipelineId':_0x2040a7,'logId':_0x515702,'branchId':_0x2f2489,'pipelineNumber':_0x4f430c};let _0x186b2e=Promise[_0x1f3f38(0xde)](),_0x15d425=0x1;_0x135b52[_0x1f3f38(0xd8)](_0x4c6895=>{const _0x4f595a=_0x1f3f38;_0x121dcb[_0x4f595a(0xcb)]=_0x4c6895,_0x121dcb['isStartDeploy']=_0x15d425===_0x135b52[_0x4f595a(0xed)];const _0x5eb885={'methodType':constants[_0x4f595a(0xdc)],'body':JSON[_0x4f595a(0xca)](_0x121dcb)};_0x186b2e=_0x186b2e['then'](()=>postDeploy(_0x26f6c0,_0xa80904,_0x5eb885)),_0x15d425++;}),_0x186b2e['then'](()=>{const _0x2c850f=_0x1f3f38;_0x4a613d[_0x2c850f(0xe5)]('End\x20Deploy\x20Data'),_0x4d9d57();})[_0x1f3f38(0xf8)](_0x31b2dd=>{const _0x243e34=_0x1f3f38;_0x4a613d['log'](_0x243e34(0xc9)),_0x2a1c35(_0x31b2dd);});}catch(_0x4883fd){_0x4a613d[_0x1f3f38(0xe5)](_0x1f3f38(0xc9)),_0x2a1c35(_0x4883fd);}});}function handleNoComponents(_0x56503e,_0xa14101,_0x2b7e93,_0x1242ef,_0x19a277,_0x35c4da,_0x39df2a,_0x551100){return new Promise((_0x1e3ae1,_0x5125fa)=>{const _0x47ea18=a14_0x1ecf;try{_0x551100['log'](_0x47ea18(0xbf)),_0x2b7e93=_0x2b7e93&&_0x2b7e93[_0x47ea18(0xed)]?_0x2b7e93[_0x47ea18(0xdf)]('__','')+'/':'';const _0x1ac1fa={'message':_0x47ea18(0xd9),'pipelineId':_0x19a277,'logId':_0x1242ef,'branchId':_0x39df2a,'pipelineNumber':_0x35c4da,'isStartDeploy':!![]},_0x505953=_0x56503e+_0x47ea18(0xe6)+_0x2b7e93+_0x47ea18(0xe2),_0x47a12b={'methodType':constants[_0x47ea18(0xcd)],'body':JSON[_0x47ea18(0xca)](_0x1ac1fa)};postDeploy(_0x505953,_0xa14101,_0x2b7e93,_0x47a12b)['then'](()=>{const _0x54a7af=_0x47ea18;_0x551100[_0x54a7af(0xe5)]('End\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.'),_0x1e3ae1();})[_0x47ea18(0xf8)](_0x2a0c8e=>{_0x5125fa(_0x2a0c8e),_0x551100['log']('Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.\x0a');});}catch(_0x52cbe0){_0x551100['log'](_0x47ea18(0xf2)),_0x5125fa(_0x52cbe0);}});}function postDeploy(_0x2a012f,_0x7ece52,_0x31333a){return new Promise((_0x2aeb56,_0x58d5a1)=>{const _0x1c3b0c=a14_0x1ecf;try{http['post'](_0x2a012f,_0x7ece52,_0x31333a)[_0x1c3b0c(0xc8)](_0x4849c7=>{_0x2aeb56(_0x4849c7);})[_0x1c3b0c(0xf8)](_0x324d35=>{console['log'](_0x324d35),_0x58d5a1(_0x324d35);});}catch(_0x1a0dea){_0x58d5a1(_0x1a0dea);}});}function callContinuePipelineVlocityDeploy(_0x56d567,_0x4567aa,_0x3c1180,_0x3d88bf,_0x3df660,_0x487bb0,_0x4bbf83,_0x1807f2){return new Promise((_0x2ab50b,_0x1b7f85)=>{const _0x26698b=a14_0x1ecf;try{_0x4567aa=_0x4567aa&&_0x4567aa['length']?_0x4567aa[_0x26698b(0xdf)]('__','')+'/':'',_0x1807f2[_0x26698b(0xe5)]('Start\x20Continue\x20Vlocity\x20Pipeline\x20Deploy');const _0x145670={'pipelineId':_0x3c1180,'pipelineNumber':_0x3d88bf,'logId':_0x4bbf83,'branchId':_0x487bb0,'pipelineKey':_0x3df660},_0x18c1a0={'methodType':constants['METHOD_NEXT_VLOCITY_CONTINUE_DEPLOY_STEP'],'body':JSON['stringify'](_0x145670)};http[_0x26698b(0xce)](_0x56d567,_0x4567aa,_0x18c1a0)[_0x26698b(0xc8)](_0x4e2120=>{const _0x1d13d2=_0x26698b;_0x1807f2[_0x1d13d2(0xe5)]('End\x20Continue\x20Vlocity\x20Pipeline\x20Deploy'),_0x2ab50b(_0x4e2120);})[_0x26698b(0xf8)](_0x330d7d=>{const _0x52d02e=_0x26698b;_0x1807f2['log'](_0x52d02e(0xf9)),_0x1b7f85(_0x330d7d);});}catch(_0x297480){_0x1b7f85(_0x297480);}});}function a14_0x1ecf(_0x139555,_0xea6a5e){const _0x1ca12b=a14_0x1ca1();return a14_0x1ecf=function(_0x1ecf3d,_0x30c3c6){_0x1ecf3d=_0x1ecf3d-0xbf;let _0x2f1bdc=_0x1ca12b[_0x1ecf3d];return _0x2f1bdc;},a14_0x1ecf(_0x139555,_0xea6a5e);}module[a14_0x31348f(0xd2)]={'createJobFileRollback':createJobFileRollback,'retrieveData':retrieveData,'prepareDataForDeploy':prepareDataForDeploy,'deployData':deployData,'handleNoComponents':handleNoComponents,'callContinuePipelineVlocityDeploy':callContinuePipelineVlocityDeploy};