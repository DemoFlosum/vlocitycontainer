const a28_0x25fb31=a28_0x110d;(function(_0x1f213c,_0x5c3bdb){const _0x4e4aa7=a28_0x110d,_0x16a62e=_0x1f213c();while(!![]){try{const _0x2627a6=-parseInt(_0x4e4aa7(0x218))/0x1+parseInt(_0x4e4aa7(0x1fd))/0x2+-parseInt(_0x4e4aa7(0x221))/0x3*(parseInt(_0x4e4aa7(0x1f2))/0x4)+-parseInt(_0x4e4aa7(0x1ff))/0x5*(parseInt(_0x4e4aa7(0x1e2))/0x6)+parseInt(_0x4e4aa7(0x226))/0x7*(-parseInt(_0x4e4aa7(0x213))/0x8)+parseInt(_0x4e4aa7(0x21e))/0x9+parseInt(_0x4e4aa7(0x1d5))/0xa;if(_0x2627a6===_0x5c3bdb)break;else _0x16a62e['push'](_0x16a62e['shift']());}catch(_0x393a4c){_0x16a62e['push'](_0x16a62e['shift']());}}}(a28_0x24c6,0xcd3e9));const path=require(a28_0x25fb31(0x1e0)),fs=require('fs'),fse=require(a28_0x25fb31(0x1ec)),AdmZip=require(a28_0x25fb31(0x20a)),constants=require('../../../constants'),http=require(a28_0x25fb31(0x1ed));function query(_0x292ba8,_0x5c42d5,_0x1d3da2){return new Promise((_0x27a165,_0x1e64ca)=>{const _0x36c2a3=a28_0x110d;try{_0x1d3da2['log']('Start\x20Query'),_0x292ba8[_0x36c2a3(0x219)](_0x5c42d5,(_0x588ce3,_0x4f9d0c)=>{const _0xb2e397=_0x36c2a3;_0x588ce3?(_0x1d3da2[_0xb2e397(0x203)](_0xb2e397(0x1ea)+_0x588ce3),_0x1e64ca(_0x588ce3)):(_0x1d3da2[_0xb2e397(0x203)](_0xb2e397(0x216)),_0x27a165(_0x4f9d0c[_0xb2e397(0x1d8)][_0xb2e397(0x201)](_0x1d55a0=>_0x1d55a0['vlocity_cmt__Type__c']&&_0x1d55a0[_0xb2e397(0x1d9)]&&_0x1d55a0[_0xb2e397(0x22a)])[_0xb2e397(0x1cf)](({vlocity_cmt__Type__c:_0x421048,vlocity_cmt__SubType__c:_0x34e738,vlocity_cmt__Language__c:_0x11ccc2})=>{return''+_0x421048+_0x34e738+_0x11ccc2;})));});}catch(_0x24143f){_0x1e64ca(_0x24143f),_0x1d3da2['log'](_0x36c2a3(0x1ea)+_0x24143f);}});}function fetchOmniOutContentList(_0x4b867a,_0x49f8f9,_0x2775c0){return new Promise((_0x2882a4,_0x288c93)=>{const _0x69e66c=a28_0x110d;try{_0x2775c0[_0x69e66c(0x203)](_0x69e66c(0x1f1));const _0x85717b=[];let _0x5e479a=0x1,_0x10a936=Promise[_0x69e66c(0x214)]();_0x49f8f9[_0x69e66c(0x206)](_0x86528b=>{const _0x16d52=_0x69e66c;_0x10a936=_0x10a936[_0x16d52(0x1e6)](()=>fetchOmniOutContent(_0x4b867a,_0x86528b))[_0x16d52(0x1e6)](_0x341334=>{const _0x359901=_0x16d52;_0x341334&&_0x341334[_0x359901(0x1e9)]&&_0x341334[_0x359901(0x1e9)][_0x359901(0x1df)]===0x2&&(_0x341334['compositeResponse'][0x0][_0x359901(0x1d1)]===0xc8&&_0x85717b[_0x359901(0x1cd)]({'lwcComponentList':_0x341334['compositeResponse'][0x1][_0x359901(0x224)][_0x359901(0x1d8)],'name':_0x341334[_0x359901(0x1e9)][0x0][_0x359901(0x224)]['records'][0x0]['DeveloperName']})),_0x2775c0[_0x359901(0x203)](_0x359901(0x1e7)+_0x5e479a++ +_0x359901(0x1f9)+_0x85717b[_0x359901(0x1df)]+_0x359901(0x1d4)+_0x49f8f9['length']);});}),_0x10a936[_0x69e66c(0x1e6)](()=>{const _0x220f22=_0x69e66c;_0x2775c0[_0x220f22(0x203)](_0x220f22(0x207)),_0x2882a4(_0x85717b);})[_0x69e66c(0x1e1)](_0x29eb02=>{const _0x400f8b=_0x69e66c;_0x2775c0[_0x400f8b(0x203)]('Error\x20Fetch\x20OmniOut\x20Content\x20List\x20'+_0x29eb02),_0x288c93(_0x29eb02);});}catch(_0x36c51f){_0x288c93(_0x36c51f),_0x2775c0[_0x69e66c(0x203)]('Error\x20Fetch\x20OmniOut\x20Content\x20List\x20'+_0x36c51f);}});}function fetchOmniOutContent(_0x1d1a8b,_0x2179e4){const _0xca3c74=a28_0x25fb31;_0x2179e4=_0x2179e4[_0xca3c74(0x211)]('-','')[_0xca3c74(0x211)](_0xca3c74(0x1e8),'');const _0x2d8001={'allOrNone':!![],'compositeRequest':[{'method':_0xca3c74(0x212),'referenceId':_0xca3c74(0x1f7),'url':_0xca3c74(0x227)+_0x2179e4+'\x27'},{'method':_0xca3c74(0x212),'referenceId':_0xca3c74(0x20e),'url':_0xca3c74(0x21a)}]},_0x366499=_0x1d1a8b[_0xca3c74(0x225)],_0x1bbad3={'method':_0xca3c74(0x1eb),'url':_0x366499+'/services/data/v50.0/tooling/composite','body':JSON[_0xca3c74(0x1ee)](_0x2d8001),'headers':{'Content-Type':'application/json'}};return _0x1d1a8b[_0xca3c74(0x1fc)](_0x1bbad3);}function createLwcFiles(_0x403a7b,_0x3ce681,_0x5d2554,_0x53143b){return new Promise((_0x59922f,_0x9b46ee)=>{const _0xa93651=a28_0x110d;try{_0x53143b[_0xa93651(0x203)]('Start\x20Create\x20Lwc\x20Files');let _0x2ac08e=[],_0x5885a3=[],_0x1075a6=0x0,_0x43b83e=new AdmZip();_0x3ce681[_0xa93651(0x206)](_0x20f8b7=>{const _0x35ada2=_0xa93651;_0x5885a3['push']({'apiName':_0x20f8b7[_0x35ada2(0x20b)],'componentType':_0x35ada2(0x209),'label':'lwc/'+_0x20f8b7[_0x35ada2(0x20b)]}),_0x20f8b7['lwcComponentList'][_0x35ada2(0x206)](_0x308805=>{const _0x4e9150=_0x35ada2;_0x308805[_0x4e9150(0x21c)]!==_0x4e9150(0x1f8)&&(_0x1075a6+=_0x308805['Source'][_0x4e9150(0x1df)],_0x1075a6<constants[_0x4e9150(0x1f0)]?_0x43b83e[_0x4e9150(0x223)](''+_0x308805[_0x4e9150(0x1d2)],Buffer[_0x4e9150(0x1e4)](_0x308805[_0x4e9150(0x21c)][_0x4e9150(0x211)](new RegExp('vlocity_cmt','g'),'c'))):(_0x2ac08e[_0x4e9150(0x1cd)]({'snapshotId':_0x5d2554,'typeList':[{'type':_0x4e9150(0x209),'zip':_0x43b83e[_0x4e9150(0x21f)]()[_0x4e9150(0x215)]('base64'),'componentList':_0x5885a3}]}),_0x5885a3=[],_0x1075a6=0x0,_0x43b83e=new AdmZip()));}),delete _0x20f8b7[_0x35ada2(0x20c)];}),_0x5885a3[_0xa93651(0x1df)]&&_0x2ac08e[_0xa93651(0x1cd)]({'snapshotId':_0x5d2554,'typeList':[{'type':_0xa93651(0x209),'zip':_0x43b83e[_0xa93651(0x21f)]()[_0xa93651(0x215)]('base64'),'componentList':_0x5885a3}]}),_0x53143b[_0xa93651(0x203)](_0xa93651(0x204)),_0x59922f(_0x2ac08e);}catch(_0x2de081){_0x53143b[_0xa93651(0x203)](_0xa93651(0x20d)+_0x2de081),_0x9b46ee(_0x2de081);}});}function sendComponents(_0x3b9729,_0x4d3d3b,_0x51f39b,_0x8824e2,_0x5aa2a3){return new Promise((_0x586346,_0x4afef2)=>{const _0x3cc24b=a28_0x110d;try{_0x5aa2a3[_0x3cc24b(0x203)](_0x3cc24b(0x1d3));let _0x149aeb=Promise['resolve']();_0x8824e2[_0x3cc24b(0x206)](_0x41924a=>{const _0x1a90af=_0x3cc24b;_0x149aeb=_0x149aeb[_0x1a90af(0x1e6)](()=>callSentComponents(_0x3b9729,_0x4d3d3b,_0x51f39b,_0x41924a));}),_0x149aeb['then'](()=>{const _0x186845=_0x3cc24b;_0x5aa2a3[_0x186845(0x203)](_0x186845(0x1de)),_0x586346();})[_0x3cc24b(0x1e1)](_0x16afc1=>{_0x5aa2a3['log']('Error\x20Send\x20Components\x20'+_0x16afc1),_0x4afef2(_0x16afc1);});}catch(_0x184587){_0x5aa2a3[_0x3cc24b(0x203)](_0x3cc24b(0x21b)+_0x184587),_0x4afef2(_0x184587);}});}function callSentComponents(_0xc0378a,_0x5ca223,_0x43f030,_0x5b0090){return new Promise((_0x323124,_0x24d7ea)=>{const _0x1c8d34=a28_0x110d;try{const _0x224c78={'methodType':constants[_0x1c8d34(0x1e5)],'body':JSON[_0x1c8d34(0x1ee)](_0x5b0090)};_0x43f030=_0x43f030?_0x43f030['replace']('__','')+'/':'';const _0x4b58b9=_0xc0378a+_0x1c8d34(0x1d0)+_0x43f030[_0x1c8d34(0x211)]('__','')+_0x1c8d34(0x1dc);http[_0x1c8d34(0x228)](_0x4b58b9,_0x5ca223,_0x43f030[_0x1c8d34(0x211)]('__',''),JSON['stringify'](_0x224c78))[_0x1c8d34(0x1e6)](()=>{_0x323124();})[_0x1c8d34(0x1e1)](_0x24d7ea);}catch(_0x6fd8f7){_0x24d7ea(_0x6fd8f7);}});}function completeDeployment(_0x20debb,_0xfe2d8c,_0x4e1bd8,_0x4b23bb,_0x21f31c,_0x2f6a63,_0x2981af,_0x11338e,_0x1fbef9=![]){return new Promise((_0x234008,_0x1434bb)=>{const _0x3b9411=a28_0x110d;try{Promise[_0x3b9411(0x214)]()[_0x3b9411(0x1e6)](()=>updateAttachmentLog(_0x20debb,_0xfe2d8c,_0x2f6a63,_0x11338e,_0x1fbef9,!![]))[_0x3b9411(0x1e6)](_0x27fc04=>{const _0x17bda4=_0x3b9411;return _0x1fbef9=_0x27fc04,http[_0x17bda4(0x210)](_0xfe2d8c,_0x21f31c,_0x4e1bd8,_0x2981af,_0x11338e,_0x27fc04);})['then'](()=>callUpdateSnapshot(_0xfe2d8c,_0x4b23bb,_0x4e1bd8,_0x1fbef9,_0x11338e));}catch(_0x15ec61){_0x1434bb(_0x15ec61);}});}function a28_0x24c6(){const _0x371984=[',\x20retrieved\x20','type','lwcName','request','27806szJQKq','children','170RexPZs','sobject','filter','exports','log','End\x20Create\x20Lwc\x20Files','Process\x20Get\x20Dependency,\x20processed\x20','forEach','End\x20Fetch\x20OmniOut\x20Content\x20List\x20','update','LightningComponentBundle','adm-zip','name','lwcComponentList','Error\x20Create\x20Lwc\x20Files\x20','bundleResources','End\x20Extract\x20LWC\x20Dependencies','callUpdateLog','replace','GET','3112HONHlA','resolve','toString','End\x20Query','Start\x20Extract\x20LWC\x20Dependencies','697632AlOSgu','query','/services/data/v48.0/tooling/query?q=SELECT+Id,FilePath,Format,Source+FROM+LightningComponentResource+WHERE+LightningComponentBundleId=\x27@{bundleInfo.records[0].Id}\x27','Error\x20Send\x20Components\x20','Source','Start\x20Update\x20Attachment\x20Log','14491782FUEajW','toBuffer','eleArray','3309GDseOX','Start\x20Get\x20Dependency\x20List\x20','addFile','body','instanceUrl','13237GMpMxT','/services/data/v48.0/tooling/query?q=SELECT+Id,DeveloperName,Description+FROM+LightningComponentBundle+WHERE+DeveloperName=\x27','post','Vlocity\x20BuildJSONWithPrefill','vlocity_cmt__Language__c','push','Is_Completed__c','map','/services/apexrest/','httpStatusCode','FilePath','Start\x20Send\x20Components',',\x20all\x20','19128010ovxARj','Error\x20Update\x20Attachment\x20Log\x20','parse','records','vlocity_cmt__SubType__c','callUpdateAttachmentLog','elementTypeToLwcTemplateMapping','unlocked-packages','Error\x20Extract\x20LWC\x20Dependencies\x20','End\x20Send\x20Components','length','path','catch','215484WLhobo','getAttachmentBody','from','METHOD_TYPE_ADD_COMPONENTS_TO_SNAPSHOT','then','Process\x20Fetch\x20OmniOut\x20Content,\x20processed\x20','vlocity_cmt__','compositeResponse','Error\x20Query\x20','POST','fs-extra','../../../services/http','stringify','Error\x20Update\x20Snapshot','MAX_SIZE_UNZIP_ATTACHMENT','Start\x20Fetch\x20OmniOut\x20Content\x20List\x20','152PUXWga','lwcComponentOverride','propSetMap','vlocity_cmt__Type__c','entries','bundleInfo','(hidden)'];a28_0x24c6=function(){return _0x371984;};return a28_0x24c6();}function updateAttachmentLog(_0x4684b0,_0xa2cd8b,_0x370f46,_0x58627d,_0x5c653e,_0x5793b7=![]){return new Promise(_0x199af5=>{const _0x2d1038=a28_0x110d;try{_0x58627d[_0x2d1038(0x203)](_0x2d1038(0x21d)),Promise['resolve']()[_0x2d1038(0x1e6)](()=>http[_0x2d1038(0x1e3)](_0xa2cd8b,_0x370f46,_0x58627d))[_0x2d1038(0x1e6)](_0x15cddb=>{const _0x4f63db=_0x2d1038;return http[_0x4f63db(0x1da)](_0xa2cd8b,_0x370f46,_0x15cddb,_0x58627d,_0x5c653e);})[_0x2d1038(0x1e6)](()=>_0x199af5(_0x5c653e))[_0x2d1038(0x1e1)](()=>_0x199af5(_0x5c653e));}catch(_0x2a99c0){_0x58627d[_0x2d1038(0x203)](_0x2d1038(0x1d6)+_0x2a99c0),_0x199af5(_0x5c653e);}});}function a28_0x110d(_0x298ebe,_0x16eab7){const _0x24c6a4=a28_0x24c6();return a28_0x110d=function(_0x110da6,_0x357f03){_0x110da6=_0x110da6-0x1cd;let _0x21fcd5=_0x24c6a4[_0x110da6];return _0x21fcd5;},a28_0x110d(_0x298ebe,_0x16eab7);}function callUpdateSnapshot(_0x871874,_0x3191b0,_0x29f4cc,_0x1bcb36,_0x5ef563){return new Promise((_0x92de67,_0x1594d2)=>{const _0xae8be=a28_0x110d;try{_0x5ef563['log']('Start\x20Update\x20Snapshot');const _0x33e454={'Id':_0x3191b0,[_0x29f4cc+_0xae8be(0x1ce)]:!![],[_0x29f4cc+'Is_Error__c']:_0x1bcb36};_0x871874[_0xae8be(0x200)](_0x29f4cc+'Snapshot__c')[_0xae8be(0x208)](_0x33e454)[_0xae8be(0x1e6)](()=>{_0x5ef563['log']('End\x20Update\x20Snapshot'),_0x92de67();})[_0xae8be(0x1e1)](_0x3c128a=>{const _0x212a77=_0xae8be;_0x5ef563[_0x212a77(0x203)](_0x212a77(0x1ef)),_0x1594d2(_0x3c128a);});}catch(_0x3056f9){_0x5ef563['log'](_0xae8be(0x1ef)),_0x1594d2(_0x3056f9);}});}function getDependencyList(_0x24f776,_0x3a7944,_0x2775bd){return new Promise((_0x38b56a,_0x268976)=>{const _0x3059f2=a28_0x110d;try{_0x2775bd[_0x3059f2(0x203)](_0x3059f2(0x222));const _0x42c438=[];let _0x2055b4=Promise['resolve']();_0x3a7944[_0x3059f2(0x206)](_0x4d9939=>{const _0x4996fc=_0x3059f2;_0x2055b4=_0x2055b4[_0x4996fc(0x1e6)](()=>getPrefilledJSON(_0x24f776,_0x4d9939,_0x2775bd))[_0x4996fc(0x1e6)](_0x5485f3=>{const _0x528585=_0x4996fc;_0x42c438['push'](_0x5485f3),_0x2775bd[_0x528585(0x203)](_0x528585(0x205)+_0x42c438[_0x528585(0x1df)]+'\x20from\x20'+_0x3a7944[_0x528585(0x1df)]);});}),_0x2055b4[_0x3059f2(0x1e6)](()=>{const _0x232419=_0x3059f2;_0x2775bd[_0x232419(0x203)]('End\x20Get\x20Dependency\x20List\x20'),_0x38b56a(_0x42c438);})[_0x3059f2(0x1e1)](_0x9abb51=>{const _0x45eab1=_0x3059f2;_0x2775bd[_0x45eab1(0x203)]('Error\x20Get\x20Dependency\x20List\x20'+_0x9abb51),_0x268976(_0x9abb51);});}catch(_0x240dcd){_0x2775bd[_0x3059f2(0x203)]('Error\x20Get\x20Dependency\x20List\x20'+_0x240dcd),_0x268976(_0x240dcd);}});}function getPrefilledJSON(_0x39599b,_0x4f9f0b,_0x5b08b7){return new Promise((_0x4c651e,_0x530c9b)=>{const _0x201710=a28_0x110d;try{const _0x522fb3={'sClassName':_0x201710(0x229),'sType':_0x4f9f0b[_0x201710(0x1f5)],'sSubType':_0x4f9f0b[_0x201710(0x1d9)],'sLang':_0x4f9f0b[_0x201710(0x22a)]};_0x39599b['apex'][_0x201710(0x228)]('/vlocity_cmt/v1/GenericInvoke/',_0x522fb3,(_0x47c2e5,_0x5ea8d7)=>{const _0x5a4b1f=_0x201710;_0x47c2e5?(_0x5b08b7[_0x5a4b1f(0x203)]('Error\x20getPrefilledJSON\x20'+_0x47c2e5),_0x530c9b(_0x47c2e5)):_0x4c651e(JSON[_0x5a4b1f(0x1d7)](_0x5ea8d7));});}catch(_0x4608a8){_0x530c9b(_0x4608a8),_0x5b08b7[_0x201710(0x203)]('Error\x20Get\x20Prefilled\x20JSON\x20'+_0x4608a8);}});}function extractLwcDependencies(_0x5dedc2,_0x2db976){return new Promise((_0x5e970c,_0x21cff7)=>{const _0x3c0f42=a28_0x110d;try{_0x2db976[_0x3c0f42(0x203)](_0x3c0f42(0x217));let _0xac6abb=[];_0x5dedc2['forEach'](_0x1ff931=>{const _0x57729f=_0x3c0f42;_0x1ff931[_0x57729f(0x1fe)]&&_0x1ff931[_0x57729f(0x1fe)][_0x57729f(0x1df)]>0x0&&_0x1ff931[_0x57729f(0x1fe)][_0x57729f(0x206)](_0x54cfba=>{const _0x116609=_0x57729f;_0x54cfba['children']&&_0x54cfba[_0x116609(0x1fe)][_0x116609(0x1df)]>0x0&&_0x54cfba[_0x116609(0x1fe)][_0x116609(0x206)](_0x26ffaf=>{const _0x552e9c=_0x116609;_0x26ffaf[_0x552e9c(0x220)][0x0][_0x552e9c(0x1fa)]==='Custom\x20Lightning\x20Web\x20Component'&&_0xac6abb[_0x552e9c(0x1cd)](_0x26ffaf[_0x552e9c(0x220)][0x0]['propSetMap'][_0x552e9c(0x1fb)]);});});if(_0x1ff931[_0x57729f(0x1f4)]&&_0x1ff931[_0x57729f(0x1f4)][_0x57729f(0x1db)])for(const [_0x214a9d,_0x22a3ea]of Object[_0x57729f(0x1f6)](_0x1ff931[_0x57729f(0x1f4)][_0x57729f(0x1db)])){_0xac6abb[_0x57729f(0x1cd)](_0x22a3ea);}_0x1ff931['children']&&_0x1ff931[_0x57729f(0x1fe)][_0x57729f(0x1df)]>0x0&&_0x1ff931[_0x57729f(0x1fe)][_0x57729f(0x206)](_0x496290=>{const _0x211391=_0x57729f;_0x496290[_0x211391(0x1f4)]&&_0x496290[_0x211391(0x1f4)]['lwcComponentOverride']&&_0xac6abb[_0x211391(0x1cd)](_0x496290['propSetMap'][_0x211391(0x1f3)]),_0x496290[_0x211391(0x1fe)]&&_0x496290['children'][_0x211391(0x1df)]>0x0&&_0x496290[_0x211391(0x1fe)][_0x211391(0x206)](_0x243251=>{const _0x2bd147=_0x211391;_0x243251[_0x2bd147(0x220)][0x0]['propSetMap']&&_0x243251[_0x2bd147(0x220)][0x0][_0x2bd147(0x1f4)][_0x2bd147(0x1f3)]&&_0xac6abb['push'](_0x243251['eleArray'][0x0]['propSetMap'][_0x2bd147(0x1f3)]);});});}),_0x2db976[_0x3c0f42(0x203)](_0x3c0f42(0x20f)),_0x5e970c(_0xac6abb);}catch(_0x1541e8){_0x2db976[_0x3c0f42(0x203)](_0x3c0f42(0x1dd)+_0x1541e8),_0x21cff7(_0x1541e8);}});}module[a28_0x25fb31(0x202)]={'query':query,'getDependencyList':getDependencyList,'extractLwcDependencies':extractLwcDependencies,'fetchOmniOutContentList':fetchOmniOutContentList,'createLwcFiles':createLwcFiles,'sendComponents':sendComponents,'completeDeployment':completeDeployment};