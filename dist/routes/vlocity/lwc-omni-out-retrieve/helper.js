const a26_0x5173a2=a26_0x5b84;(function(_0x2119bf,_0x499729){const _0x5c02cb=a26_0x5b84,_0x5b30aa=_0x2119bf();while(!![]){try{const _0xc1621f=parseInt(_0x5c02cb(0x9d))/0x1*(parseInt(_0x5c02cb(0x90))/0x2)+parseInt(_0x5c02cb(0xaa))/0x3*(parseInt(_0x5c02cb(0xc7))/0x4)+-parseInt(_0x5c02cb(0xd0))/0x5+parseInt(_0x5c02cb(0xb3))/0x6*(parseInt(_0x5c02cb(0xcd))/0x7)+parseInt(_0x5c02cb(0xbf))/0x8*(-parseInt(_0x5c02cb(0x89))/0x9)+-parseInt(_0x5c02cb(0xa7))/0xa+parseInt(_0x5c02cb(0x72))/0xb;if(_0xc1621f===_0x499729)break;else _0x5b30aa['push'](_0x5b30aa['shift']());}catch(_0x16ca97){_0x5b30aa['push'](_0x5b30aa['shift']());}}}(a26_0x3d2b,0x7cb4b));const path=require(a26_0x5173a2(0xb4)),fs=require('fs'),fse=require(a26_0x5173a2(0x8c)),AdmZip=require(a26_0x5173a2(0x96)),constants=require('../../../constants'),http=require('../../../services/http');function query(_0x2f2d21,_0x1bb947,_0x365e31){return new Promise((_0x1f1415,_0x333710)=>{const _0x4dbc70=a26_0x5b84;try{_0x365e31[_0x4dbc70(0xc6)](_0x4dbc70(0x87)),_0x2f2d21[_0x4dbc70(0xaf)](_0x1bb947,(_0x9a49d2,_0x53d40e)=>{const _0x5ac60f=_0x4dbc70;_0x9a49d2?(_0x365e31[_0x5ac60f(0xc6)]('Error\x20Query\x20'+_0x9a49d2),_0x333710(_0x9a49d2)):(_0x365e31[_0x5ac60f(0xc6)]('End\x20Query'),_0x1f1415(_0x53d40e[_0x5ac60f(0x71)]['filter'](_0x344804=>_0x344804[_0x5ac60f(0x92)]&&_0x344804[_0x5ac60f(0x79)]&&_0x344804['vlocity_cmt__Language__c'])['map'](({vlocity_cmt__Type__c:_0x3514db,vlocity_cmt__SubType__c:_0x2112ab,vlocity_cmt__Language__c:_0x45cef1})=>{return''+_0x3514db+_0x2112ab+_0x45cef1;})));});}catch(_0x54b98b){_0x333710(_0x54b98b),_0x365e31[_0x4dbc70(0xc6)](_0x4dbc70(0xb5)+_0x54b98b);}});}function fetchOmniOutContentList(_0x112462,_0x5e4f39,_0x4845ba){return new Promise((_0x57a118,_0x5135b7)=>{const _0x3ac38c=a26_0x5b84;try{_0x4845ba[_0x3ac38c(0xc6)](_0x3ac38c(0x91));const _0x5aa0b3=[];let _0x34f9da=0x1,_0x163391=Promise[_0x3ac38c(0xbb)]();_0x5e4f39['forEach'](_0x50b73b=>{const _0x5aafd5=_0x3ac38c;_0x163391=_0x163391[_0x5aafd5(0xc8)](()=>fetchOmniOutContent(_0x112462,_0x50b73b))[_0x5aafd5(0xc8)](_0x48bf7f=>{const _0x4e2123=_0x5aafd5;_0x48bf7f&&_0x48bf7f[_0x4e2123(0x85)]&&_0x48bf7f[_0x4e2123(0x85)][_0x4e2123(0x7c)]===0x2&&(_0x48bf7f[_0x4e2123(0x85)][0x0][_0x4e2123(0xa5)]===0xc8&&_0x5aa0b3[_0x4e2123(0xcf)]({'lwcComponentList':_0x48bf7f['compositeResponse'][0x1][_0x4e2123(0xc9)][_0x4e2123(0x71)],'name':_0x48bf7f[_0x4e2123(0x85)][0x0][_0x4e2123(0xc9)]['records'][0x0][_0x4e2123(0xbd)]})),_0x4845ba[_0x4e2123(0xc6)](_0x4e2123(0xb1)+_0x34f9da++ +_0x4e2123(0xcc)+_0x5aa0b3[_0x4e2123(0x7c)]+_0x4e2123(0xc0)+_0x5e4f39[_0x4e2123(0x7c)]);});}),_0x163391[_0x3ac38c(0xc8)](()=>{const _0x4c42f7=_0x3ac38c;_0x4845ba['log'](_0x4c42f7(0x73)),_0x57a118(_0x5aa0b3);})[_0x3ac38c(0xb7)](_0x1adafa=>{const _0x35e22f=_0x3ac38c;_0x4845ba['log'](_0x35e22f(0x77)+_0x1adafa),_0x5135b7(_0x1adafa);});}catch(_0x1c97bd){_0x5135b7(_0x1c97bd),_0x4845ba[_0x3ac38c(0xc6)](_0x3ac38c(0x77)+_0x1c97bd);}});}function fetchOmniOutContent(_0x8f7e9b,_0x37b005){const _0x17d1b6=a26_0x5173a2;_0x37b005=_0x37b005[_0x17d1b6(0x7a)]('-','')[_0x17d1b6(0x7a)](_0x17d1b6(0xa2),'');const _0x5533e8={'allOrNone':!![],'compositeRequest':[{'method':_0x17d1b6(0x7e),'referenceId':'bundleInfo','url':_0x17d1b6(0x9c)+_0x37b005+'\x27'},{'method':_0x17d1b6(0x7e),'referenceId':_0x17d1b6(0xc1),'url':_0x17d1b6(0xc4)}]},_0x2f3d08=_0x8f7e9b[_0x17d1b6(0xc5)],_0x7ec0ad={'method':_0x17d1b6(0x8d),'url':_0x2f3d08+_0x17d1b6(0x86),'body':JSON[_0x17d1b6(0xa3)](_0x5533e8),'headers':{'Content-Type':_0x17d1b6(0x6e)}};return _0x8f7e9b[_0x17d1b6(0x83)](_0x7ec0ad);}function createLwcFiles(_0xb533a7,_0x465df1,_0x1bfea6,_0x617051){return new Promise((_0x304d0e,_0x3a99f9)=>{const _0x14b9f9=a26_0x5b84;try{_0x617051[_0x14b9f9(0xc6)](_0x14b9f9(0x8a));let _0x413624=[],_0x3b9ca1=[],_0x55e9d6=0x0,_0x182b30=new AdmZip();_0x465df1[_0x14b9f9(0xad)](_0x407d5b=>{const _0x323d44=_0x14b9f9;_0x3b9ca1['push']({'apiName':_0x407d5b[_0x323d44(0x9b)],'componentType':_0x323d44(0xd3),'label':_0x323d44(0xa8)+_0x407d5b['name']}),_0x407d5b['lwcComponentList'][_0x323d44(0xad)](_0x528760=>{const _0x4ac88e=_0x323d44;_0x528760[_0x4ac88e(0x80)]!==_0x4ac88e(0xac)&&(_0x55e9d6+=_0x528760['Source']['length'],_0x55e9d6<constants[_0x4ac88e(0xb0)]?_0x182b30['addFile'](''+_0x528760[_0x4ac88e(0x9a)],Buffer[_0x4ac88e(0x94)](_0x528760['Source'][_0x4ac88e(0x7a)](new RegExp(_0x4ac88e(0x70),'g'),'c'))):(_0x413624[_0x4ac88e(0xcf)]({'snapshotId':_0x1bfea6,'typeList':[{'type':_0x4ac88e(0xd3),'zip':_0x182b30[_0x4ac88e(0xa4)]()[_0x4ac88e(0xd1)](_0x4ac88e(0xa9)),'componentList':_0x3b9ca1}]}),_0x3b9ca1=[],_0x55e9d6=0x0,_0x182b30=new AdmZip()));}),delete _0x407d5b[_0x323d44(0xab)];}),_0x3b9ca1[_0x14b9f9(0x7c)]&&_0x413624[_0x14b9f9(0xcf)]({'snapshotId':_0x1bfea6,'typeList':[{'type':_0x14b9f9(0xd3),'zip':_0x182b30['toBuffer']()[_0x14b9f9(0xd1)](_0x14b9f9(0xa9)),'componentList':_0x3b9ca1}]}),_0x617051['log'](_0x14b9f9(0xc2)),_0x304d0e(_0x413624);}catch(_0x286041){_0x617051[_0x14b9f9(0xc6)](_0x14b9f9(0x98)+_0x286041),_0x3a99f9(_0x286041);}});}function a26_0x5b84(_0x17bc1e,_0x40f756){const _0x3d2b0d=a26_0x3d2b();return a26_0x5b84=function(_0x5b8408,_0x26d9eb){_0x5b8408=_0x5b8408-0x6e;let _0x51daa8=_0x3d2b0d[_0x5b8408];return _0x51daa8;},a26_0x5b84(_0x17bc1e,_0x40f756);}function sendComponents(_0x50fdfc,_0x51bf0a,_0x234d08,_0x5c6a68,_0x31b795){return new Promise((_0x5039a0,_0x34550e)=>{const _0x202199=a26_0x5b84;try{_0x31b795[_0x202199(0xc6)](_0x202199(0x97));let _0x58a70f=Promise['resolve']();_0x5c6a68[_0x202199(0xad)](_0x51e131=>{const _0x1c1944=_0x202199;_0x58a70f=_0x58a70f[_0x1c1944(0xc8)](()=>callSentComponents(_0x50fdfc,_0x51bf0a,_0x234d08,_0x51e131));}),_0x58a70f[_0x202199(0xc8)](()=>{const _0x154868=_0x202199;_0x31b795['log'](_0x154868(0xa1)),_0x5039a0();})['catch'](_0x3a27e1=>{const _0xe51927=_0x202199;_0x31b795[_0xe51927(0xc6)](_0xe51927(0x81)+_0x3a27e1),_0x34550e(_0x3a27e1);});}catch(_0xebb025){_0x31b795[_0x202199(0xc6)]('Error\x20Send\x20Components\x20'+_0xebb025),_0x34550e(_0xebb025);}});}function callSentComponents(_0x373356,_0x111cb0,_0x337099,_0x2da1af){return new Promise((_0x2524c,_0x3345ab)=>{const _0x1152e4=a26_0x5b84;try{const _0x1b1df1={'methodType':constants[_0x1152e4(0xbe)],'body':JSON[_0x1152e4(0xa3)](_0x2da1af)};_0x337099=_0x337099?_0x337099[_0x1152e4(0x7a)]('__','')+'/':'';const _0x18ca76=_0x373356+_0x1152e4(0x7d)+_0x337099[_0x1152e4(0x7a)]('__','')+_0x1152e4(0x9e);http[_0x1152e4(0xd2)](_0x18ca76,_0x111cb0,_0x337099[_0x1152e4(0x7a)]('__',''),JSON[_0x1152e4(0xa3)](_0x1b1df1))['then'](()=>{_0x2524c();})[_0x1152e4(0xb7)](_0x3345ab);}catch(_0x1415d7){_0x3345ab(_0x1415d7);}});}function completeDeployment(_0x175a41,_0x370f08,_0x12e66b,_0x5a37a9,_0x51e5b3,_0x8523c5,_0x111d64,_0x5d6248,_0x27d1ce=![]){return new Promise((_0x1157d4,_0x58dda8)=>{const _0x2f7166=a26_0x5b84;try{Promise[_0x2f7166(0xbb)]()['then'](()=>updateAttachmentLog(_0x175a41,_0x370f08,_0x8523c5,_0x5d6248,_0x27d1ce,!![]))[_0x2f7166(0xc8)](_0x5406b0=>{const _0x5124fd=_0x2f7166;return _0x27d1ce=_0x5406b0,http[_0x5124fd(0xa0)](_0x370f08,_0x51e5b3,_0x12e66b,_0x111d64,_0x5d6248,_0x5406b0);})[_0x2f7166(0xc8)](()=>callUpdateSnapshot(_0x370f08,_0x5a37a9,_0x12e66b,_0x27d1ce,_0x5d6248));}catch(_0x2c6258){_0x58dda8(_0x2c6258);}});}function updateAttachmentLog(_0x245dc0,_0x518e47,_0xbc7cda,_0x3886e5,_0x1a0723,_0x2b68e0=![]){return new Promise(_0xd5334c=>{const _0x335935=a26_0x5b84;try{_0x3886e5[_0x335935(0xc6)](_0x335935(0xce)),Promise[_0x335935(0xbb)]()[_0x335935(0xc8)](()=>http['getAttachmentBody'](_0x518e47,_0xbc7cda,_0x3886e5))[_0x335935(0xc8)](_0x409518=>{const _0x4f840d=_0x335935;return http[_0x4f840d(0x78)](_0x518e47,_0xbc7cda,_0x409518,_0x3886e5,_0x1a0723);})[_0x335935(0xc8)](()=>_0xd5334c(_0x1a0723))[_0x335935(0xb7)](()=>_0xd5334c(_0x1a0723));}catch(_0x26d9b9){_0x3886e5['log'](_0x335935(0x9f)+_0x26d9b9),_0xd5334c(_0x1a0723);}});}function callUpdateSnapshot(_0x5ef4e1,_0x1b7af,_0x10fc2e,_0x3eb2bc,_0x40b7e6){return new Promise((_0x34a6a3,_0x545541)=>{const _0x25a7c3=a26_0x5b84;try{_0x40b7e6[_0x25a7c3(0xc6)]('Start\x20Update\x20Snapshot');const _0x517853={'Id':_0x1b7af,[_0x10fc2e+'Is_Completed__c']:!![],[_0x10fc2e+_0x25a7c3(0x84)]:_0x3eb2bc};_0x5ef4e1[_0x25a7c3(0x76)](_0x10fc2e+_0x25a7c3(0x6f))['update'](_0x517853)[_0x25a7c3(0xc8)](()=>{const _0xa89113=_0x25a7c3;_0x40b7e6[_0xa89113(0xc6)](_0xa89113(0x8e)),_0x34a6a3();})[_0x25a7c3(0xb7)](_0x5308d5=>{const _0x3ff1c0=_0x25a7c3;_0x40b7e6[_0x3ff1c0(0xc6)](_0x3ff1c0(0x7b)),_0x545541(_0x5308d5);});}catch(_0x1309eb){_0x40b7e6['log'](_0x25a7c3(0x7b)),_0x545541(_0x1309eb);}});}function getDependencyList(_0x579b20,_0x13db80,_0xa6f8d2){return new Promise((_0x505321,_0x1616e3)=>{const _0x5ef03c=a26_0x5b84;try{_0xa6f8d2[_0x5ef03c(0xc6)](_0x5ef03c(0x74));const _0x19ee3a=[];let _0x5cc835=Promise[_0x5ef03c(0xbb)]();_0x13db80[_0x5ef03c(0xad)](_0xfbb349=>{const _0x778595=_0x5ef03c;_0x5cc835=_0x5cc835[_0x778595(0xc8)](()=>getPrefilledJSON(_0x579b20,_0xfbb349,_0xa6f8d2))[_0x778595(0xc8)](_0x1b4bf4=>{const _0x2ead17=_0x778595;_0x19ee3a[_0x2ead17(0xcf)](_0x1b4bf4),_0xa6f8d2[_0x2ead17(0xc6)](_0x2ead17(0x8b)+_0x19ee3a['length']+_0x2ead17(0xb9)+_0x13db80[_0x2ead17(0x7c)]);});}),_0x5cc835[_0x5ef03c(0xc8)](()=>{const _0x2b944a=_0x5ef03c;_0xa6f8d2[_0x2b944a(0xc6)](_0x2b944a(0xca)),_0x505321(_0x19ee3a);})[_0x5ef03c(0xb7)](_0x598c2f=>{_0xa6f8d2['log']('Error\x20Get\x20Dependency\x20List\x20'+_0x598c2f),_0x1616e3(_0x598c2f);});}catch(_0x14cdaa){_0xa6f8d2[_0x5ef03c(0xc6)](_0x5ef03c(0xa6)+_0x14cdaa),_0x1616e3(_0x14cdaa);}});}function getPrefilledJSON(_0xdbd5b2,_0x39d30a,_0x3908bb){return new Promise((_0x4867c8,_0x1f6e24)=>{const _0x5040a5=a26_0x5b84;try{const _0x382b8b={'sClassName':_0x5040a5(0x93),'sType':_0x39d30a[_0x5040a5(0x92)],'sSubType':_0x39d30a[_0x5040a5(0x79)],'sLang':_0x39d30a[_0x5040a5(0x8f)]};_0xdbd5b2['apex'][_0x5040a5(0xd2)]('/vlocity_cmt/v1/GenericInvoke/',_0x382b8b,(_0x5de994,_0x49ff57)=>{const _0x4eac31=_0x5040a5;_0x5de994?(_0x3908bb[_0x4eac31(0xc6)]('Error\x20getPrefilledJSON\x20'+_0x5de994),_0x1f6e24(_0x5de994)):_0x4867c8(JSON[_0x4eac31(0xb2)](_0x49ff57));});}catch(_0x5dc505){_0x1f6e24(_0x5dc505),_0x3908bb[_0x5040a5(0xc6)](_0x5040a5(0x95)+_0x5dc505);}});}function extractLwcDependencies(_0x3e144d,_0x43968a){return new Promise((_0x5126b1,_0x35991c)=>{const _0x23eb87=a26_0x5b84;try{_0x43968a[_0x23eb87(0xc6)](_0x23eb87(0xbc));let _0x388377=[];_0x3e144d[_0x23eb87(0xad)](_0xb3860a=>{const _0x207c6e=_0x23eb87;_0xb3860a[_0x207c6e(0x99)]&&_0xb3860a[_0x207c6e(0x99)][_0x207c6e(0x7c)]>0x0&&_0xb3860a[_0x207c6e(0x99)][_0x207c6e(0xad)](_0x44ca73=>{const _0x228016=_0x207c6e;_0x44ca73['children']&&_0x44ca73[_0x228016(0x99)][_0x228016(0x7c)]>0x0&&_0x44ca73[_0x228016(0x99)][_0x228016(0xad)](_0x2285b9=>{const _0x50974e=_0x228016;_0x2285b9[_0x50974e(0x82)][0x0][_0x50974e(0xae)]===_0x50974e(0x7f)&&_0x388377[_0x50974e(0xcf)](_0x2285b9[_0x50974e(0x82)][0x0][_0x50974e(0x75)][_0x50974e(0xcb)]);});});if(_0xb3860a[_0x207c6e(0x75)]&&_0xb3860a[_0x207c6e(0x75)][_0x207c6e(0xb6)])for(const [_0x3fe238,_0x5ae5ed]of Object['entries'](_0xb3860a['propSetMap'][_0x207c6e(0xb6)])){_0x388377['push'](_0x5ae5ed);}_0xb3860a[_0x207c6e(0x99)]&&_0xb3860a[_0x207c6e(0x99)][_0x207c6e(0x7c)]>0x0&&_0xb3860a[_0x207c6e(0x99)][_0x207c6e(0xad)](_0xbb9aa=>{const _0x3bb3a5=_0x207c6e;_0xbb9aa[_0x3bb3a5(0x75)]&&_0xbb9aa[_0x3bb3a5(0x75)][_0x3bb3a5(0xba)]&&_0x388377[_0x3bb3a5(0xcf)](_0xbb9aa[_0x3bb3a5(0x75)][_0x3bb3a5(0xba)]),_0xbb9aa['children']&&_0xbb9aa['children'][_0x3bb3a5(0x7c)]>0x0&&_0xbb9aa[_0x3bb3a5(0x99)][_0x3bb3a5(0xad)](_0x2017a0=>{const _0x372429=_0x3bb3a5;_0x2017a0[_0x372429(0x82)][0x0][_0x372429(0x75)]&&_0x2017a0[_0x372429(0x82)][0x0][_0x372429(0x75)]['lwcComponentOverride']&&_0x388377['push'](_0x2017a0[_0x372429(0x82)][0x0][_0x372429(0x75)][_0x372429(0xba)]);});});}),_0x43968a[_0x23eb87(0xc6)](_0x23eb87(0x88)),_0x5126b1(_0x388377);}catch(_0x4200f2){_0x43968a[_0x23eb87(0xc6)](_0x23eb87(0xc3)+_0x4200f2),_0x35991c(_0x4200f2);}});}module[a26_0x5173a2(0xb8)]={'query':query,'getDependencyList':getDependencyList,'extractLwcDependencies':extractLwcDependencies,'fetchOmniOutContentList':fetchOmniOutContentList,'createLwcFiles':createLwcFiles,'sendComponents':sendComponents,'completeDeployment':completeDeployment};function a26_0x3d2b(){const _0x265c1f=['length','/services/apexrest/','GET','Custom\x20Lightning\x20Web\x20Component','Source','Error\x20Send\x20Components\x20','eleArray','request','Is_Error__c','compositeResponse','/services/data/v50.0/tooling/composite','Start\x20Query','End\x20Extract\x20LWC\x20Dependencies','450WwPfcx','Start\x20Create\x20Lwc\x20Files','Process\x20Get\x20Dependency,\x20processed\x20','fs-extra','POST','End\x20Update\x20Snapshot','vlocity_cmt__Language__c','82cWnDGJ','Start\x20Fetch\x20OmniOut\x20Content\x20List\x20','vlocity_cmt__Type__c','Vlocity\x20BuildJSONWithPrefill','from','Error\x20Get\x20Prefilled\x20JSON\x20','adm-zip','Start\x20Send\x20Components','Error\x20Create\x20Lwc\x20Files\x20','children','FilePath','name','/services/data/v48.0/tooling/query?q=SELECT+Id,DeveloperName,Description+FROM+LightningComponentBundle+WHERE+DeveloperName=\x27','1238iEdzoJ','unlocked-packages','Error\x20Update\x20Attachment\x20Log\x20','callUpdateLog','End\x20Send\x20Components','vlocity_cmt__','stringify','toBuffer','httpStatusCode','Error\x20Get\x20Dependency\x20List\x20','6689170SdTshu','lwc/','base64','231VzHSFn','lwcComponentList','(hidden)','forEach','type','query','MAX_SIZE_UNZIP_ATTACHMENT','Process\x20Fetch\x20OmniOut\x20Content,\x20processed\x20','parse','138AwmTcA','path','Error\x20Query\x20','elementTypeToLwcTemplateMapping','catch','exports','\x20from\x20','lwcComponentOverride','resolve','Start\x20Extract\x20LWC\x20Dependencies','DeveloperName','METHOD_TYPE_ADD_COMPONENTS_TO_SNAPSHOT','80560OddEMr',',\x20all\x20','bundleResources','End\x20Create\x20Lwc\x20Files','Error\x20Extract\x20LWC\x20Dependencies\x20','/services/data/v48.0/tooling/query?q=SELECT+Id,FilePath,Format,Source+FROM+LightningComponentResource+WHERE+LightningComponentBundleId=\x27@{bundleInfo.records[0].Id}\x27','instanceUrl','log','29956qVumEW','then','body','End\x20Get\x20Dependency\x20List\x20','lwcName',',\x20retrieved\x20','273161RDYggS','Start\x20Update\x20Attachment\x20Log','push','3793930cHwwRG','toString','post','LightningComponentBundle','application/json','Snapshot__c','vlocity_cmt','records','10087638dLuDjh','End\x20Fetch\x20OmniOut\x20Content\x20List\x20','Start\x20Get\x20Dependency\x20List\x20','propSetMap','sobject','Error\x20Fetch\x20OmniOut\x20Content\x20List\x20','callUpdateAttachmentLog','vlocity_cmt__SubType__c','replace','Error\x20Update\x20Snapshot'];a26_0x3d2b=function(){return _0x265c1f;};return a26_0x3d2b();}