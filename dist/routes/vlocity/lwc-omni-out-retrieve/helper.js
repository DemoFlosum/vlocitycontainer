const a34_0x1a7bef=a34_0x5063;(function(_0x4f20df,_0x38164c){const _0x20ef5b=a34_0x5063,_0x28d99f=_0x4f20df();while(!![]){try{const _0x509000=parseInt(_0x20ef5b(0x241))/0x1*(-parseInt(_0x20ef5b(0x20e))/0x2)+-parseInt(_0x20ef5b(0x1f8))/0x3+parseInt(_0x20ef5b(0x221))/0x4+parseInt(_0x20ef5b(0x1ef))/0x5*(parseInt(_0x20ef5b(0x1f4))/0x6)+parseInt(_0x20ef5b(0x1f6))/0x7+parseInt(_0x20ef5b(0x1f2))/0x8*(parseInt(_0x20ef5b(0x219))/0x9)+-parseInt(_0x20ef5b(0x1e3))/0xa;if(_0x509000===_0x38164c)break;else _0x28d99f['push'](_0x28d99f['shift']());}catch(_0x4d77eb){_0x28d99f['push'](_0x28d99f['shift']());}}}(a34_0x37b6,0xaa31b));const path=require(a34_0x1a7bef(0x244)),fs=require('fs'),fse=require(a34_0x1a7bef(0x1ea)),AdmZip=require(a34_0x1a7bef(0x1e5)),constants=require(a34_0x1a7bef(0x202)),http=require('../../../services/http');function query(_0x1f39cf,_0x2e9dd3,_0x5efa85){return new Promise((_0x1ae62a,_0x3da26b)=>{const _0x41a0ad=a34_0x5063;try{_0x5efa85[_0x41a0ad(0x22b)](_0x41a0ad(0x20f)),_0x1f39cf[_0x41a0ad(0x1fe)](_0x2e9dd3,(_0x3a7db3,_0x58fed4)=>{const _0x47900b=_0x41a0ad;_0x3a7db3?(_0x5efa85[_0x47900b(0x22b)]('Error\x20Query\x20'+_0x3a7db3),_0x3da26b(_0x3a7db3)):(_0x5efa85[_0x47900b(0x22b)](_0x47900b(0x23c)),_0x1ae62a(_0x58fed4[_0x47900b(0x209)][_0x47900b(0x205)](_0x5131b1=>_0x5131b1[_0x47900b(0x231)]&&_0x5131b1[_0x47900b(0x211)]&&_0x5131b1['vlocity_cmt__Language__c'])[_0x47900b(0x1f5)](({vlocity_cmt__Type__c:_0x2b2b05,vlocity_cmt__SubType__c:_0x5a9744,vlocity_cmt__Language__c:_0x1672e6})=>''+_0x2b2b05+_0x5a9744+_0x1672e6)));});}catch(_0x4ad0df){_0x3da26b(_0x4ad0df),_0x5efa85[_0x41a0ad(0x22b)](_0x41a0ad(0x23f)+_0x4ad0df);}});}function fetchOmniOutContentList(_0xc0bc80,_0x21981b,_0x5d30c0){return new Promise((_0x38636e,_0x166ac1)=>{const _0x19298b=a34_0x5063;try{_0x5d30c0['log']('Start\x20Fetch\x20OmniOut\x20Content\x20List\x20');const _0x2d1c62=[];let _0x1a2b19=0x1,_0x34b43c=Promise[_0x19298b(0x227)]();_0x21981b[_0x19298b(0x218)](_0x4d06c7=>{_0x34b43c=_0x34b43c['then'](()=>fetchOmniOutContent(_0xc0bc80,_0x4d06c7))['then'](_0x34b1cd=>{const _0x1b187d=a34_0x5063;_0x34b1cd&&_0x34b1cd['compositeResponse']&&_0x34b1cd[_0x1b187d(0x22f)]['length']===0x2&&(_0x34b1cd[_0x1b187d(0x22f)][0x0]['httpStatusCode']===0xc8&&_0x2d1c62[_0x1b187d(0x232)]({'lwcComponentList':_0x34b1cd[_0x1b187d(0x22f)][0x1][_0x1b187d(0x20b)]['records'],'name':_0x34b1cd[_0x1b187d(0x22f)][0x0]['body']['records'][0x0][_0x1b187d(0x20d)]})),_0x5d30c0[_0x1b187d(0x22b)](_0x1b187d(0x1e4)+_0x1a2b19++ +_0x1b187d(0x225)+_0x2d1c62[_0x1b187d(0x240)]+_0x1b187d(0x23e)+_0x21981b[_0x1b187d(0x240)]);});}),_0x34b43c[_0x19298b(0x20a)](()=>{const _0x2c6d23=_0x19298b;_0x5d30c0[_0x2c6d23(0x22b)](_0x2c6d23(0x236)),_0x38636e(_0x2d1c62);})[_0x19298b(0x21e)](_0x2968ea=>{const _0x1c6999=_0x19298b;_0x5d30c0['log'](_0x1c6999(0x237)+_0x2968ea),_0x166ac1(_0x2968ea);});}catch(_0x5f429d){_0x166ac1(_0x5f429d),_0x5d30c0[_0x19298b(0x22b)](_0x19298b(0x237)+_0x5f429d);}});}function fetchOmniOutContent(_0xf29683,_0x225c76){const _0x1247f1=a34_0x1a7bef;_0x225c76=_0x225c76[_0x1247f1(0x1ee)]('-','')['replace']('vlocity_cmt__','');const _0x21431a={'allOrNone':!![],'compositeRequest':[{'method':_0x1247f1(0x200),'referenceId':_0x1247f1(0x1f1),'url':_0x1247f1(0x1fd)+_0x225c76+'\x27'},{'method':_0x1247f1(0x200),'referenceId':_0x1247f1(0x238),'url':_0x1247f1(0x203)}]},_0x1cd4a4=_0xf29683[_0x1247f1(0x20c)],_0x501c31={'method':_0x1247f1(0x1e6),'url':_0x1cd4a4+_0x1247f1(0x1eb),'body':JSON[_0x1247f1(0x1fa)](_0x21431a),'headers':{'Content-Type':_0x1247f1(0x242)}};return _0xf29683[_0x1247f1(0x215)](_0x501c31);}function a34_0x5063(_0x57e69e,_0x32cc07){const _0x37b662=a34_0x37b6();return a34_0x5063=function(_0x5063f3,_0xbe42d1){_0x5063f3=_0x5063f3-0x1e3;let _0x3cfa5b=_0x37b662[_0x5063f3];return _0x3cfa5b;},a34_0x5063(_0x57e69e,_0x32cc07);}function createLwcFiles(_0x244850,_0xb6f490,_0x4dabde,_0x55feb4){return new Promise((_0x17e7f3,_0x37b362)=>{const _0x592d45=a34_0x5063;try{_0x55feb4[_0x592d45(0x22b)](_0x592d45(0x21f));const _0xb74d9c=[];let _0x4e85a5=[],_0x39c148=0x0,_0x433fc4=new AdmZip();_0xb6f490[_0x592d45(0x218)](_0x1c9789=>{const _0x3c3d17=_0x592d45;_0x4e85a5[_0x3c3d17(0x232)]({'apiName':_0x1c9789[_0x3c3d17(0x204)],'componentType':_0x3c3d17(0x212),'label':_0x3c3d17(0x207)+_0x1c9789[_0x3c3d17(0x204)]}),_0x1c9789[_0x3c3d17(0x229)]['forEach'](_0x3339b2=>{const _0x8c5e4e=_0x3c3d17;_0x3339b2['Source']!==_0x8c5e4e(0x22e)&&(_0x39c148+=_0x3339b2[_0x8c5e4e(0x206)][_0x8c5e4e(0x240)],_0x39c148<constants[_0x8c5e4e(0x22a)]?_0x433fc4[_0x8c5e4e(0x21b)](''+_0x3339b2[_0x8c5e4e(0x1f0)],Buffer['from'](_0x3339b2['Source']['replace'](new RegExp('vlocity_cmt','g'),'c'))):(_0xb74d9c[_0x8c5e4e(0x232)]({'snapshotId':_0x4dabde,'typeList':[{'type':'LightningComponentBundle','zip':_0x433fc4[_0x8c5e4e(0x223)]()[_0x8c5e4e(0x233)](_0x8c5e4e(0x1ed)),'componentList':_0x4e85a5}]}),_0x4e85a5=[],_0x39c148=0x0,_0x433fc4=new AdmZip()));}),delete _0x1c9789[_0x3c3d17(0x229)];}),_0x4e85a5[_0x592d45(0x240)]&&_0xb74d9c[_0x592d45(0x232)]({'snapshotId':_0x4dabde,'typeList':[{'type':'LightningComponentBundle','zip':_0x433fc4[_0x592d45(0x223)]()[_0x592d45(0x233)](_0x592d45(0x1ed)),'componentList':_0x4e85a5}]}),_0x55feb4[_0x592d45(0x22b)](_0x592d45(0x239)),_0x17e7f3(_0xb74d9c);}catch(_0x434270){_0x55feb4[_0x592d45(0x22b)](_0x592d45(0x1f9)+_0x434270),_0x37b362(_0x434270);}});}function sendComponents(_0x124bd4,_0x36fe74,_0x424e6b,_0x14c5a5){return new Promise((_0x5eb8a6,_0x4574e3)=>{const _0x19709a=a34_0x5063;try{_0x14c5a5[_0x19709a(0x22b)]('Start\x20Send\x20Components');let _0xc29755=Promise[_0x19709a(0x227)]();_0x424e6b[_0x19709a(0x218)](_0x1aa1c9=>{const _0xb2cc02=_0x19709a;_0xc29755=_0xc29755[_0xb2cc02(0x20a)](()=>callSentComponents(_0x124bd4,_0x36fe74,_0x1aa1c9));}),_0xc29755[_0x19709a(0x20a)](()=>{const _0x41c241=_0x19709a;_0x14c5a5[_0x41c241(0x22b)]('End\x20Send\x20Components'),_0x5eb8a6();})[_0x19709a(0x21e)](_0xfd915c=>{const _0x518448=_0x19709a;_0x14c5a5[_0x518448(0x22b)](_0x518448(0x228)+_0xfd915c),_0x4574e3(_0xfd915c);});}catch(_0x473369){_0x14c5a5[_0x19709a(0x22b)]('Error\x20Send\x20Components\x20'+_0x473369),_0x4574e3(_0x473369);}});}function callSentComponents(_0x4cefd6,_0x206271,_0x26ed66){return new Promise((_0x2a63fe,_0x3e1681)=>{const _0x737d6f=a34_0x5063;try{const _0x9b761b={'methodType':constants[_0x737d6f(0x1f7)],'body':JSON[_0x737d6f(0x1fa)](_0x26ed66)};http['post'](_0x4cefd6,_0x206271['replace']('__',''),JSON[_0x737d6f(0x1fa)](_0x9b761b))[_0x737d6f(0x20a)](()=>{_0x2a63fe();})[_0x737d6f(0x21e)](_0x3e1681);}catch(_0x3bb32d){_0x3e1681(_0x3bb32d);}});}function completeDeployment(_0x3748b3,_0x4af0c9,_0x5720b5,_0x56d2a4,_0x464a4e,_0x3f3d84,_0x3edad0,_0x2f67c4,_0x3373ad=![]){return new Promise((_0x2e8a94,_0x3910c8)=>{const _0x3a5323=a34_0x5063;try{Promise[_0x3a5323(0x227)]()[_0x3a5323(0x20a)](()=>updateAttachmentLog(_0x3748b3,_0x4af0c9,_0x3f3d84,_0x2f67c4,_0x3373ad,!![]))['then'](_0x2290f2=>{const _0x4691bb=_0x3a5323;return _0x3373ad=_0x2290f2,http[_0x4691bb(0x1ec)](_0x4af0c9,_0x464a4e,_0x5720b5,_0x3edad0,_0x2f67c4,_0x2290f2);})['then'](()=>callUpdateSnapshot(_0x4af0c9,_0x56d2a4,_0x5720b5,_0x3373ad,_0x2f67c4));}catch(_0x3d3643){_0x3910c8(_0x3d3643);}});}function updateAttachmentLog(_0x5d5f42,_0x237a0c,_0x296e24,_0x45b0a7,_0x2a5fbc,_0x4cdcb0=![]){return new Promise(_0x5ed9c3=>{const _0x448528=a34_0x5063;try{_0x45b0a7[_0x448528(0x22b)]('Start\x20Update\x20Attachment\x20Log'),Promise[_0x448528(0x227)]()[_0x448528(0x20a)](()=>http[_0x448528(0x234)](_0x237a0c,_0x296e24,_0x45b0a7))['then'](_0x52a895=>http['callUpdateAttachmentLog'](_0x237a0c,_0x296e24,_0x52a895,_0x45b0a7,_0x2a5fbc))[_0x448528(0x20a)](()=>_0x5ed9c3(_0x2a5fbc))[_0x448528(0x21e)](()=>_0x5ed9c3(_0x2a5fbc));}catch(_0x47d552){_0x45b0a7[_0x448528(0x22b)](_0x448528(0x210)+_0x47d552),_0x5ed9c3(_0x2a5fbc);}});}function callUpdateSnapshot(_0x22e159,_0x57ba99,_0x2a3cff,_0x24a767,_0x4076f2){return new Promise((_0x16d409,_0x80d58c)=>{const _0x24437f=a34_0x5063;try{_0x4076f2['log'](_0x24437f(0x1e9));const _0x37b5da={'Id':_0x57ba99,[_0x2a3cff+'Is_Completed__c']:!![],[_0x2a3cff+_0x24437f(0x222)]:_0x24a767};_0x22e159[_0x24437f(0x21c)](_0x2a3cff,_0x37b5da)['then'](()=>{const _0x4adea8=_0x24437f;_0x4076f2[_0x4adea8(0x22b)](_0x4adea8(0x214)),_0x16d409();})[_0x24437f(0x21e)](_0x5218f2=>{const _0x51727e=_0x24437f;_0x4076f2['log'](_0x51727e(0x1e8)),_0x80d58c(_0x5218f2);});}catch(_0xdf5e3f){_0x4076f2[_0x24437f(0x22b)](_0x24437f(0x1e8)),_0x80d58c(_0xdf5e3f);}});}function getDependencyList(_0x3c987c,_0x5b00ad,_0x1c9881){return new Promise((_0x2d7ae7,_0xdeb441)=>{const _0x96ca1=a34_0x5063;try{_0x1c9881[_0x96ca1(0x22b)](_0x96ca1(0x226));const _0x36ce40=[];let _0x48c2b0=Promise[_0x96ca1(0x227)]();_0x5b00ad['forEach'](_0x4a74ba=>{const _0x3018e7=_0x96ca1;_0x48c2b0=_0x48c2b0[_0x3018e7(0x20a)](()=>getPrefilledJSON(_0x3c987c,_0x4a74ba,_0x1c9881))[_0x3018e7(0x20a)](_0x407b08=>{const _0xa55295=_0x3018e7;_0x36ce40[_0xa55295(0x232)](_0x407b08),_0x1c9881[_0xa55295(0x22b)](_0xa55295(0x235)+_0x36ce40[_0xa55295(0x240)]+_0xa55295(0x1ff)+_0x5b00ad[_0xa55295(0x240)]);});}),_0x48c2b0[_0x96ca1(0x20a)](()=>{const _0x55ddbf=_0x96ca1;_0x1c9881[_0x55ddbf(0x22b)](_0x55ddbf(0x1fc)),_0x2d7ae7(_0x36ce40);})[_0x96ca1(0x21e)](_0x2d698b=>{const _0x5eefc2=_0x96ca1;_0x1c9881[_0x5eefc2(0x22b)](_0x5eefc2(0x243)+_0x2d698b),_0xdeb441(_0x2d698b);});}catch(_0x5ca57c){_0x1c9881[_0x96ca1(0x22b)]('Error\x20Get\x20Dependency\x20List\x20'+_0x5ca57c),_0xdeb441(_0x5ca57c);}});}function getPrefilledJSON(_0xf71977,_0x55cd06,_0x5e3d83){return new Promise((_0x399512,_0x23ec87)=>{const _0x2e8b15=a34_0x5063;try{const _0x1ef305={'sClassName':'Vlocity\x20BuildJSONWithPrefill','sType':_0x55cd06[_0x2e8b15(0x231)],'sSubType':_0x55cd06['vlocity_cmt__SubType__c'],'sLang':_0x55cd06[_0x2e8b15(0x23a)]};_0xf71977[_0x2e8b15(0x23b)][_0x2e8b15(0x21a)](_0x2e8b15(0x201),_0x1ef305,(_0x33c1e5,_0x50bf7d)=>{const _0x25acd9=_0x2e8b15;_0x33c1e5?(_0x5e3d83[_0x25acd9(0x22b)]('Error\x20getPrefilledJSON\x20'+_0x33c1e5),_0x23ec87(_0x33c1e5)):_0x399512(JSON[_0x25acd9(0x22c)](_0x50bf7d));});}catch(_0xbd79b9){_0x23ec87(_0xbd79b9),_0x5e3d83[_0x2e8b15(0x22b)](_0x2e8b15(0x216)+_0xbd79b9);}});}function extractLwcDependencies(_0x265930,_0x52dc8d){return new Promise((_0x10299a,_0x147a8f)=>{const _0x42d165=a34_0x5063;try{_0x52dc8d[_0x42d165(0x22b)](_0x42d165(0x1f3));const _0x4957e0=[];_0x265930['forEach'](_0x370b22=>{const _0x1575f3=_0x42d165;_0x370b22[_0x1575f3(0x213)]&&_0x370b22[_0x1575f3(0x213)][_0x1575f3(0x240)]>0x0&&_0x370b22['children'][_0x1575f3(0x218)](_0x1d9ddd=>{const _0x25d358=_0x1575f3;_0x1d9ddd[_0x25d358(0x213)]&&_0x1d9ddd[_0x25d358(0x213)][_0x25d358(0x240)]>0x0&&_0x1d9ddd[_0x25d358(0x213)][_0x25d358(0x218)](_0x421809=>{const _0x111dd4=_0x25d358;_0x421809['eleArray'][0x0][_0x111dd4(0x224)]===_0x111dd4(0x21d)&&_0x4957e0[_0x111dd4(0x232)](_0x421809['eleArray'][0x0]['propSetMap'][_0x111dd4(0x1fb)]);});});if(_0x370b22['propSetMap']&&_0x370b22[_0x1575f3(0x230)][_0x1575f3(0x23d)])for(const [_0x2827e9,_0x48f78a]of Object['entries'](_0x370b22[_0x1575f3(0x230)][_0x1575f3(0x23d)])){_0x4957e0[_0x1575f3(0x232)](_0x48f78a);}_0x370b22[_0x1575f3(0x213)]&&_0x370b22[_0x1575f3(0x213)][_0x1575f3(0x240)]>0x0&&_0x370b22[_0x1575f3(0x213)][_0x1575f3(0x218)](_0x11f583=>{const _0x3a71c2=_0x1575f3;_0x11f583[_0x3a71c2(0x230)]&&_0x11f583['propSetMap'][_0x3a71c2(0x217)]&&_0x4957e0[_0x3a71c2(0x232)](_0x11f583[_0x3a71c2(0x230)]['lwcComponentOverride']),_0x11f583[_0x3a71c2(0x213)]&&_0x11f583[_0x3a71c2(0x213)]['length']>0x0&&_0x11f583['children']['forEach'](_0x545e79=>{const _0x5c1854=_0x3a71c2;_0x545e79[_0x5c1854(0x220)][0x0][_0x5c1854(0x230)]&&_0x545e79['eleArray'][0x0][_0x5c1854(0x230)][_0x5c1854(0x217)]&&_0x4957e0[_0x5c1854(0x232)](_0x545e79[_0x5c1854(0x220)][0x0]['propSetMap'][_0x5c1854(0x217)]);});});}),_0x52dc8d[_0x42d165(0x22b)](_0x42d165(0x22d)),_0x10299a(_0x4957e0);}catch(_0x525de0){_0x52dc8d['log'](_0x42d165(0x208)+_0x525de0),_0x147a8f(_0x525de0);}});}module[a34_0x1a7bef(0x1e7)]={'query':query,'getDependencyList':getDependencyList,'extractLwcDependencies':extractLwcDependencies,'fetchOmniOutContentList':fetchOmniOutContentList,'createLwcFiles':createLwcFiles,'sendComponents':sendComponents,'completeDeployment':completeDeployment};function a34_0x37b6(){const _0x2d6b5a=['9sZYeCL','post','addFile','updateSnapshot','Custom\x20Lightning\x20Web\x20Component','catch','Start\x20Create\x20Lwc\x20Files','eleArray','2217028lHttOO','Is_Error__c','toBuffer','type',',\x20retrieved\x20','Start\x20Get\x20Dependency\x20List\x20','resolve','Error\x20Send\x20Components\x20','lwcComponentList','MAX_SIZE_UNZIP_ATTACHMENT','log','parse','End\x20Extract\x20LWC\x20Dependencies','(hidden)','compositeResponse','propSetMap','vlocity_cmt__Type__c','push','toString','getAttachmentBody','Process\x20Get\x20Dependency,\x20processed\x20','End\x20Fetch\x20OmniOut\x20Content\x20List\x20','Error\x20Fetch\x20OmniOut\x20Content\x20List\x20','bundleResources','End\x20Create\x20Lwc\x20Files','vlocity_cmt__Language__c','apex','End\x20Query','elementTypeToLwcTemplateMapping',',\x20all\x20','Error\x20Query\x20','length','379cdzwjk','application/json','Error\x20Get\x20Dependency\x20List\x20','path','13113210cDgbdn','Process\x20Fetch\x20OmniOut\x20Content,\x20processed\x20','adm-zip','POST','exports','Error\x20Update\x20Snapshot','Start\x20Update\x20Snapshot','fs-extra','/services/data/v50.0/tooling/composite','callUpdateLog','base64','replace','1865ZsYlHe','FilePath','bundleInfo','1201488KeGqtr','Start\x20Extract\x20LWC\x20Dependencies','8718gTRVZQ','map','9424065zvoyqt','METHOD_TYPE_ADD_COMPONENTS_TO_SNAPSHOT','91656uJdlIT','Error\x20Create\x20Lwc\x20Files\x20','stringify','lwcName','End\x20Get\x20Dependency\x20List\x20','/services/data/v48.0/tooling/query?q=SELECT+Id,DeveloperName,Description+FROM+LightningComponentBundle+WHERE+DeveloperName=\x27','query','\x20from\x20','GET','/vlocity_cmt/v1/GenericInvoke/','../../../constants','/services/data/v48.0/tooling/query?q=SELECT+Id,FilePath,Format,Source+FROM+LightningComponentResource+WHERE+LightningComponentBundleId=\x27@{bundleInfo.records[0].Id}\x27','name','filter','Source','lwc/','Error\x20Extract\x20LWC\x20Dependencies\x20','records','then','body','instanceUrl','DeveloperName','2922sZjDQz','Start\x20Query','Error\x20Update\x20Attachment\x20Log\x20','vlocity_cmt__SubType__c','LightningComponentBundle','children','End\x20Update\x20Snapshot','request','Error\x20Get\x20Prefilled\x20JSON\x20','lwcComponentOverride','forEach'];a34_0x37b6=function(){return _0x2d6b5a;};return a34_0x37b6();}