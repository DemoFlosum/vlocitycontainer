function a47_0x2356(_0x4ec511,_0x2b9490){const _0x3c2fc9=a47_0x3c2f();return a47_0x2356=function(_0x23562f,_0x528840){_0x23562f=_0x23562f-0xc0;let _0x577d2a=_0x3c2fc9[_0x23562f];return _0x577d2a;},a47_0x2356(_0x4ec511,_0x2b9490);}const a47_0xccd811=a47_0x2356;(function(_0x6f9d87,_0x34d945){const _0x59a647=a47_0x2356,_0x34fa57=_0x6f9d87();while(!![]){try{const _0xfa7711=-parseInt(_0x59a647(0x102))/0x1*(parseInt(_0x59a647(0xfc))/0x2)+parseInt(_0x59a647(0xd9))/0x3*(-parseInt(_0x59a647(0xda))/0x4)+parseInt(_0x59a647(0xc8))/0x5+-parseInt(_0x59a647(0xed))/0x6+-parseInt(_0x59a647(0xc5))/0x7+parseInt(_0x59a647(0xe9))/0x8*(-parseInt(_0x59a647(0xe5))/0x9)+parseInt(_0x59a647(0xd7))/0xa;if(_0xfa7711===_0x34d945)break;else _0x34fa57['push'](_0x34fa57['shift']());}catch(_0x4fc5c3){_0x34fa57['push'](_0x34fa57['shift']());}}}(a47_0x3c2f,0x349da));const axios=require(a47_0xccd811(0xcd)),yaml=require('js-yaml'),constants=require(a47_0xccd811(0xd2)),storage=require(a47_0xccd811(0xf5)),CLIENT_CREDENTIALS_TYPE=a47_0xccd811(0xe6);async function post(_0x31a4ef,_0x29dc70,_0x4f5a4f,_0x252605=a47_0xccd811(0xe7),_0x8703e0=![]){const _0x484d6c=a47_0xccd811,_0xf7302a={'Authorization':_0x484d6c(0xeb)+_0x31a4ef[_0x484d6c(0x109)],'Content-Type':_0x484d6c(0xe2)};_0x29dc70=_0x29dc70&&_0x29dc70['length']?_0x29dc70['replace']('__','')+'/':'';const _0xd87cf0=_0x31a4ef[_0x484d6c(0xdd)]+_0x484d6c(0xec)+_0x29dc70+_0x252605;try{return await axios[_0x484d6c(0xe8)](_0xd87cf0,_0x4f5a4f,{'headers':_0xf7302a});}catch(_0x22593e){if(_0x22593e?.[_0x484d6c(0xee)]?.[_0x484d6c(0x110)]===0x191&&!_0x8703e0&&_0x31a4ef[_0x484d6c(0xca)]&&_0x31a4ef[_0x484d6c(0xf1)])return _0x31a4ef[_0x484d6c(0x109)]=await refreshToken(_0x31a4ef),await post(_0x31a4ef,_0x29dc70,_0x4f5a4f,_0x252605,!![]);throw getErrorMessage(_0x22593e);}}function getErrorMessage(_0x1cc211){const _0x2bf770=a47_0xccd811,_0x291757=_0x1cc211?.[_0x2bf770(0xee)]?.[_0x2bf770(0x10d)];if(_0x291757){if(typeof _0x291757===_0x2bf770(0x115))return _0x291757;if(_0x291757['message'])return _0x291757[_0x2bf770(0x108)];}if(_0x1cc211?.['message'])return _0x1cc211[_0x2bf770(0x108)];return _0x2bf770(0xf4)+_0x1cc211;}async function refreshToken({instanceUrl:_0x4b4f21,clientId:_0x10a0b7,clientSecret:_0x45ff11}){const _0x1c9d32=a47_0xccd811,{data:_0x1cf2e9}=await axios[_0x1c9d32(0xe8)](_0x4b4f21+_0x1c9d32(0xc1),null,{'params':{'grant_type':CLIENT_CREDENTIALS_TYPE,'client_id':_0x10a0b7,'client_secret':_0x45ff11}});return _0x1cf2e9[_0x1c9d32(0xc6)];}function callUpdateInfo(_0x436cea,_0x2645ab,_0x2decfe,_0x2b753e,_0x26afcc,_0xb7ff79,_0xe8d68f,_0x56bcc4=![]){return new Promise((_0x1c3a05,_0x150223)=>{const _0x44c1d2=a47_0x2356;try{try{const _0x286a45=yaml['load'](_0x26afcc);_0x286a45[_0x44c1d2(0xcb)]&&(_0x56bcc4=_0x286a45[_0x44c1d2(0xcb)][_0x44c1d2(0xf3)]>0x0);}catch(_0x42ddfa){}_0xe8d68f[_0x44c1d2(0xce)](_0x44c1d2(0xde)+_0xb7ff79);const _0x3f5b61={'logId':_0x2645ab,'attachmentLogId':_0x2b753e,'isJobCompleted':!![],'status':_0x44c1d2(0x10a),'isSuccess':_0xb7ff79,'isError':_0x56bcc4,'attachmentBody':_0x26afcc+_0x44c1d2(0x103)+_0xe8d68f[_0x44c1d2(0xf0)]['join']('\x0a')},_0x17a3da={'methodType':constants[_0x44c1d2(0xc9)],'body':JSON[_0x44c1d2(0xc4)](_0x3f5b61)};post(_0x436cea,_0x2decfe,_0x17a3da)[_0x44c1d2(0x107)](_0x57895a=>{const _0x56bd70=_0x44c1d2;_0xe8d68f[_0x56bd70(0xce)](_0x56bd70(0x10b)+_0xb7ff79),_0x1c3a05(_0x57895a);})[_0x44c1d2(0xe0)](_0x42852d=>{const _0x63ba98=_0x44c1d2;_0xe8d68f[_0x63ba98(0xce)]('Error\x20Update\x20Log\x20is\x20Success\x20=\x20'+_0xb7ff79),_0x150223(_0x42852d);});}catch(_0x223940){_0x150223(_0x223940);}});}function callNextVlocityStep(_0x48619f,_0x459f0e,_0x156730,_0x181276,_0x3ccf1f,_0x12b91d,_0x134d63,_0xa40ca){return new Promise((_0x13d767,_0x24fa69)=>{const _0x1c5e73=a47_0x2356;try{_0xa40ca['log'](_0x1c5e73(0x105));const _0x5856f2={'pipelineId':_0x156730,'pipelineNumber':_0x181276,'isPass':_0x12b91d,'branchId':_0x134d63,'pipelineKey':_0x3ccf1f},_0x1dedf7={'methodType':constants[_0x1c5e73(0x10f)],'body':JSON[_0x1c5e73(0xc4)](_0x5856f2)};post(_0x48619f,_0x459f0e,_0x1dedf7)[_0x1c5e73(0x107)](_0x3144c8=>{const _0x12c752=_0x1c5e73;_0xa40ca['log'](_0x12c752(0xd5)),_0x13d767(_0x3144c8);})['catch'](_0x78dbbe=>{const _0x20f5e7=_0x1c5e73;_0xa40ca[_0x20f5e7(0xce)](_0x20f5e7(0xea)),_0x24fa69(_0x78dbbe);});}catch(_0x4f8eeb){_0x24fa69(_0x4f8eeb);}});}function callComponentList(_0x2a3266,_0xfb6177,_0x4068c5,_0xa807d0,_0x540a1b,_0x3ab297=[]){return new Promise((_0x34d334,_0x53fa6b)=>{const _0xa9ef9d=a47_0x2356;try{_0x540a1b[_0xa9ef9d(0xce)](_0xa9ef9d(0xef));const _0x1d83c4={'methodType':constants[_0xa9ef9d(0x114)],'body':JSON['stringify'](_0xfb6177)};post(_0x2a3266,_0x4068c5,_0x1d83c4)['then'](_0x183606=>{const _0x12f03d=_0xa9ef9d;let {data:_0x24d51d}=_0x183606;_0x24d51d=JSON[_0x12f03d(0xf2)](_0x24d51d),_0x540a1b[_0x12f03d(0xce)](_0x12f03d(0xd8)+Number[_0x12f03d(0xc7)](_0x3ab297[_0x12f03d(0xf3)]/_0xa807d0*0x64)[_0x12f03d(0x10c)](0x2)+'%'),_0x3ab297[_0x12f03d(0xd4)](..._0x24d51d[_0x12f03d(0xf9)]),_0x24d51d[_0x12f03d(0xc0)]&&_0x24d51d[_0x12f03d(0xc0)][_0x12f03d(0xf3)]?callComponentList(_0x2a3266,_0x24d51d[_0x12f03d(0xc0)],_0x4068c5,_0xa807d0,_0x540a1b,_0x3ab297)[_0x12f03d(0x107)](_0x2316bd=>_0x34d334(_0x2316bd))[_0x12f03d(0xe0)](_0x730aba=>{const _0x43eb47=_0x12f03d;_0x540a1b[_0x43eb47(0xce)](_0x43eb47(0xfe)),_0x53fa6b(_0x730aba);}):(_0x540a1b[_0x12f03d(0xce)](_0x12f03d(0xd6)),_0x34d334(_0x3ab297));})[_0xa9ef9d(0xe0)](_0x3e63a5=>{const _0xdeed7e=_0xa9ef9d;_0x540a1b['log'](_0xdeed7e(0xfe)),_0x53fa6b(_0x3e63a5);});}catch(_0x32acbd){_0x540a1b[_0xa9ef9d(0xce)](_0xa9ef9d(0xfe)),_0x53fa6b(_0x32acbd);}});}async function getBodyFromStream(_0x51e839,_0x572300,_0x8994b4){return new Promise(_0x5185b4=>{const _0x5c5fb0=a47_0x2356;try{const _0x1be153=[];_0x51e839['on'](_0x5c5fb0(0x10d),(_0x57a853,_0x1d6e95)=>{_0x1be153['push'](_0x57a853);}),_0x51e839['on']('end',()=>{const _0x4f4a98=_0x5c5fb0;_0x572300?_0x5185b4(_0x1be153[_0x4f4a98(0x104)]('')):_0x5185b4(Buffer[_0x4f4a98(0xfa)](_0x1be153));}),_0x51e839['on'](_0x5c5fb0(0xe4),_0x20e09b=>{const _0x49d350=_0x5c5fb0;_0x8994b4[_0x49d350(0xce)](_0x49d350(0xff)+_0x20e09b),_0x5185b4('');});}catch(_0xb6fb8){_0x8994b4[_0x5c5fb0(0xce)](_0x5c5fb0(0xff)+_0xb6fb8),_0x5185b4('');}});}async function getAttachmentBody(_0x442805,_0x15df91,_0x5cb0b1,_0x1a4642=!![]){const _0x38c364=a47_0xccd811,_0x50a56b=await _0x442805[_0x38c364(0xdb)](_0x15df91);return await getBodyFromStream(_0x50a56b,_0x1a4642,_0x5cb0b1);}function getTime(){const _0x4f0571=a47_0xccd811,_0x10cc6e=new Date(),_0x59af2a=[_0x10cc6e['getDate'](),_0x10cc6e[_0x4f0571(0x113)]()+0x1,_0x10cc6e[_0x4f0571(0xf7)](),_0x10cc6e[_0x4f0571(0xc2)](),_0x10cc6e[_0x4f0571(0xfd)](),_0x10cc6e[_0x4f0571(0xd3)]()];return _0x59af2a[_0x4f0571(0xe1)](_0x4fcafd=>_0x4fcafd=_0x4fcafd[_0x4f0571(0xc3)]()[_0x4f0571(0xcf)](/^([0-9])$/,_0x4f0571(0xdf))),_0x59af2a[0x2]+'-'+_0x59af2a[0x1]+'-'+_0x59af2a[0x0]+'\x20'+_0x59af2a[0x3]+':'+_0x59af2a[0x4]+':'+_0x59af2a[0x5];}function a47_0x3c2f(){const _0x418ed8=['METHOD_UPDATE_LOG','clientId','Errors','Exception','axios','log','replace','Start\x20Update\x20Metadata\x20Log\x20isError\x20','load','../../constants','getSeconds','push','End\x20Next\x20Vlocity\x20Step','End\x20Call\x20Component\x20List','11058590tyMCgb','Retrieved:\x20','69GWukWP','40276EepZnz','getAttachmentBodyStream','Is_Error__c','instanceUrl','Start\x20Update\x20Log\x20is\x20Success\x20=\x20','0$1','catch','forEach','application/json','Error\x20Update\x20Metadata\x20Log\x20','error','276426gwYWIp','client_credentials','unlocked-packages','post','8wDufXZ','Error\x20Next\x20Vlocity\x20Step','OAuth\x20','/services/apexrest/','2235624KiQNPk','response','Start\x20Call\x20Component\x20List','logs','clientSecret','parse','length','Unknown\x20error:\x20','../storage','End\x20Update\x20Attachment\x20Log','getFullYear','Start\x20Update\x20Attachment\x20Log','recordList','concat','Succeed__c','2lERVHh','getMinutes','Error\x20Call\x20Component\x20List','Error\x20Get\x20Attachment\x20Body\x20','Error\x20Update\x20Attachment\x20Log\x20','updateMetadataLog','225581aOkdmo','Full\x20Process:\x0a\x0a','join','Start\x20Next\x20Vlocity\x20Step','readLogFile','then','message','accessToken','Completed','End\x20Update\x20Log\x20is\x20Success\x20=\x20','toFixed','data','End\x20Update\x20Metadata\x20Log','METHOD_NEXT_VLOCITY_STEP','status','Job_Completed__c','Partial\x20Completed','getMonth','METHOD_TYPE_GET_ATTACHMENTS','string','updateAttachment','base64','idList','/services/oauth2/token','getHours','toString','stringify','2451834zafDOw','access_token','parseFloat','1602015pWSNKx'];a47_0x3c2f=function(){return _0x418ed8;};return a47_0x3c2f();}function callUpdateAttachmentLog(_0xd9f3ee,_0x4b9ca4,_0x278c64,_0x21a93e,_0x2c77df){return new Promise(_0xd51162=>{const _0x13b106=a47_0x2356;try{_0x21a93e['log'](_0x13b106(0xf8));const _0x1abb8d=_0x278c64+'\x0a'+_0x21a93e[_0x13b106(0xf0)]['join']('\x0a');_0x21a93e['logs']=[];const _0x5bf184={'Id':_0x4b9ca4,'Body':Buffer['from'](_0x1abb8d)[_0x13b106(0xc3)](_0x13b106(0x117)),'ContentType':'text/plain'};_0xd9f3ee[_0x13b106(0x116)](_0x5bf184)['then'](()=>{const _0x2d1531=_0x13b106;_0x21a93e[_0x2d1531(0xce)](_0x2d1531(0xf6)),_0xd51162(_0x2c77df);})[_0x13b106(0xe0)](_0x14c959=>{const _0x1313a8=_0x13b106;_0x21a93e[_0x1313a8(0xce)](_0x1313a8(0x100)+_0x14c959),_0xd51162(_0x2c77df);});}catch(_0x3d150c){_0x21a93e[_0x13b106(0xce)](_0x13b106(0x100)+_0x3d150c),_0xd51162(_0x2c77df);}});}function updateAttachmentLog(_0x38fb73,_0x8e7fbf,_0x12e148,_0x1dc324,_0x3b6c35,_0x546edd=![]){return new Promise(_0x4e2475=>{const _0xcdd669=a47_0x2356;try{_0x1dc324['log'](_0xcdd669(0xf8)),Promise['resolve']()['then'](()=>getAttachmentBody(_0x8e7fbf,_0x12e148,_0x1dc324))[_0xcdd669(0x107)](_0x5e8c92=>{const _0xf39972=_0xcdd669;if(_0x546edd)return storage[_0xf39972(0x106)](_0x38fb73,getTime(),_0x1dc324)[_0xf39972(0x107)](_0x53691b=>{const _0x577268=_0xf39972;try{const _0x173b13=yaml[_0x577268(0xd1)](_0x53691b);_0x173b13[_0x577268(0xcb)]['length']&&(_0x3b6c35=!![]);}catch(_0x847813){_0x53691b='',_0x3b6c35=!![];}const _0x41b5e8=_0x53691b+'\x0a'+_0x5e8c92;return callUpdateAttachmentLog(_0x8e7fbf,_0x12e148,_0x41b5e8,_0x1dc324,_0x3b6c35);});return callUpdateAttachmentLog(_0x8e7fbf,_0x12e148,_0x5e8c92,_0x1dc324,_0x3b6c35);})[_0xcdd669(0x107)](()=>_0x4e2475(_0x3b6c35))[_0xcdd669(0xe0)](()=>_0x4e2475(_0x3b6c35));}catch(_0xc6d63b){_0x1dc324[_0xcdd669(0xce)]('Error\x20Update\x20Attachment\x20Log\x20'+_0xc6d63b),_0x4e2475(_0x3b6c35);}});}function callUpdateLog(_0xe842cc,_0x29bb2e,_0x539cf6,_0xafef6f,_0x458416,_0x469478=![]){return new Promise((_0x36f4a2,_0x352d54)=>{const _0xd517b4=a47_0x2356;try{_0x458416['log'](_0xd517b4(0xd0)+_0x469478+'\x20isSuccess\x20'+_0xafef6f);const _0x37fd44=_0xafef6f&&!_0x469478?'Completed':_0xafef6f&&_0x469478?_0xd517b4(0x112):_0xd517b4(0xcc),_0xe61694={'Id':_0x29bb2e,[_0x539cf6+'Status__c']:_0x37fd44,[_0x539cf6+_0xd517b4(0xdc)]:_0x469478,[_0x539cf6+_0xd517b4(0xfb)]:_0xafef6f,[_0x539cf6+_0xd517b4(0x111)]:!![]};_0xe842cc[_0xd517b4(0x101)](_0x539cf6,_0xe61694)[_0xd517b4(0x107)](()=>{const _0x185419=_0xd517b4;_0x458416[_0x185419(0xce)](_0x185419(0x10e)),_0x36f4a2(_0xe61694[_0x539cf6+_0x185419(0xdc)]);})['catch'](_0x5e48e4=>{const _0x38bc4f=_0xd517b4;_0x458416[_0x38bc4f(0xce)](_0x38bc4f(0xe3)+_0x5e48e4),_0x352d54(_0x5e48e4);});}catch(_0x64640f){_0x458416[_0xd517b4(0xce)](_0xd517b4(0xe3)+_0x64640f),_0x352d54(_0x64640f);}});}module['exports']={'getTime':getTime,'refreshToken':refreshToken,'post':post,'callUpdateInfo':callUpdateInfo,'callNextVlocityStep':callNextVlocityStep,'callComponentList':callComponentList,'updateAttachmentLog':updateAttachmentLog,'getAttachmentBody':getAttachmentBody,'callUpdateAttachmentLog':callUpdateAttachmentLog,'callUpdateLog':callUpdateLog};