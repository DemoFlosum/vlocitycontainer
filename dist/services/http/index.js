const a47_0x90277a=a47_0x4b5d;(function(_0x1e17b5,_0x1edd8d){const _0x5806b9=a47_0x4b5d,_0x164223=_0x1e17b5();while(!![]){try{const _0xda7fe5=parseInt(_0x5806b9(0x100))/0x1+-parseInt(_0x5806b9(0x11c))/0x2*(-parseInt(_0x5806b9(0x10c))/0x3)+-parseInt(_0x5806b9(0xef))/0x4+-parseInt(_0x5806b9(0xf1))/0x5+parseInt(_0x5806b9(0x124))/0x6*(-parseInt(_0x5806b9(0x116))/0x7)+-parseInt(_0x5806b9(0x125))/0x8*(-parseInt(_0x5806b9(0xdf))/0x9)+parseInt(_0x5806b9(0xee))/0xa;if(_0xda7fe5===_0x1edd8d)break;else _0x164223['push'](_0x164223['shift']());}catch(_0x5c529d){_0x164223['push'](_0x164223['shift']());}}}(a47_0x315a,0x326c0));function a47_0x4b5d(_0x46e3c9,_0x3cb4a3){const _0x315a23=a47_0x315a();return a47_0x4b5d=function(_0x4b5d6b,_0x4f5fde){_0x4b5d6b=_0x4b5d6b-0xdf;let _0x4cf913=_0x315a23[_0x4b5d6b];return _0x4cf913;},a47_0x4b5d(_0x46e3c9,_0x3cb4a3);}function a47_0x315a(){const _0x29358d=['getMonth','getDate','error','METHOD_NEXT_VLOCITY_STEP','catch','End\x20Update\x20Attachment\x20Log','4358120WLmVwi','1434372ngYzWZ','log','1088180REYspj','Completed','Status__c','clientId','updateAttachment','base64','toString','from','Error\x20Get\x20Attachment\x20Body\x20','OAuth\x20','Is_Error__c','parseFloat','0$1','replace','Error\x20Call\x20Component\x20List','145699PGNLBL','clientSecret','join','stringify','getAttachmentBodyStream','status','instanceUrl','readLogFile','load','resolve','Full\x20Process:\x0a\x0a','../storage','40719iqyFeV','getSeconds','getFullYear','Job_Completed__c','data','Errors','idList','string','Succeed__c','concat','210qJwaUN','getMinutes','toFixed','Partial\x20Completed','Start\x20Update\x20Log\x20is\x20Success\x20=\x20','Retrieved:\x20','38VbDdzI','response','Error\x20Update\x20Metadata\x20Log\x20','Exception','Error\x20Update\x20Attachment\x20Log\x20','Error\x20Next\x20Vlocity\x20Step','then','unlocked-packages','14694gKnKDp','134632KbWsUo','push','logs','/services/apexrest/','accessToken','End\x20Call\x20Component\x20List','\x20isSuccess\x20','../../constants','parse','js-yaml','updateMetadataLog','9YjCMEN','Start\x20Next\x20Vlocity\x20Step','getHours','message','length','End\x20Next\x20Vlocity\x20Step','Start\x20Update\x20Metadata\x20Log\x20isError\x20','exports','post'];a47_0x315a=function(){return _0x29358d;};return a47_0x315a();}const axios=require('axios'),yaml=require(a47_0x90277a(0x12e)),constants=require(a47_0x90277a(0x12c)),storage=require(a47_0x90277a(0x10b)),CLIENT_CREDENTIALS_TYPE='client_credentials';async function post(_0xc92c70,_0x485fa0,_0x1b8d0b,_0x329a77=a47_0x90277a(0x123),_0x4ce627=![]){const _0x1873a6=a47_0x90277a,_0x52a8f8={'Authorization':_0x1873a6(0xfa)+_0xc92c70[_0x1873a6(0x129)],'Content-Type':'application/json'};_0x485fa0=_0x485fa0&&_0x485fa0['length']?_0x485fa0[_0x1873a6(0xfe)]('__','')+'/':'';const _0x51aa4d=_0xc92c70[_0x1873a6(0x106)]+_0x1873a6(0x128)+_0x485fa0+_0x329a77;try{return await axios[_0x1873a6(0xe7)](_0x51aa4d,_0x1b8d0b,{'headers':_0x52a8f8});}catch(_0x507928){if(_0x507928?.[_0x1873a6(0x11d)]?.[_0x1873a6(0x105)]===0x191&&!_0x4ce627&&_0xc92c70[_0x1873a6(0xf4)]&&_0xc92c70[_0x1873a6(0x101)])return _0xc92c70[_0x1873a6(0x129)]=await refreshToken(_0xc92c70),await post(_0xc92c70,_0x485fa0,_0x1b8d0b,_0x329a77,!![]);throw getErrorMessage(_0x507928);}}function getErrorMessage(_0x312f58){const _0x32d725=a47_0x90277a,_0xd31f6b=_0x312f58?.[_0x32d725(0x11d)]?.[_0x32d725(0x110)];if(_0xd31f6b){if(typeof _0xd31f6b===_0x32d725(0x113))return _0xd31f6b;if(_0xd31f6b['message'])return _0xd31f6b[_0x32d725(0xe2)];}if(_0x312f58?.[_0x32d725(0xe2)])return _0x312f58['message'];return'Unknown\x20error:\x20'+_0x312f58;}async function refreshToken({instanceUrl:_0x43b683,clientId:_0x16fe1a,clientSecret:_0x22aa69}){const _0x5b739a=a47_0x90277a,{data:_0x5e5532}=await axios[_0x5b739a(0xe7)](_0x43b683+'/services/oauth2/token',null,{'params':{'grant_type':CLIENT_CREDENTIALS_TYPE,'client_id':_0x16fe1a,'client_secret':_0x22aa69}});return _0x5e5532['access_token'];}function callUpdateInfo(_0x26db62,_0x51a33f,_0x16a3f7,_0x9be989,_0x3f77a7,_0x48ce89,_0x70d425,_0x57c4f2=![]){return new Promise((_0x24d460,_0x5baa8d)=>{const _0x4a7c59=a47_0x4b5d;try{try{const _0x4af8b0=yaml[_0x4a7c59(0x108)](_0x3f77a7);_0x4af8b0[_0x4a7c59(0x111)]&&(_0x57c4f2=_0x4af8b0['Errors'][_0x4a7c59(0xe3)]>0x0);}catch(_0x30fa14){}_0x70d425[_0x4a7c59(0xf0)](_0x4a7c59(0x11a)+_0x48ce89);const _0x2e305d={'logId':_0x51a33f,'attachmentLogId':_0x9be989,'isJobCompleted':!![],'status':_0x4a7c59(0xf2),'isSuccess':_0x48ce89,'isError':_0x57c4f2,'attachmentBody':_0x3f77a7+_0x4a7c59(0x10a)+_0x70d425[_0x4a7c59(0x127)]['join']('\x0a')},_0x4d3acf={'methodType':constants['METHOD_UPDATE_LOG'],'body':JSON[_0x4a7c59(0x103)](_0x2e305d)};post(_0x26db62,_0x16a3f7,_0x4d3acf)['then'](_0x538174=>{const _0x2746cd=_0x4a7c59;_0x70d425[_0x2746cd(0xf0)]('End\x20Update\x20Log\x20is\x20Success\x20=\x20'+_0x48ce89),_0x24d460(_0x538174);})[_0x4a7c59(0xec)](_0xe6ead0=>{const _0x376a15=_0x4a7c59;_0x70d425[_0x376a15(0xf0)]('Error\x20Update\x20Log\x20is\x20Success\x20=\x20'+_0x48ce89),_0x5baa8d(_0xe6ead0);});}catch(_0x4badf9){_0x5baa8d(_0x4badf9);}});}function callNextVlocityStep(_0x4dfc8f,_0xa0f208,_0x439897,_0x413d56,_0x30a6ac,_0x2bcf02,_0x23e542,_0x2de93d){return new Promise((_0x5cfa1f,_0x54b23b)=>{const _0x1b2246=a47_0x4b5d;try{_0x2de93d[_0x1b2246(0xf0)](_0x1b2246(0xe0));const _0x563087={'pipelineId':_0x439897,'pipelineNumber':_0x413d56,'isPass':_0x2bcf02,'branchId':_0x23e542,'pipelineKey':_0x30a6ac},_0x4fc8ee={'methodType':constants[_0x1b2246(0xeb)],'body':JSON[_0x1b2246(0x103)](_0x563087)};post(_0x4dfc8f,_0xa0f208,_0x4fc8ee)[_0x1b2246(0x122)](_0x17f4af=>{const _0x5d0486=_0x1b2246;_0x2de93d[_0x5d0486(0xf0)](_0x5d0486(0xe4)),_0x5cfa1f(_0x17f4af);})['catch'](_0x37da43=>{const _0x318dd0=_0x1b2246;_0x2de93d[_0x318dd0(0xf0)](_0x318dd0(0x121)),_0x54b23b(_0x37da43);});}catch(_0x113493){_0x54b23b(_0x113493);}});}function callComponentList(_0x1f3767,_0x1e3b85,_0x1eddef,_0x5f303a,_0x447a44,_0x2962bd=[]){return new Promise((_0x1aa3f4,_0x141d75)=>{const _0x414ec4=a47_0x4b5d;try{_0x447a44['log']('Start\x20Call\x20Component\x20List');const _0x270841={'methodType':constants['METHOD_TYPE_GET_ATTACHMENTS'],'body':JSON['stringify'](_0x1e3b85)};post(_0x1f3767,_0x1eddef,_0x270841)[_0x414ec4(0x122)](_0x17ff0=>{const _0x11d300=_0x414ec4;let {data:_0x194821}=_0x17ff0;_0x194821=JSON[_0x11d300(0x12d)](_0x194821),_0x447a44[_0x11d300(0xf0)](_0x11d300(0x11b)+Number[_0x11d300(0xfc)](_0x2962bd[_0x11d300(0xe3)]/_0x5f303a*0x64)[_0x11d300(0x118)](0x2)+'%'),_0x2962bd[_0x11d300(0x126)](..._0x194821['recordList']),_0x194821[_0x11d300(0x112)]&&_0x194821[_0x11d300(0x112)][_0x11d300(0xe3)]?callComponentList(_0x1f3767,_0x194821[_0x11d300(0x112)],_0x1eddef,_0x5f303a,_0x447a44,_0x2962bd)['then'](_0x338c05=>_0x1aa3f4(_0x338c05))[_0x11d300(0xec)](_0x1fb0c4=>{const _0x1999bd=_0x11d300;_0x447a44[_0x1999bd(0xf0)]('Error\x20Call\x20Component\x20List'),_0x141d75(_0x1fb0c4);}):(_0x447a44[_0x11d300(0xf0)](_0x11d300(0x12a)),_0x1aa3f4(_0x2962bd));})[_0x414ec4(0xec)](_0x55fcce=>{const _0x55c0d2=_0x414ec4;_0x447a44['log'](_0x55c0d2(0xff)),_0x141d75(_0x55fcce);});}catch(_0x14f0f6){_0x447a44[_0x414ec4(0xf0)]('Error\x20Call\x20Component\x20List'),_0x141d75(_0x14f0f6);}});}async function getBodyFromStream(_0x4acf03,_0x44591e,_0x209ced){return new Promise(_0x14dc97=>{const _0x15495c=a47_0x4b5d;try{const _0x3a2bd9=[];_0x4acf03['on']('data',(_0x5b7411,_0x9a049a)=>{const _0x34ab13=a47_0x4b5d;_0x3a2bd9[_0x34ab13(0x126)](_0x5b7411);}),_0x4acf03['on']('end',()=>{const _0x435e14=a47_0x4b5d;_0x44591e?_0x14dc97(_0x3a2bd9['join']('')):_0x14dc97(Buffer[_0x435e14(0x115)](_0x3a2bd9));}),_0x4acf03['on'](_0x15495c(0xea),_0x1a1a45=>{const _0x1a7c36=_0x15495c;_0x209ced[_0x1a7c36(0xf0)](_0x1a7c36(0xf9)+_0x1a1a45),_0x14dc97('');});}catch(_0x430aeb){_0x209ced['log']('Error\x20Get\x20Attachment\x20Body\x20'+_0x430aeb),_0x14dc97('');}});}async function getAttachmentBody(_0x4122cf,_0x4baee2,_0x26b646,_0x498c86=!![]){const _0x4363a3=a47_0x90277a,_0x553c97=await _0x4122cf[_0x4363a3(0x104)](_0x4baee2);return await getBodyFromStream(_0x553c97,_0x498c86,_0x26b646);}function getTime(){const _0x2d421d=a47_0x90277a,_0x130923=new Date(),_0x1f9bb9=[_0x130923[_0x2d421d(0xe9)](),_0x130923[_0x2d421d(0xe8)]()+0x1,_0x130923[_0x2d421d(0x10e)](),_0x130923[_0x2d421d(0xe1)](),_0x130923[_0x2d421d(0x117)](),_0x130923[_0x2d421d(0x10d)]()];return _0x1f9bb9['forEach'](_0x45806e=>_0x45806e=_0x45806e[_0x2d421d(0xf7)]()[_0x2d421d(0xfe)](/^([0-9])$/,_0x2d421d(0xfd))),_0x1f9bb9[0x2]+'-'+_0x1f9bb9[0x1]+'-'+_0x1f9bb9[0x0]+'\x20'+_0x1f9bb9[0x3]+':'+_0x1f9bb9[0x4]+':'+_0x1f9bb9[0x5];}function callUpdateAttachmentLog(_0x2f5180,_0xca068e,_0x230d90,_0x556b36,_0x4d4f3f){return new Promise(_0x156aa9=>{const _0x46c2ae=a47_0x4b5d;try{_0x556b36['log']('Start\x20Update\x20Attachment\x20Log');const _0x5ccc0e=_0x230d90+'\x0a'+_0x556b36['logs'][_0x46c2ae(0x102)]('\x0a');_0x556b36[_0x46c2ae(0x127)]=[];const _0x16790d={'Id':_0xca068e,'Body':Buffer[_0x46c2ae(0xf8)](_0x5ccc0e)[_0x46c2ae(0xf7)](_0x46c2ae(0xf6)),'ContentType':'text/plain'};_0x2f5180[_0x46c2ae(0xf5)](_0x16790d)['then'](()=>{const _0x4f2212=_0x46c2ae;_0x556b36['log'](_0x4f2212(0xed)),_0x156aa9(_0x4d4f3f);})[_0x46c2ae(0xec)](_0x188dd6=>{const _0x3068ee=_0x46c2ae;_0x556b36[_0x3068ee(0xf0)](_0x3068ee(0x120)+_0x188dd6),_0x156aa9(_0x4d4f3f);});}catch(_0x4fb3e2){_0x556b36[_0x46c2ae(0xf0)](_0x46c2ae(0x120)+_0x4fb3e2),_0x156aa9(_0x4d4f3f);}});}function updateAttachmentLog(_0x40bc1b,_0x5d6919,_0x553d9d,_0x15d2f9,_0x1c5e3f,_0xfc0c47=![]){return new Promise(_0x4f5877=>{const _0xe1344a=a47_0x4b5d;try{_0x15d2f9[_0xe1344a(0xf0)]('Start\x20Update\x20Attachment\x20Log'),Promise[_0xe1344a(0x109)]()[_0xe1344a(0x122)](()=>getAttachmentBody(_0x5d6919,_0x553d9d,_0x15d2f9))[_0xe1344a(0x122)](_0x1d49eb=>{const _0x207205=_0xe1344a;if(_0xfc0c47)return storage[_0x207205(0x107)](_0x40bc1b,getTime(),_0x15d2f9)['then'](_0x435456=>{const _0x57f11a=_0x207205;try{const _0x273bec=yaml[_0x57f11a(0x108)](_0x435456);_0x273bec[_0x57f11a(0x111)][_0x57f11a(0xe3)]&&(_0x1c5e3f=!![]);}catch(_0x19087a){_0x435456='',_0x1c5e3f=!![];}const _0xa89298=_0x435456+'\x0a'+_0x1d49eb;return callUpdateAttachmentLog(_0x5d6919,_0x553d9d,_0xa89298,_0x15d2f9,_0x1c5e3f);});return callUpdateAttachmentLog(_0x5d6919,_0x553d9d,_0x1d49eb,_0x15d2f9,_0x1c5e3f);})[_0xe1344a(0x122)](()=>_0x4f5877(_0x1c5e3f))[_0xe1344a(0xec)](()=>_0x4f5877(_0x1c5e3f));}catch(_0x4f9663){_0x15d2f9['log']('Error\x20Update\x20Attachment\x20Log\x20'+_0x4f9663),_0x4f5877(_0x1c5e3f);}});}function callUpdateLog(_0x4b3a63,_0x349fb1,_0x41018d,_0x541192,_0x4bd173,_0x49139d=![]){return new Promise((_0x445747,_0x88adcb)=>{const _0x41d73a=a47_0x4b5d;try{_0x4bd173[_0x41d73a(0xf0)](_0x41d73a(0xe5)+_0x49139d+_0x41d73a(0x12b)+_0x541192);const _0xfe7685=_0x541192&&!_0x49139d?'Completed':_0x541192&&_0x49139d?_0x41d73a(0x119):_0x41d73a(0x11f),_0x19c18d={'Id':_0x349fb1,[_0x41018d+_0x41d73a(0xf3)]:_0xfe7685,[_0x41018d+'Is_Error__c']:_0x49139d,[_0x41018d+_0x41d73a(0x114)]:_0x541192,[_0x41018d+_0x41d73a(0x10f)]:!![]};_0x4b3a63[_0x41d73a(0x12f)](_0x41018d,_0x19c18d)['then'](()=>{const _0x2c71b2=_0x41d73a;_0x4bd173[_0x2c71b2(0xf0)]('End\x20Update\x20Metadata\x20Log'),_0x445747(_0x19c18d[_0x41018d+_0x2c71b2(0xfb)]);})[_0x41d73a(0xec)](_0x3aeb27=>{const _0x55085b=_0x41d73a;_0x4bd173[_0x55085b(0xf0)](_0x55085b(0x11e)+_0x3aeb27),_0x88adcb(_0x3aeb27);});}catch(_0x2897eb){_0x4bd173[_0x41d73a(0xf0)](_0x41d73a(0x11e)+_0x2897eb),_0x88adcb(_0x2897eb);}});}module[a47_0x90277a(0xe6)]={'getTime':getTime,'refreshToken':refreshToken,'post':post,'callUpdateInfo':callUpdateInfo,'callNextVlocityStep':callNextVlocityStep,'callComponentList':callComponentList,'updateAttachmentLog':updateAttachmentLog,'getAttachmentBody':getAttachmentBody,'callUpdateAttachmentLog':callUpdateAttachmentLog,'callUpdateLog':callUpdateLog};