const a47_0x4b6578=a47_0x2b74;(function(_0x154095,_0x5aece8){const _0x4f94de=a47_0x2b74,_0xfcd160=_0x154095();while(!![]){try{const _0x50bed6=parseInt(_0x4f94de(0x169))/0x1*(-parseInt(_0x4f94de(0x149))/0x2)+-parseInt(_0x4f94de(0x17c))/0x3*(-parseInt(_0x4f94de(0x16a))/0x4)+-parseInt(_0x4f94de(0x16f))/0x5*(parseInt(_0x4f94de(0x147))/0x6)+-parseInt(_0x4f94de(0x151))/0x7*(parseInt(_0x4f94de(0x14c))/0x8)+-parseInt(_0x4f94de(0x16e))/0x9+parseInt(_0x4f94de(0x13b))/0xa*(parseInt(_0x4f94de(0x140))/0xb)+parseInt(_0x4f94de(0x183))/0xc;if(_0x50bed6===_0x5aece8)break;else _0xfcd160['push'](_0xfcd160['shift']());}catch(_0x2ab7aa){_0xfcd160['push'](_0xfcd160['shift']());}}}(a47_0x91a4,0xcd19b));const axios=require('axios'),yaml=require(a47_0x4b6578(0x139)),constants=require(a47_0x4b6578(0x15a)),storage=require(a47_0x4b6578(0x172)),CLIENT_CREDENTIALS_TYPE=a47_0x4b6578(0x14d);async function post(_0x3a4363,_0xfd6a5a,_0x4a9bfe,_0xce2300=a47_0x4b6578(0x152),_0x14f48f=![]){const _0x8d6203=a47_0x4b6578,_0x13ebc8={'Authorization':'OAuth\x20'+_0x3a4363['accessToken'],'Content-Type':'application/json'};_0xfd6a5a=_0xfd6a5a&&_0xfd6a5a[_0x8d6203(0x159)]?_0xfd6a5a[_0x8d6203(0x158)]('__','')+'/':'';const _0x4c7af5=_0x3a4363[_0x8d6203(0x182)]+'/services/apexrest/'+_0xfd6a5a+_0xce2300;try{return await axios[_0x8d6203(0x155)](_0x4c7af5,_0x4a9bfe,{'headers':_0x13ebc8});}catch(_0x1521f1){if(_0x1521f1?.['response']?.[_0x8d6203(0x14f)]===0x191&&!_0x14f48f&&_0x3a4363[_0x8d6203(0x174)]&&_0x3a4363[_0x8d6203(0x15d)])return _0x3a4363['accessToken']=await refreshToken(_0x3a4363),await post(_0x3a4363,_0xfd6a5a,_0x4a9bfe,_0xce2300,!![]);throw getErrorMessage(_0x1521f1);}}function getErrorMessage(_0x1df853){const _0x207dd7=a47_0x4b6578,_0x3f69ef=_0x1df853?.['response']?.[_0x207dd7(0x15b)];if(_0x3f69ef){if(typeof _0x3f69ef===_0x207dd7(0x154))return _0x3f69ef;if(_0x3f69ef[_0x207dd7(0x16c)])return _0x3f69ef[_0x207dd7(0x16c)];}if(_0x1df853?.['message'])return _0x1df853[_0x207dd7(0x16c)];return _0x207dd7(0x15c)+_0x1df853;}function a47_0x2b74(_0xec1948,_0x5155f7){const _0x91a4ef=a47_0x91a4();return a47_0x2b74=function(_0x2b740c,_0x277469){_0x2b740c=_0x2b740c-0x134;let _0x49c765=_0x91a4ef[_0x2b740c];return _0x49c765;},a47_0x2b74(_0xec1948,_0x5155f7);}async function refreshToken({instanceUrl:_0x4376f8,clientId:_0x39e4a6,clientSecret:_0x52f2b0}){const _0x4c1eef=a47_0x4b6578,{data:_0x4820cc}=await axios['post'](_0x4376f8+_0x4c1eef(0x153),null,{'params':{'grant_type':CLIENT_CREDENTIALS_TYPE,'client_id':_0x39e4a6,'client_secret':_0x52f2b0}});return _0x4820cc['access_token'];}function callUpdateInfo(_0x458832,_0x476f27,_0x21ecb6,_0x430e9b,_0x294833,_0xd903ed,_0x5b4071,_0x361537=![]){return new Promise((_0x29851d,_0x16ebd0)=>{const _0x294e0b=a47_0x2b74;try{try{const _0x17940c=yaml[_0x294e0b(0x178)](_0x294833);_0x17940c[_0x294e0b(0x144)]&&(_0x361537=_0x17940c[_0x294e0b(0x144)]['length']>0x0);}catch(_0x100b6e){}_0x5b4071[_0x294e0b(0x163)](_0x294e0b(0x157)+_0xd903ed);const _0x4670a7={'logId':_0x476f27,'attachmentLogId':_0x430e9b,'isJobCompleted':!![],'status':_0x294e0b(0x180),'isSuccess':_0xd903ed,'isError':_0x361537,'attachmentBody':_0x294833+_0x294e0b(0x137)+_0x5b4071[_0x294e0b(0x14e)][_0x294e0b(0x17f)]('\x0a')},_0x80288d={'methodType':constants['METHOD_UPDATE_LOG'],'body':JSON[_0x294e0b(0x14a)](_0x4670a7)};post(_0x458832,_0x21ecb6,_0x80288d)[_0x294e0b(0x166)](_0x3f52ee=>{const _0x5b1729=_0x294e0b;_0x5b4071[_0x5b1729(0x163)](_0x5b1729(0x16b)+_0xd903ed),_0x29851d(_0x3f52ee);})[_0x294e0b(0x181)](_0x4222b8=>{const _0x1e3c13=_0x294e0b;_0x5b4071['log'](_0x1e3c13(0x162)+_0xd903ed),_0x16ebd0(_0x4222b8);});}catch(_0x3fec1d){_0x16ebd0(_0x3fec1d);}});}function callNextVlocityStep(_0x3cc36b,_0x34d3c0,_0x5b3b02,_0x325ab3,_0x2f4c47,_0x19f046,_0x4509c4,_0x411536){return new Promise((_0x3894fe,_0x286d49)=>{const _0x518b38=a47_0x2b74;try{_0x411536['log'](_0x518b38(0x17a));const _0x4af9ac={'pipelineId':_0x5b3b02,'pipelineNumber':_0x325ab3,'isPass':_0x19f046,'branchId':_0x4509c4,'pipelineKey':_0x2f4c47},_0x4257fd={'methodType':constants[_0x518b38(0x13e)],'body':JSON[_0x518b38(0x14a)](_0x4af9ac)};post(_0x3cc36b,_0x34d3c0,_0x4257fd)[_0x518b38(0x166)](_0x2b9906=>{const _0x417987=_0x518b38;_0x411536[_0x417987(0x163)](_0x417987(0x171)),_0x3894fe(_0x2b9906);})[_0x518b38(0x181)](_0x4c2b7f=>{const _0x4a743e=_0x518b38;_0x411536[_0x4a743e(0x163)](_0x4a743e(0x136)),_0x286d49(_0x4c2b7f);});}catch(_0x14449a){_0x286d49(_0x14449a);}});}function callComponentList(_0x504571,_0x2b5109,_0x54c8d3,_0x1a3206,_0x455446,_0xd509ee=[]){return new Promise((_0x407153,_0x339b17)=>{const _0x35ff80=a47_0x2b74;try{_0x455446[_0x35ff80(0x163)](_0x35ff80(0x176));const _0x15eed5={'methodType':constants[_0x35ff80(0x168)],'body':JSON[_0x35ff80(0x14a)](_0x2b5109)};post(_0x504571,_0x54c8d3,_0x15eed5)['then'](_0xcf4a1c=>{const _0x2e5e5e=_0x35ff80;let {data:_0x59d549}=_0xcf4a1c;_0x59d549=JSON[_0x2e5e5e(0x135)](_0x59d549),_0x455446[_0x2e5e5e(0x163)](_0x2e5e5e(0x177)+Number['parseFloat'](_0xd509ee[_0x2e5e5e(0x159)]/_0x1a3206*0x64)['toFixed'](0x2)+'%'),_0xd509ee[_0x2e5e5e(0x146)](..._0x59d549[_0x2e5e5e(0x170)]),_0x59d549[_0x2e5e5e(0x14b)]&&_0x59d549['idList'][_0x2e5e5e(0x159)]?callComponentList(_0x504571,_0x59d549[_0x2e5e5e(0x14b)],_0x54c8d3,_0x1a3206,_0x455446,_0xd509ee)[_0x2e5e5e(0x166)](_0xf627b0=>_0x407153(_0xf627b0))[_0x2e5e5e(0x181)](_0x445e1c=>{const _0x644cf0=_0x2e5e5e;_0x455446[_0x644cf0(0x163)](_0x644cf0(0x160)),_0x339b17(_0x445e1c);}):(_0x455446[_0x2e5e5e(0x163)](_0x2e5e5e(0x143)),_0x407153(_0xd509ee));})[_0x35ff80(0x181)](_0x66799f=>{const _0x40fe4e=_0x35ff80;_0x455446[_0x40fe4e(0x163)](_0x40fe4e(0x160)),_0x339b17(_0x66799f);});}catch(_0x46f56e){_0x455446[_0x35ff80(0x163)](_0x35ff80(0x160)),_0x339b17(_0x46f56e);}});}function a47_0x91a4(){const _0x323c63=['Unknown\x20error:\x20','clientSecret','updateMetadataLog','getSeconds','Error\x20Call\x20Component\x20List','End\x20Update\x20Metadata\x20Log','Error\x20Update\x20Log\x20is\x20Success\x20=\x20','log','Succeed__c','error','then','getMinutes','METHOD_TYPE_GET_ATTACHMENTS','139743xRdEht','1096164VWsUiK','End\x20Update\x20Log\x20is\x20Success\x20=\x20','message','resolve','12104793BnnRyu','1648910qfTJur','recordList','End\x20Next\x20Vlocity\x20Step','../storage','Error\x20Get\x20Attachment\x20Body\x20','clientId','end','Start\x20Call\x20Component\x20List','Retrieved:\x20','load','concat','Start\x20Next\x20Vlocity\x20Step','exports','18vsfgxo','getMonth','getFullYear','join','Completed','catch','instanceUrl','24045120WKFrOK','Job_Completed__c','parse','Error\x20Next\x20Vlocity\x20Step','Full\x20Process:\x0a\x0a','\x20isSuccess\x20','js-yaml','from','1490JQukEa','Start\x20Update\x20Metadata\x20Log\x20isError\x20','Status__c','METHOD_NEXT_VLOCITY_STEP','text/plain','95755BXEykM','End\x20Update\x20Attachment\x20Log','Is_Error__c','End\x20Call\x20Component\x20List','Errors','Start\x20Update\x20Attachment\x20Log','push','6EIUBlk','getDate','14utsNEo','stringify','idList','160TmEOGI','client_credentials','logs','status','toString','508200czsFxC','unlocked-packages','/services/oauth2/token','string','post','Error\x20Update\x20Attachment\x20Log\x20','Start\x20Update\x20Log\x20is\x20Success\x20=\x20','replace','length','../../constants','data'];a47_0x91a4=function(){return _0x323c63;};return a47_0x91a4();}async function getBodyFromStream(_0x393464,_0x37e4b2,_0x28d61a){return new Promise(_0x9ac1ee=>{const _0x223dd3=a47_0x2b74;try{const _0x28e729=[];_0x393464['on']('data',(_0x4c8075,_0x5701b0)=>{const _0x2c2b52=a47_0x2b74;_0x28e729[_0x2c2b52(0x146)](_0x4c8075);}),_0x393464['on'](_0x223dd3(0x175),()=>{const _0x557680=_0x223dd3;_0x37e4b2?_0x9ac1ee(_0x28e729[_0x557680(0x17f)]('')):_0x9ac1ee(Buffer[_0x557680(0x179)](_0x28e729));}),_0x393464['on'](_0x223dd3(0x165),_0x1a4bf9=>{const _0x5a1b8b=_0x223dd3;_0x28d61a[_0x5a1b8b(0x163)](_0x5a1b8b(0x173)+_0x1a4bf9),_0x9ac1ee('');});}catch(_0x36962a){_0x28d61a[_0x223dd3(0x163)](_0x223dd3(0x173)+_0x36962a),_0x9ac1ee('');}});}async function getAttachmentBody(_0x488352,_0x55a17b,_0x35cd08,_0x208e31=!![]){const _0x42ae00=await _0x488352['getAttachmentBodyStream'](_0x55a17b);return await getBodyFromStream(_0x42ae00,_0x208e31,_0x35cd08);}function getTime(){const _0x5dcad5=a47_0x4b6578,_0x4c2039=new Date(),_0xb2178c=[_0x4c2039[_0x5dcad5(0x148)](),_0x4c2039[_0x5dcad5(0x17d)]()+0x1,_0x4c2039[_0x5dcad5(0x17e)](),_0x4c2039['getHours'](),_0x4c2039[_0x5dcad5(0x167)](),_0x4c2039[_0x5dcad5(0x15f)]()];return _0xb2178c['forEach'](_0x3acbe7=>_0x3acbe7=_0x3acbe7[_0x5dcad5(0x150)]()[_0x5dcad5(0x158)](/^([0-9])$/,'0$1')),_0xb2178c[0x2]+'-'+_0xb2178c[0x1]+'-'+_0xb2178c[0x0]+'\x20'+_0xb2178c[0x3]+':'+_0xb2178c[0x4]+':'+_0xb2178c[0x5];}function callUpdateAttachmentLog(_0x3c4eb0,_0x3c77c6,_0x235675,_0x5a4046,_0x2ca75d){return new Promise(_0x1f52f1=>{const _0x165aa0=a47_0x2b74;try{_0x5a4046[_0x165aa0(0x163)](_0x165aa0(0x145));const _0x16ca1b=_0x235675+'\x0a'+_0x5a4046[_0x165aa0(0x14e)][_0x165aa0(0x17f)]('\x0a');_0x5a4046[_0x165aa0(0x14e)]=[];const _0x2abe8d={'Id':_0x3c77c6,'Body':Buffer[_0x165aa0(0x13a)](_0x16ca1b)[_0x165aa0(0x150)]('base64'),'ContentType':_0x165aa0(0x13f)};_0x3c4eb0['updateAttachment'](_0x2abe8d)['then'](()=>{const _0x11e711=_0x165aa0;_0x5a4046[_0x11e711(0x163)](_0x11e711(0x141)),_0x1f52f1(_0x2ca75d);})['catch'](_0x428b36=>{const _0x2e12cc=_0x165aa0;_0x5a4046[_0x2e12cc(0x163)]('Error\x20Update\x20Attachment\x20Log\x20'+_0x428b36),_0x1f52f1(_0x2ca75d);});}catch(_0x597461){_0x5a4046['log'](_0x165aa0(0x156)+_0x597461),_0x1f52f1(_0x2ca75d);}});}function updateAttachmentLog(_0x8333ca,_0x3538b7,_0x45ef72,_0x3c1741,_0x36fbcc,_0x12fd12=![]){return new Promise(_0x21f863=>{const _0x19eec8=a47_0x2b74;try{_0x3c1741['log']('Start\x20Update\x20Attachment\x20Log'),Promise[_0x19eec8(0x16d)]()[_0x19eec8(0x166)](()=>getAttachmentBody(_0x3538b7,_0x45ef72,_0x3c1741))['then'](_0xd2150e=>{const _0x5335ca=_0x19eec8;if(_0x12fd12)return storage['readLogFile'](_0x8333ca,getTime(),_0x3c1741)[_0x5335ca(0x166)](_0x2bc2bf=>{const _0xb4131f=_0x5335ca;try{const _0x4b074b=yaml['load'](_0x2bc2bf);_0x4b074b['Errors'][_0xb4131f(0x159)]&&(_0x36fbcc=!![]);}catch(_0x186ed3){_0x2bc2bf='',_0x36fbcc=!![];}const _0x38ffd3=_0x2bc2bf+'\x0a'+_0xd2150e;return callUpdateAttachmentLog(_0x3538b7,_0x45ef72,_0x38ffd3,_0x3c1741,_0x36fbcc);});return callUpdateAttachmentLog(_0x3538b7,_0x45ef72,_0xd2150e,_0x3c1741,_0x36fbcc);})[_0x19eec8(0x166)](()=>_0x21f863(_0x36fbcc))[_0x19eec8(0x181)](()=>_0x21f863(_0x36fbcc));}catch(_0x596aa2){_0x3c1741[_0x19eec8(0x163)](_0x19eec8(0x156)+_0x596aa2),_0x21f863(_0x36fbcc);}});}function callUpdateLog(_0xcd597d,_0x423515,_0x3be85d,_0x56e088,_0x33fa10,_0x2a0323=![]){return new Promise((_0x33c107,_0x1a7ddc)=>{const _0x13631f=a47_0x2b74;try{_0x33fa10['log'](_0x13631f(0x13c)+_0x2a0323+_0x13631f(0x138)+_0x56e088);const _0x40baea=_0x56e088&&!_0x2a0323?'Completed':_0x56e088&&_0x2a0323?'Partial\x20Completed':'Exception',_0x594eb3={'Id':_0x423515,[_0x3be85d+_0x13631f(0x13d)]:_0x40baea,[_0x3be85d+_0x13631f(0x142)]:_0x2a0323,[_0x3be85d+_0x13631f(0x164)]:_0x56e088,[_0x3be85d+_0x13631f(0x134)]:!![]};_0xcd597d[_0x13631f(0x15e)](_0x3be85d,_0x594eb3)[_0x13631f(0x166)](()=>{const _0x38a798=_0x13631f;_0x33fa10['log'](_0x38a798(0x161)),_0x33c107(_0x594eb3[_0x3be85d+_0x38a798(0x142)]);})[_0x13631f(0x181)](_0x199a57=>{const _0x420625=_0x13631f;_0x33fa10[_0x420625(0x163)]('Error\x20Update\x20Metadata\x20Log\x20'+_0x199a57),_0x1a7ddc(_0x199a57);});}catch(_0x118103){_0x33fa10[_0x13631f(0x163)]('Error\x20Update\x20Metadata\x20Log\x20'+_0x118103),_0x1a7ddc(_0x118103);}});}module[a47_0x4b6578(0x17b)]={'getTime':getTime,'refreshToken':refreshToken,'post':post,'callUpdateInfo':callUpdateInfo,'callNextVlocityStep':callNextVlocityStep,'callComponentList':callComponentList,'updateAttachmentLog':updateAttachmentLog,'getAttachmentBody':getAttachmentBody,'callUpdateAttachmentLog':callUpdateAttachmentLog,'callUpdateLog':callUpdateLog};